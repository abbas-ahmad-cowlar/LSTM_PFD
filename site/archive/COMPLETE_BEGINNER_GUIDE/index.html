<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Advanced Bearing Fault Diagnosis System - Production-Ready Research Platform"><meta name=author content="Syed Abbas Ahmad"><link href=https://abbas-ahmad-cowlar.github.io/LSTM_PFD/archive/COMPLETE_BEGINNER_GUIDE/ rel=canonical><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>LSTM_PFD: Complete Beginner to Pro Guide - LSTM PFD Documentation</title><link rel=stylesheet href=../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#lstm_pfd-complete-beginner-to-pro-guide class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="LSTM PFD Documentation" class="md-header__button md-logo" aria-label="LSTM PFD Documentation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m16 11.78 4.24-7.33 1.73 1-5.23 9.05-6.51-3.75L5.46 19H22v2H2V3h2v14.54L9.5 8z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> LSTM PFD Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> LSTM_PFD: Complete Beginner to Pro Guide </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/abbas-ahmad-cowlar/LSTM_PFD title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> abbas-ahmad-cowlar/LSTM_PFD </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../getting-started/ class=md-tabs__link> Getting Started </a> </li> <li class=md-tabs__item> <a href=../../user-guide/ class=md-tabs__link> User Guide </a> </li> <li class=md-tabs__item> <a href=../../api/ class=md-tabs__link> API Reference </a> </li> <li class=md-tabs__item> <a href=../../research/ class=md-tabs__link> Research </a> </li> <li class=md-tabs__item> <a href=../../DEPLOYMENT_GUIDE/ class=md-tabs__link> Deployment </a> </li> <li class=md-tabs__item> <a href=../../../CHANGELOG.md class=md-tabs__link> Changelog </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="LSTM PFD Documentation" class="md-nav__button md-logo" aria-label="LSTM PFD Documentation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m16 11.78 4.24-7.33 1.73 1-5.23 9.05-6.51-3.75L5.46 19H22v2H2V3h2v14.54L9.5 8z"/></svg> </a> LSTM PFD Documentation </label> <div class=md-nav__source> <a href=https://github.com/abbas-ahmad-cowlar/LSTM_PFD title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> abbas-ahmad-cowlar/LSTM_PFD </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Getting Started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../getting-started/ class=md-nav__link> <span class=md-ellipsis> Getting Started </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/quickstart/ class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/configuration/ class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/first-experiment/ class=md-nav__link> <span class=md-ellipsis> First Experiment </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> User Guide </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> User Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guide/ class=md-nav__link> <span class=md-ellipsis> User Guide </span> </a> </li> <li class=md-nav__item> <a href=../../USAGE_PHASE_11/ class=md-nav__link> <span class=md-ellipsis> Dashboard Usage </span> </a> </li> <li class=md-nav__item> <a href=../../USER_GUIDE/ class=md-nav__link> <span class=md-ellipsis> User Guide </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> API Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> API Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../api/ class=md-nav__link> <span class=md-ellipsis> API Reference </span> </a> </li> <li class=md-nav__item> <a href=../../API_REFERENCE/ class=md-nav__link> <span class=md-ellipsis> REST API </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Research </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Research </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../research/ class=md-nav__link> <span class=md-ellipsis> Research </span> </a> </li> <li class=md-nav__item> <a href=../../research/pinn-theory/ class=md-nav__link> <span class=md-ellipsis> PINN Theory </span> </a> </li> <li class=md-nav__item> <a href=../../research/xai-methods/ class=md-nav__link> <span class=md-ellipsis> XAI Methods </span> </a> </li> <li class=md-nav__item> <a href=../../research/ensemble-strategies/ class=md-nav__link> <span class=md-ellipsis> Ensemble Strategies </span> </a> </li> <li class=md-nav__item> <a href=../../research/ablation-studies/ class=md-nav__link> <span class=md-ellipsis> Ablation Studies </span> </a> </li> <li class=md-nav__item> <a href=../../research/reproducibility/ class=md-nav__link> <span class=md-ellipsis> Reproducibility </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Deployment </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Deployment </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../DEPLOYMENT_GUIDE/ class=md-nav__link> <span class=md-ellipsis> Deployment Guide </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../CHANGELOG.md class=md-nav__link> <span class=md-ellipsis> Changelog </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#zero-to-hero-every-single-step-explained class=md-nav__link> <span class=md-ellipsis> Zero to Hero - Every Single Step Explained </span> </a> </li> <li class=md-nav__item> <a href=#table-of-contents class=md-nav__link> <span class=md-ellipsis> ðŸ“– Table of Contents </span> </a> </li> <li class=md-nav__item> <a href=#1-what-is-this-project class=md-nav__link> <span class=md-ellipsis> 1. What is This Project? </span> </a> <nav class=md-nav aria-label="1. What is This Project?"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#the-problem class=md-nav__link> <span class=md-ellipsis> The Problem </span> </a> </li> <li class=md-nav__item> <a href=#the-solution class=md-nav__link> <span class=md-ellipsis> The Solution </span> </a> </li> <li class=md-nav__item> <a href=#what-youll-build class=md-nav__link> <span class=md-ellipsis> What You'll Build </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2-understanding-the-architecture class=md-nav__link> <span class=md-ellipsis> 2. Understanding the Architecture </span> </a> <nav class=md-nav aria-label="2. Understanding the Architecture"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#the-11-phases class=md-nav__link> <span class=md-ellipsis> The 11 Phases </span> </a> </li> <li class=md-nav__item> <a href=#key-concepts class=md-nav__link> <span class=md-ellipsis> Key Concepts </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#3-prerequisites-system-requirements class=md-nav__link> <span class=md-ellipsis> 3. Prerequisites &amp; System Requirements </span> </a> <nav class=md-nav aria-label="3. Prerequisites & System Requirements"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#minimum-requirements class=md-nav__link> <span class=md-ellipsis> Minimum Requirements </span> </a> </li> <li class=md-nav__item> <a href=#recommended-setup-for-best-experience class=md-nav__link> <span class=md-ellipsis> Recommended Setup for Best Experience </span> </a> </li> <li class=md-nav__item> <a href=#software-you-need-to-install class=md-nav__link> <span class=md-ellipsis> Software You Need to Install </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#4-installation-step-by-step class=md-nav__link> <span class=md-ellipsis> 4. Installation - Step by Step </span> </a> <nav class=md-nav aria-label="4. Installation - Step by Step"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#step-1-clone-the-repository class=md-nav__link> <span class=md-ellipsis> Step 1: Clone the Repository </span> </a> </li> <li class=md-nav__item> <a href=#step-2-create-a-virtual-environment class=md-nav__link> <span class=md-ellipsis> Step 2: Create a Virtual Environment </span> </a> </li> <li class=md-nav__item> <a href=#step-3-install-pytorch-critical class=md-nav__link> <span class=md-ellipsis> Step 3: Install PyTorch (Critical!) </span> </a> </li> <li class=md-nav__item> <a href=#step-4-install-all-dependencies class=md-nav__link> <span class=md-ellipsis> Step 4: Install All Dependencies </span> </a> </li> <li class=md-nav__item> <a href=#step-5-create-directory-structure class=md-nav__link> <span class=md-ellipsis> Step 5: Create Directory Structure </span> </a> </li> <li class=md-nav__item> <a href=#step-6-verify-installation class=md-nav__link> <span class=md-ellipsis> Step 6: Verify Installation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#5-understanding-the-data class=md-nav__link> <span class=md-ellipsis> 5. Understanding the Data </span> </a> <nav class=md-nav aria-label="5. Understanding the Data"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#signal-parameters class=md-nav__link> <span class=md-ellipsis> Signal Parameters </span> </a> </li> <li class=md-nav__item> <a href=#data-formats class=md-nav__link> <span class=md-ellipsis> Data Formats </span> </a> </li> <li class=md-nav__item> <a href=#dataset-structure class=md-nav__link> <span class=md-ellipsis> Dataset Structure </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#6-phase-0-foundation-data-generation class=md-nav__link> <span class=md-ellipsis> 6. Phase 0: Foundation &amp; Data Generation </span> </a> <nav class=md-nav aria-label="6. Phase 0: Foundation & Data Generation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#why-synthetic-data class=md-nav__link> <span class=md-ellipsis> Why Synthetic Data? </span> </a> </li> <li class=md-nav__item> <a href=#step-1-understand-the-signal-generator class=md-nav__link> <span class=md-ellipsis> Step 1: Understand the Signal Generator </span> </a> </li> <li class=md-nav__item> <a href=#step-2-generate-dataset class=md-nav__link> <span class=md-ellipsis> Step 2: Generate Dataset </span> </a> </li> <li class=md-nav__item> <a href=#step-3-verify-the-dataset class=md-nav__link> <span class=md-ellipsis> Step 3: Verify the Dataset </span> </a> </li> <li class=md-nav__item> <a href=#what-you-just-learned class=md-nav__link> <span class=md-ellipsis> What You Just Learned </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#7-phase-1-classical-machine-learning-95-96 class=md-nav__link> <span class=md-ellipsis> 7. Phase 1: Classical Machine Learning (95-96%) </span> </a> <nav class=md-nav aria-label="7. Phase 1: Classical Machine Learning (95-96%)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#understanding-phase-1 class=md-nav__link> <span class=md-ellipsis> Understanding Phase 1 </span> </a> </li> <li class=md-nav__item> <a href=#the-36-features-explained class=md-nav__link> <span class=md-ellipsis> The 36 Features Explained </span> </a> </li> <li class=md-nav__item> <a href=#step-1-understand-the-pipeline class=md-nav__link> <span class=md-ellipsis> Step 1: Understand the Pipeline </span> </a> </li> <li class=md-nav__item> <a href=#step-2-run-classical-ml-baseline class=md-nav__link> <span class=md-ellipsis> Step 2: Run Classical ML Baseline </span> </a> </li> <li class=md-nav__item> <a href=#step-3-understand-the-results class=md-nav__link> <span class=md-ellipsis> Step 3: Understand the Results </span> </a> </li> <li class=md-nav__item> <a href=#what-you-just-learned_1 class=md-nav__link> <span class=md-ellipsis> What You Just Learned </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#8-phase-2-deep-learning-1d-cnns-93-95 class=md-nav__link> <span class=md-ellipsis> 8. Phase 2: Deep Learning - 1D CNNs (93-95%) </span> </a> <nav class=md-nav aria-label="8. Phase 2: Deep Learning - 1D CNNs (93-95%)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#understanding-phase-2 class=md-nav__link> <span class=md-ellipsis> Understanding Phase 2 </span> </a> </li> <li class=md-nav__item> <a href=#step-1-train-baseline-cnn class=md-nav__link> <span class=md-ellipsis> Step 1: Train Baseline CNN </span> </a> </li> <li class=md-nav__item> <a href=#step-2-visualize-training class=md-nav__link> <span class=md-ellipsis> Step 2: Visualize Training </span> </a> </li> <li class=md-nav__item> <a href=#step-3-understand-the-results_1 class=md-nav__link> <span class=md-ellipsis> Step 3: Understand the Results </span> </a> </li> <li class=md-nav__item> <a href=#what-you-just-learned_2 class=md-nav__link> <span class=md-ellipsis> What You Just Learned </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#9-phase-3-advanced-cnns-96-97 class=md-nav__link> <span class=md-ellipsis> 9. Phase 3: Advanced CNNs (96-97%) </span> </a> <nav class=md-nav aria-label="9. Phase 3: Advanced CNNs (96-97%)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#understanding-phase-3 class=md-nav__link> <span class=md-ellipsis> Understanding Phase 3 </span> </a> </li> <li class=md-nav__item> <a href=#step-1-train-resnet-34-recommended class=md-nav__link> <span class=md-ellipsis> Step 1: Train ResNet-34 (Recommended) </span> </a> </li> <li class=md-nav__item> <a href=#step-2-train-multiple-models-in-parallel class=md-nav__link> <span class=md-ellipsis> Step 2: Train Multiple Models in Parallel </span> </a> </li> <li class=md-nav__item> <a href=#step-3-compare-all-models class=md-nav__link> <span class=md-ellipsis> Step 3: Compare All Models </span> </a> </li> <li class=md-nav__item> <a href=#what-you-just-learned_3 class=md-nav__link> <span class=md-ellipsis> What You Just Learned </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#10-phase-4-transformers-96-97 class=md-nav__link> <span class=md-ellipsis> 10. Phase 4: Transformers (96-97%) </span> </a> <nav class=md-nav aria-label="10. Phase 4: Transformers (96-97%)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#understanding-transformers class=md-nav__link> <span class=md-ellipsis> Understanding Transformers </span> </a> </li> <li class=md-nav__item> <a href=#step-1-train-transformer class=md-nav__link> <span class=md-ellipsis> Step 1: Train Transformer </span> </a> </li> <li class=md-nav__item> <a href=#step-2-visualize-attention class=md-nav__link> <span class=md-ellipsis> Step 2: Visualize Attention </span> </a> </li> <li class=md-nav__item> <a href=#what-you-just-learned_4 class=md-nav__link> <span class=md-ellipsis> What You Just Learned </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#11-phase-5-time-frequency-analysis-96-98 class=md-nav__link> <span class=md-ellipsis> 11. Phase 5: Time-Frequency Analysis (96-98%) </span> </a> <nav class=md-nav aria-label="11. Phase 5: Time-Frequency Analysis (96-98%)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#understanding-time-frequency-representations class=md-nav__link> <span class=md-ellipsis> Understanding Time-Frequency Representations </span> </a> </li> <li class=md-nav__item> <a href=#step-1-precompute-spectrograms class=md-nav__link> <span class=md-ellipsis> Step 1: Precompute Spectrograms </span> </a> </li> <li class=md-nav__item> <a href=#step-2-train-2d-cnn-on-spectrograms class=md-nav__link> <span class=md-ellipsis> Step 2: Train 2D CNN on Spectrograms </span> </a> </li> <li class=md-nav__item> <a href=#step-3-try-continuous-wavelet-transform-cwt class=md-nav__link> <span class=md-ellipsis> Step 3: Try Continuous Wavelet Transform (CWT) </span> </a> </li> <li class=md-nav__item> <a href=#why-do-spectrograms-help class=md-nav__link> <span class=md-ellipsis> Why Do Spectrograms Help? </span> </a> </li> <li class=md-nav__item> <a href=#what-you-just-learned_5 class=md-nav__link> <span class=md-ellipsis> What You Just Learned </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#12-phase-6-physics-informed-neural-networks-97-98 class=md-nav__link> <span class=md-ellipsis> 12. Phase 6: Physics-Informed Neural Networks (97-98%) </span> </a> <nav class=md-nav aria-label="12. Phase 6: Physics-Informed Neural Networks (97-98%)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#understanding-pinns class=md-nav__link> <span class=md-ellipsis> Understanding PINNs </span> </a> </li> <li class=md-nav__item> <a href=#step-1-train-pinn class=md-nav__link> <span class=md-ellipsis> Step 1: Train PINN </span> </a> </li> <li class=md-nav__item> <a href=#step-2-understand-physics-losses class=md-nav__link> <span class=md-ellipsis> Step 2: Understand Physics Losses </span> </a> </li> <li class=md-nav__item> <a href=#what-you-just-learned_6 class=md-nav__link> <span class=md-ellipsis> What You Just Learned </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#13-phase-7-explainable-ai class=md-nav__link> <span class=md-ellipsis> 13. Phase 7: Explainable AI </span> </a> <nav class=md-nav aria-label="13. Phase 7: Explainable AI"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#understanding-xai class=md-nav__link> <span class=md-ellipsis> Understanding XAI </span> </a> </li> <li class=md-nav__item> <a href=#step-1-generate-shap-explanation class=md-nav__link> <span class=md-ellipsis> Step 1: Generate SHAP Explanation </span> </a> </li> <li class=md-nav__item> <a href=#step-2-launch-interactive-xai-dashboard class=md-nav__link> <span class=md-ellipsis> Step 2: Launch Interactive XAI Dashboard </span> </a> </li> <li class=md-nav__item> <a href=#step-3-understand-the-explanation class=md-nav__link> <span class=md-ellipsis> Step 3: Understand the Explanation </span> </a> </li> <li class=md-nav__item> <a href=#what-you-just-learned_7 class=md-nav__link> <span class=md-ellipsis> What You Just Learned </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#14-phase-8-ensemble-methods-98-99 class=md-nav__link> <span class=md-ellipsis> 14. Phase 8: Ensemble Methods (98-99%) </span> </a> <nav class=md-nav aria-label="14. Phase 8: Ensemble Methods (98-99%)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#understanding-ensembles class=md-nav__link> <span class=md-ellipsis> Understanding Ensembles </span> </a> </li> <li class=md-nav__item> <a href=#step-1-create-voting-ensemble class=md-nav__link> <span class=md-ellipsis> Step 1: Create Voting Ensemble </span> </a> </li> <li class=md-nav__item> <a href=#step-2-train-stacked-ensemble-best-performance class=md-nav__link> <span class=md-ellipsis> Step 2: Train Stacked Ensemble (Best Performance) </span> </a> </li> <li class=md-nav__item> <a href=#step-3-analyze-ensemble-performance class=md-nav__link> <span class=md-ellipsis> Step 3: Analyze Ensemble Performance </span> </a> </li> <li class=md-nav__item> <a href=#why-does-ensemble-work class=md-nav__link> <span class=md-ellipsis> Why Does Ensemble Work? </span> </a> </li> <li class=md-nav__item> <a href=#what-you-just-learned_8 class=md-nav__link> <span class=md-ellipsis> What You Just Learned </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#15-phase-9-production-deployment class=md-nav__link> <span class=md-ellipsis> 15. Phase 9: Production Deployment </span> </a> <nav class=md-nav aria-label="15. Phase 9: Production Deployment"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#understanding-deployment-requirements class=md-nav__link> <span class=md-ellipsis> Understanding Deployment Requirements </span> </a> </li> <li class=md-nav__item> <a href=#step-1-quantize-model-to-int8 class=md-nav__link> <span class=md-ellipsis> Step 1: Quantize Model to INT8 </span> </a> </li> <li class=md-nav__item> <a href=#step-2-export-to-onnx class=md-nav__link> <span class=md-ellipsis> Step 2: Export to ONNX </span> </a> </li> <li class=md-nav__item> <a href=#step-3-start-rest-api class=md-nav__link> <span class=md-ellipsis> Step 3: Start REST API </span> </a> </li> <li class=md-nav__item> <a href=#step-4-test-the-api class=md-nav__link> <span class=md-ellipsis> Step 4: Test the API </span> </a> </li> <li class=md-nav__item> <a href=#step-5-deploy-with-docker class=md-nav__link> <span class=md-ellipsis> Step 5: Deploy with Docker </span> </a> </li> <li class=md-nav__item> <a href=#step-6-benchmark-performance class=md-nav__link> <span class=md-ellipsis> Step 6: Benchmark Performance </span> </a> </li> <li class=md-nav__item> <a href=#what-you-just-learned_9 class=md-nav__link> <span class=md-ellipsis> What You Just Learned </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#16-phase-10-testing-everything class=md-nav__link> <span class=md-ellipsis> 16. Phase 10: Testing Everything </span> </a> <nav class=md-nav aria-label="16. Phase 10: Testing Everything"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#understanding-testing class=md-nav__link> <span class=md-ellipsis> Understanding Testing </span> </a> </li> <li class=md-nav__item> <a href=#step-1-run-all-unit-tests class=md-nav__link> <span class=md-ellipsis> Step 1: Run All Unit Tests </span> </a> </li> <li class=md-nav__item> <a href=#step-2-run-integration-tests class=md-nav__link> <span class=md-ellipsis> Step 2: Run Integration Tests </span> </a> </li> <li class=md-nav__item> <a href=#step-3-run-dashboard-tests class=md-nav__link> <span class=md-ellipsis> Step 3: Run Dashboard Tests </span> </a> </li> <li class=md-nav__item> <a href=#step-4-generate-coverage-report class=md-nav__link> <span class=md-ellipsis> Step 4: Generate Coverage Report </span> </a> </li> <li class=md-nav__item> <a href=#step-5-run-benchmarks class=md-nav__link> <span class=md-ellipsis> Step 5: Run Benchmarks </span> </a> </li> <li class=md-nav__item> <a href=#what-you-just-learned_10 class=md-nav__link> <span class=md-ellipsis> What You Just Learned </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#17-phase-11-enterprise-dashboard class=md-nav__link> <span class=md-ellipsis> 17. Phase 11: Enterprise Dashboard </span> </a> <nav class=md-nav aria-label="17. Phase 11: Enterprise Dashboard"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#understanding-the-dashboard class=md-nav__link> <span class=md-ellipsis> Understanding the Dashboard </span> </a> </li> <li class=md-nav__item> <a href=#step-1-setup-environment-variables class=md-nav__link> <span class=md-ellipsis> Step 1: Setup Environment Variables </span> </a> </li> <li class=md-nav__item> <a href=#step-2-start-infrastructure-docker class=md-nav__link> <span class=md-ellipsis> Step 2: Start Infrastructure (Docker) </span> </a> </li> <li class=md-nav__item> <a href=#step-3-access-the-dashboard class=md-nav__link> <span class=md-ellipsis> Step 3: Access the Dashboard </span> </a> </li> <li class=md-nav__item> <a href=#step-4-complete-walkthrough class=md-nav__link> <span class=md-ellipsis> Step 4: Complete Walkthrough </span> </a> </li> <li class=md-nav__item> <a href=#step-5-test-all-features class=md-nav__link> <span class=md-ellipsis> Step 5: Test All Features </span> </a> </li> <li class=md-nav__item> <a href=#what-you-just-learned_11 class=md-nav__link> <span class=md-ellipsis> What You Just Learned </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#18-updating-documentation class=md-nav__link> <span class=md-ellipsis> 18. Updating Documentation </span> </a> <nav class=md-nav aria-label="18. Updating Documentation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#issues-found-during-code-review class=md-nav__link> <span class=md-ellipsis> Issues Found During Code Review </span> </a> </li> <li class=md-nav__item> <a href=#update-documentation class=md-nav__link> <span class=md-ellipsis> Update Documentation </span> </a> </li> <li class=md-nav__item> <a href=#create-missing-documentation class=md-nav__link> <span class=md-ellipsis> Create Missing Documentation </span> </a> </li> <li class=md-nav__item> <a href=#what-you-just-did class=md-nav__link> <span class=md-ellipsis> What You Just Did </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#19-bug-fixes-issues-found class=md-nav__link> <span class=md-ellipsis> 19. Bug Fixes &amp; Issues Found </span> </a> <nav class=md-nav aria-label="19. Bug Fixes & Issues Found"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#issues-from-exploration-report class=md-nav__link> <span class=md-ellipsis> Issues from Exploration Report </span> </a> </li> <li class=md-nav__item> <a href=#no-critical-bugs-found class=md-nav__link> <span class=md-ellipsis> No Critical Bugs Found! </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#20-understanding-what-you-built class=md-nav__link> <span class=md-ellipsis> 20. Understanding What You Built </span> </a> <nav class=md-nav aria-label="20. Understanding What You Built"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#architecture-summary class=md-nav__link> <span class=md-ellipsis> Architecture Summary </span> </a> </li> <li class=md-nav__item> <a href=#performance-summary class=md-nav__link> <span class=md-ellipsis> Performance Summary </span> </a> </li> <li class=md-nav__item> <a href=#key-technologies class=md-nav__link> <span class=md-ellipsis> Key Technologies </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#21-next-steps-advanced-topics class=md-nav__link> <span class=md-ellipsis> 21. Next Steps &amp; Advanced Topics </span> </a> <nav class=md-nav aria-label="21. Next Steps & Advanced Topics"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#immediate-next-steps class=md-nav__link> <span class=md-ellipsis> Immediate Next Steps </span> </a> </li> <li class=md-nav__item> <a href=#advanced-topics class=md-nav__link> <span class=md-ellipsis> Advanced Topics </span> </a> </li> <li class=md-nav__item> <a href=#research-directions class=md-nav__link> <span class=md-ellipsis> Research Directions </span> </a> </li> <li class=md-nav__item> <a href=#contributing-to-the-project class=md-nav__link> <span class=md-ellipsis> Contributing to the Project </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#congratulations class=md-nav__link> <span class=md-ellipsis> Congratulations! ðŸŽ‰ </span> </a> <nav class=md-nav aria-label="Congratulations! ðŸŽ‰"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-you-accomplished class=md-nav__link> <span class=md-ellipsis> What You Accomplished </span> </a> </li> <li class=md-nav__item> <a href=#you-are-now-a-pro class=md-nav__link> <span class=md-ellipsis> You Are Now a Pro! ðŸš€ </span> </a> </li> <li class=md-nav__item> <a href=#share-your-success class=md-nav__link> <span class=md-ellipsis> Share Your Success! </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=lstm_pfd-complete-beginner-to-pro-guide>LSTM_PFD: Complete Beginner to Pro Guide<a class=headerlink href=#lstm_pfd-complete-beginner-to-pro-guide title="Permanent link">&para;</a></h1> <h2 id=zero-to-hero-every-single-step-explained>Zero to Hero - Every Single Step Explained<a class=headerlink href=#zero-to-hero-every-single-step-explained title="Permanent link">&para;</a></h2> <p><strong>Last Updated:</strong> November 23, 2025 <strong>For:</strong> Complete beginners who just cloned this repository <strong>Goal:</strong> Understand and run everything from setup to production deployment</p> <hr> <h2 id=table-of-contents>ðŸ“– Table of Contents<a class=headerlink href=#table-of-contents title="Permanent link">&para;</a></h2> <ol> <li><a href=#1-what-is-this-project>What is This Project?</a></li> <li><a href=#2-understanding-the-architecture>Understanding the Architecture</a></li> <li><a href=#3-prerequisites--system-requirements>Prerequisites &amp; System Requirements</a></li> <li><a href=#4-installation---step-by-step>Installation - Step by Step</a></li> <li><a href=#5-understanding-the-data>Understanding the Data</a></li> <li><a href=#6-phase-0-foundation--data-generation>Phase 0: Foundation &amp; Data Generation</a></li> <li><a href=#7-phase-1-classical-machine-learning-95-96>Phase 1: Classical Machine Learning (95-96%)</a></li> <li><a href=#8-phase-2-deep-learning---1d-cnns-93-95>Phase 2: Deep Learning - 1D CNNs (93-95%)</a></li> <li><a href=#9-phase-3-advanced-cnns-96-97>Phase 3: Advanced CNNs (96-97%)</a></li> <li><a href=#10-phase-4-transformers-96-97>Phase 4: Transformers (96-97%)</a></li> <li><a href=#11-phase-5-time-frequency-analysis-96-98>Phase 5: Time-Frequency Analysis (96-98%)</a></li> <li><a href=#12-phase-6-physics-informed-neural-networks-97-98>Phase 6: Physics-Informed Neural Networks (97-98%)</a></li> <li><a href=#13-phase-7-explainable-ai>Phase 7: Explainable AI</a></li> <li><a href=#14-phase-8-ensemble-methods-98-99>Phase 8: Ensemble Methods (98-99%)</a></li> <li><a href=#15-phase-9-production-deployment>Phase 9: Production Deployment</a></li> <li><a href=#16-phase-10-testing-everything>Phase 10: Testing Everything</a></li> <li><a href=#17-phase-11-enterprise-dashboard>Phase 11: Enterprise Dashboard</a></li> <li><a href=#18-updating-documentation>Updating Documentation</a></li> <li><a href=#19-bug-fixes--issues-found>Bug Fixes &amp; Issues Found</a></li> <li><a href=#20-understanding-what-you-built>Understanding What You Built</a></li> <li><a href=#21-next-steps--advanced-topics>Next Steps &amp; Advanced Topics</a></li> </ol> <hr> <h2 id=1-what-is-this-project>1. What is This Project?<a class=headerlink href=#1-what-is-this-project title="Permanent link">&para;</a></h2> <h3 id=the-problem>The Problem<a class=headerlink href=#the-problem title="Permanent link">&para;</a></h3> <p>Bearings are critical components in rotating machinery (motors, turbines, pumps). <strong>80% of unplanned industrial downtime</strong> is caused by bearing failures. This system predicts bearing faults <strong>before catastrophic failure</strong> occurs.</p> <h3 id=the-solution>The Solution<a class=headerlink href=#the-solution title="Permanent link">&para;</a></h3> <p>LSTM_PFD is a production-ready AI system that: - <strong>Detects 11 types of bearing faults</strong> with 98-99% accuracy - <strong>Predicts failures early</strong> using vibration signal analysis - <strong>Explains predictions</strong> so engineers understand why a fault was detected - <strong>Deploys in production</strong> with &lt;50ms inference time</p> <h3 id=what-youll-build>What You'll Build<a class=headerlink href=#what-youll-build title="Permanent link">&para;</a></h3> <p>By the end of this guide, you'll have: - âœ… Trained 20+ AI models (classical ML â†’ deep learning â†’ ensembles) - âœ… Achieved 98-99% accuracy on fault classification - âœ… Deployed a REST API for real-time predictions - âœ… Built an enterprise dashboard for managing experiments - âœ… Implemented explainable AI to interpret predictions - âœ… Run comprehensive tests to verify everything works</p> <hr> <h2 id=2-understanding-the-architecture>2. Understanding the Architecture<a class=headerlink href=#2-understanding-the-architecture title="Permanent link">&para;</a></h2> <h3 id=the-11-phases>The 11 Phases<a class=headerlink href=#the-11-phases title="Permanent link">&para;</a></h3> <p>This project is organized into <strong>11 sequential phases</strong>, each building on the previous:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>Phase 0: Foundation (Data Pipeline)
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>    â†“
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>Phase 1: Classical ML (Baseline: 95-96%)
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>    â†“
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>Phase 2: 1D CNNs (Deep Learning: 93-95%)
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>    â†“
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>Phase 3: Advanced CNNs (ResNet, EfficientNet: 96-97%)
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>    â†“
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>Phase 4: Transformers (Self-Attention: 96-97%)
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>    â†“
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>Phase 5: Time-Frequency (Spectrograms: 96-98%)
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>    â†“
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>Phase 6: Physics-Informed Neural Networks (97-98%)
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a>    â†“
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a>Phase 7: Explainable AI (Interpret Predictions)
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a>    â†“
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a>Phase 8: Ensemble Methods (Best: 98-99%)
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a>    â†“
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a>Phase 9: Production Deployment (Quantization, ONNX, API)
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a>    â†“
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a>Phase 10: Testing &amp; QA (90%+ coverage)
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a>    â†“
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a>Phase 11: Enterprise Dashboard (Web UI)
</span></code></pre></div> <h3 id=key-concepts>Key Concepts<a class=headerlink href=#key-concepts title="Permanent link">&para;</a></h3> <p><strong>Vibration Signals:</strong> - Bearings produce vibration as they rotate - Faults create distinctive vibration patterns - Signals are recorded at 20,480 Hz (20.48 kHz) - Each signal is 5 seconds long = 102,400 samples</p> <p><strong>11 Fault Types:</strong> 1. <strong>Normal</strong> - Healthy bearing 2. <strong>Ball Fault</strong> - Damage to rolling elements 3. <strong>Inner Race Fault</strong> - Inner ring damage 4. <strong>Outer Race Fault</strong> - Outer ring damage 5. <strong>Combined Fault</strong> - Multiple simultaneous faults 6. <strong>Imbalance</strong> - Rotor imbalance 7. <strong>Misalignment</strong> - Shaft misalignment 8. <strong>Oil Whirl</strong> - Lubricant-induced instability 9. <strong>Cavitation</strong> - Fluid cavitation damage 10. <strong>Looseness</strong> - Mechanical looseness 11. <strong>Oil Deficiency</strong> - Insufficient lubrication</p> <p><strong>Model Progression:</strong> - Start simple (Random Forest) â†’ 95-96% - Add deep learning (CNNs) â†’ 96-97% - Advanced techniques (Transformers, PINN) â†’ 97-98% - Combine models (Ensemble) â†’ 98-99%</p> <hr> <h2 id=3-prerequisites-system-requirements>3. Prerequisites &amp; System Requirements<a class=headerlink href=#3-prerequisites-system-requirements title="Permanent link">&para;</a></h2> <h3 id=minimum-requirements>Minimum Requirements<a class=headerlink href=#minimum-requirements title="Permanent link">&para;</a></h3> <ul> <li><strong>OS:</strong> Linux, macOS, or Windows 10+</li> <li><strong>Python:</strong> 3.8 or higher (3.10 recommended)</li> <li><strong>RAM:</strong> 16 GB (32 GB recommended)</li> <li><strong>Disk:</strong> 50 GB free space</li> <li><strong>CPU:</strong> 4 cores (8+ recommended)</li> <li><strong>GPU:</strong> Optional but highly recommended (NVIDIA with CUDA 11.8+)</li> </ul> <h3 id=recommended-setup-for-best-experience>Recommended Setup for Best Experience<a class=headerlink href=#recommended-setup-for-best-experience title="Permanent link">&para;</a></h3> <ul> <li><strong>GPU:</strong> NVIDIA RTX 3080 or better</li> <li><strong>RAM:</strong> 32 GB</li> <li><strong>SSD:</strong> 100+ GB for fast data access</li> <li><strong>Docker:</strong> For easy deployment</li> </ul> <h3 id=software-you-need-to-install>Software You Need to Install<a class=headerlink href=#software-you-need-to-install title="Permanent link">&para;</a></h3> <p><strong>1. Python 3.8+</strong> <div class="language-bash highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c1># Check if you have Python</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>python<span class=w> </span>--version
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=c1># or</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>python3<span class=w> </span>--version
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=c1># If not installed:</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=c1># macOS: brew install python@3.10</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=c1># Ubuntu: sudo apt install python3.10</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=c1># Windows: Download from python.org</span>
</span></code></pre></div></p> <p><strong>2. Git</strong> <div class="language-bash highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>git<span class=w> </span>--version
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=c1># If not installed:</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=c1># macOS: brew install git</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=c1># Ubuntu: sudo apt install git</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=c1># Windows: Download from git-scm.com</span>
</span></code></pre></div></p> <p><strong>3. PostgreSQL 15+ (for dashboard)</strong> <div class="language-bash highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=c1># macOS</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>brew<span class=w> </span>install<span class=w> </span>postgresql@15
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=c1># Ubuntu</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>sudo<span class=w> </span>apt<span class=w> </span>install<span class=w> </span>postgresql-15
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=c1># Windows</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=c1># Download from postgresql.org</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=c1># Or use Docker (easier):</span>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a>docker<span class=w> </span>run<span class=w> </span>--name<span class=w> </span>postgres<span class=w> </span>-e<span class=w> </span><span class=nv>POSTGRES_PASSWORD</span><span class=o>=</span>password<span class=w> </span>-p<span class=w> </span><span class=m>5432</span>:5432<span class=w> </span>-d<span class=w> </span>postgres:15
</span></code></pre></div></p> <p><strong>4. Redis 7+ (for dashboard)</strong> <div class="language-bash highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=c1># macOS</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>brew<span class=w> </span>install<span class=w> </span>redis
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=c1># Ubuntu</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>sudo<span class=w> </span>apt<span class=w> </span>install<span class=w> </span>redis
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=c1># Windows</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=c1># Use Docker</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=c1># Or with Docker:</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>docker<span class=w> </span>run<span class=w> </span>--name<span class=w> </span>redis<span class=w> </span>-p<span class=w> </span><span class=m>6379</span>:6379<span class=w> </span>-d<span class=w> </span>redis:7
</span></code></pre></div></p> <p><strong>5. CUDA Toolkit (optional, for GPU)</strong> <div class="language-bash highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=c1># Check if you have a CUDA-capable GPU</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>nvidia-smi
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=c1># If yes, install CUDA 11.8+</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=c1># Download from: developer.nvidia.com/cuda-downloads</span>
</span></code></pre></div></p> <hr> <h2 id=4-installation-step-by-step>4. Installation - Step by Step<a class=headerlink href=#4-installation-step-by-step title="Permanent link">&para;</a></h2> <h3 id=step-1-clone-the-repository>Step 1: Clone the Repository<a class=headerlink href=#step-1-clone-the-repository title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=c1># Navigate to where you want the project</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=nb>cd</span><span class=w> </span>~/Projects<span class=w>  </span><span class=c1># or any directory you prefer</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=c1># Clone the repository</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>git<span class=w> </span>clone<span class=w> </span>https://github.com/abbas-ahmad-cowlar/LSTM_PFD.git
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=c1># Enter the directory</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=nb>cd</span><span class=w> </span>LSTM_PFD
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=c1># Verify you&#39;re in the right place</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a>ls
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=c1># You should see: README.md, requirements.txt, data/, models/, etc.</span>
</span></code></pre></div> <p><strong>What you just did:</strong> - Downloaded all the code to your computer - You're now in the project's root directory</p> <h3 id=step-2-create-a-virtual-environment>Step 2: Create a Virtual Environment<a class=headerlink href=#step-2-create-a-virtual-environment title="Permanent link">&para;</a></h3> <p><strong>Why?</strong> Isolates this project's dependencies from your system Python.</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=c1># Create virtual environment</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>python3<span class=w> </span>-m<span class=w> </span>venv<span class=w> </span>venv
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=c1># Activate it</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=nb>source</span><span class=w> </span>venv/bin/activate<span class=w>  </span><span class=c1># On macOS/Linux</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=c1># OR</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>venv<span class=se>\S</span>cripts<span class=se>\a</span>ctivate<span class=w>     </span><span class=c1># On Windows</span>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=c1># Your prompt should now show (venv)</span>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=c1># Example: (venv) user@computer:~/LSTM_PFD$</span>
</span></code></pre></div> <p><strong>What you just did:</strong> - Created an isolated Python environment - Activated it (all packages will install here only) - To deactivate later: <code>deactivate</code></p> <h3 id=step-3-install-pytorch-critical>Step 3: Install PyTorch (Critical!)<a class=headerlink href=#step-3-install-pytorch-critical title="Permanent link">&para;</a></h3> <p><strong>Important:</strong> Install PyTorch FIRST with the correct CUDA version.</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=c1># Option A: GPU with CUDA 11.8 (recommended for fast training)</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>pip<span class=w> </span>install<span class=w> </span>torch<span class=w> </span>torchvision<span class=w> </span>torchaudio<span class=w> </span>--index-url<span class=w> </span>https://download.pytorch.org/whl/cu118
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=c1># Option B: CPU only (slower, but works on any computer)</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>pip<span class=w> </span>install<span class=w> </span>torch<span class=w> </span>torchvision<span class=w> </span>torchaudio<span class=w> </span>--index-url<span class=w> </span>https://download.pytorch.org/whl/cpu
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=c1># Verify installation</span>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>python<span class=w> </span>-c<span class=w> </span><span class=s2>&quot;import torch; print(f&#39;PyTorch: {torch.__version__}&#39;); print(f&#39;CUDA available: {torch.cuda.is_available()}&#39;)&quot;</span>
</span></code></pre></div> <p><strong>Expected output:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a>PyTorch: 2.1.0+cu118
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>CUDA available: True  # (or False if CPU-only)
</span></code></pre></div></p> <p><strong>What you just did:</strong> - Installed PyTorch, the deep learning framework - Installed CUDA support (if you chose GPU option) - Verified it works</p> <h3 id=step-4-install-all-dependencies>Step 4: Install All Dependencies<a class=headerlink href=#step-4-install-all-dependencies title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=c1># Install core dependencies (~50 packages, takes 2-5 minutes)</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>pip<span class=w> </span>install<span class=w> </span>-r<span class=w> </span>requirements.txt
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=c1># Install testing dependencies (optional, for Phase 10)</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>pip<span class=w> </span>install<span class=w> </span>-r<span class=w> </span>requirements-test.txt
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=c1># Install deployment dependencies (optional, for Phase 9)</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a>pip<span class=w> </span>install<span class=w> </span>-r<span class=w> </span>requirements-deployment.txt
</span></code></pre></div> <p><strong>What you just installed:</strong> - <strong>Scientific computing:</strong> numpy, scipy, pandas - <strong>Machine learning:</strong> scikit-learn - <strong>Signal processing:</strong> pywavelets - <strong>Visualization:</strong> matplotlib, seaborn, plotly - <strong>Deep learning extras:</strong> captum (for XAI) - <strong>Explainability:</strong> SHAP, LIME - <strong>Optimization:</strong> optuna - <strong>Dashboard:</strong> plotly-dash - <strong>API:</strong> fastapi, uvicorn - <strong>Database:</strong> sqlalchemy, psycopg2 - <strong>Caching:</strong> redis, celery - And more...</p> <h3 id=step-5-create-directory-structure>Step 5: Create Directory Structure<a class=headerlink href=#step-5-create-directory-structure title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=c1># Create all required directories</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>mkdir<span class=w> </span>-p<span class=w> </span>data/raw/bearing_data/<span class=o>{</span>normal,ball_fault,inner_race,outer_race,combined,imbalance,misalignment,oil_whirl,cavitation,looseness,oil_deficiency<span class=o>}</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>mkdir<span class=w> </span>-p<span class=w> </span>data/processed
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>mkdir<span class=w> </span>-p<span class=w> </span>data/spectrograms/<span class=o>{</span>stft,cwt,wvd<span class=o>}</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>mkdir<span class=w> </span>-p<span class=w> </span>checkpoints/<span class=o>{</span>phase1,phase2,phase3,phase4,phase5,phase6,phase7,phase8,phase9<span class=o>}</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>mkdir<span class=w> </span>-p<span class=w> </span>logs<span class=w> </span>results<span class=w> </span>visualizations<span class=w> </span>models
</span></code></pre></div> <p><strong>What you just did:</strong> - Created folders for: - <strong>data/raw/</strong> - Raw vibration data files - <strong>data/processed/</strong> - Processed datasets (HDF5 files) - <strong>data/spectrograms/</strong> - Time-frequency representations - <strong>checkpoints/</strong> - Saved model weights - <strong>logs/</strong> - Training logs - <strong>results/</strong> - Experiment results - <strong>visualizations/</strong> - Plots and figures - <strong>models/</strong> - Exported models (ONNX, etc.)</p> <h3 id=step-6-verify-installation>Step 6: Verify Installation<a class=headerlink href=#step-6-verify-installation title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=c1># Run verification script</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>python<span class=w> </span>-c<span class=w> </span><span class=s2>&quot;</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=s2>from models import list_available_models</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=s2>import torch</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=s2>import h5py</span>
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=s2>import shap</span>
</span><span id=__span-12-7><a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a><span class=s2>print(&#39;âœ… Installation successful!&#39;)</span>
</span><span id=__span-12-8><a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a><span class=s2>print(f&#39;PyTorch version: {torch.__version__}&#39;)</span>
</span><span id=__span-12-9><a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a><span class=s2>print(f&#39;CUDA available: {torch.cuda.is_available()}&#39;)</span>
</span><span id=__span-12-10><a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a><span class=s2>print(f&#39;Available model architectures: {len(list_available_models())}&#39;)</span>
</span><span id=__span-12-11><a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a><span class=s2>print(f&#39;SHAP version: {shap.__version__}&#39;)</span>
</span><span id=__span-12-12><a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a><span class=s2>print(f&#39;HDF5 support: OK&#39;)</span>
</span><span id=__span-12-13><a id=__codelineno-12-13 name=__codelineno-12-13 href=#__codelineno-12-13></a><span class=s2>&quot;</span>
</span></code></pre></div> <p><strong>Expected output:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a>âœ… Installation successful!
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>PyTorch version: 2.1.0+cu118
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>CUDA available: True
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a>Available model architectures: 23
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>SHAP version: 0.44.1
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a>HDF5 support: OK
</span></code></pre></div></p> <p><strong>What you just did:</strong> - Verified all critical packages are installed - Confirmed the model factory works - Checked GPU availability</p> <hr> <h2 id=5-understanding-the-data>5. Understanding the Data<a class=headerlink href=#5-understanding-the-data title="Permanent link">&para;</a></h2> <h3 id=signal-parameters>Signal Parameters<a class=headerlink href=#signal-parameters title="Permanent link">&para;</a></h3> <p>All vibration signals in this project follow these specifications:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=n>SAMPLING_RATE</span> <span class=o>=</span> <span class=mi>20480</span>  <span class=c1># Hz (samples per second)</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=n>SIGNAL_DURATION</span> <span class=o>=</span> <span class=mf>5.0</span>  <span class=c1># seconds</span>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=n>SIGNAL_LENGTH</span> <span class=o>=</span> <span class=mi>102400</span>  <span class=c1># samples (20480 Ã— 5)</span>
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=n>NUM_CLASSES</span> <span class=o>=</span> <span class=mi>11</span>       <span class=c1># Fault types</span>
</span></code></pre></div> <p><strong>What this means:</strong> - We record bearing vibration 20,480 times per second - Each recording is 5 seconds long - Each signal contains 102,400 data points - We classify into 11 categories</p> <h3 id=data-formats>Data Formats<a class=headerlink href=#data-formats title="Permanent link">&para;</a></h3> <p><strong>HDF5 Format (Recommended)</strong> â­ - <strong>25Ã— faster</strong> loading than .mat files - <strong>30% smaller</strong> file size - <strong>Single file</strong> contains all data with train/val/test splits - <strong>Lazy loading</strong> - memory efficient - File extension: <code>.h5</code></p> <p><strong>MATLAB .mat Format (Legacy)</strong> - Traditional format - Supported for backward compatibility - Slower to load - Each signal in a separate file</p> <p><strong>We'll use HDF5 for this guide.</strong></p> <h3 id=dataset-structure>Dataset Structure<a class=headerlink href=#dataset-structure title="Permanent link">&para;</a></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a>dataset.h5 (HDF5 file)
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>â”œâ”€â”€ train/
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a>â”‚   â”œâ”€â”€ signals  [N_train, 102400]  # Training signals
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a>â”‚   â””â”€â”€ labels   [N_train]          # Training labels (0-10)
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a>â”œâ”€â”€ val/
</span><span id=__span-15-6><a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a>â”‚   â”œâ”€â”€ signals  [N_val, 102400]    # Validation signals
</span><span id=__span-15-7><a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a>â”‚   â””â”€â”€ labels   [N_val]            # Validation labels
</span><span id=__span-15-8><a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a>â””â”€â”€ test/
</span><span id=__span-15-9><a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a>    â”œâ”€â”€ signals  [N_test, 102400]   # Test signals
</span><span id=__span-15-10><a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a>    â””â”€â”€ labels   [N_test]           # Test labels
</span></code></pre></div> <hr> <h2 id=6-phase-0-foundation-data-generation>6. Phase 0: Foundation &amp; Data Generation<a class=headerlink href=#6-phase-0-foundation-data-generation title="Permanent link">&para;</a></h2> <p><strong>Goal:</strong> Create a dataset of synthetic bearing fault signals <strong>Time:</strong> 10-30 minutes <strong>Output:</strong> <code>data/processed/dataset.h5</code> with 1,430 signals</p> <h3 id=why-synthetic-data>Why Synthetic Data?<a class=headerlink href=#why-synthetic-data title="Permanent link">&para;</a></h3> <p>For learning purposes, we'll generate realistic bearing fault signals using physics-based models. The signal generator simulates: - <strong>Bearing geometry</strong> (ball size, race dimensions) - <strong>Fault characteristics</strong> (spalls, cracks, imbalance) - <strong>Operating conditions</strong> (RPM, load, temperature) - <strong>Noise sources</strong> (sensor noise, EMI, environmental)</p> <h3 id=step-1-understand-the-signal-generator>Step 1: Understand the Signal Generator<a class=headerlink href=#step-1-understand-the-signal-generator title="Permanent link">&para;</a></h3> <p>The generator is in <code>data/signal_generator.py</code> (915 lines). It creates signals using: - <strong>Hertzian contact theory</strong> for bearing forces - <strong>Impulse response models</strong> for faults - <strong>7-layer noise model</strong> for realism - <strong>Random variations</strong> for data augmentation</p> <h3 id=step-2-generate-dataset>Step 2: Generate Dataset<a class=headerlink href=#step-2-generate-dataset title="Permanent link">&para;</a></h3> <p>Create a file <code>generate_dataset.py</code>:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=kn>from</span><span class=w> </span><span class=nn>data.signal_generator</span><span class=w> </span><span class=kn>import</span> <span class=n>SignalGenerator</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=kn>from</span><span class=w> </span><span class=nn>config.data_config</span><span class=w> </span><span class=kn>import</span> <span class=n>DataConfig</span>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=c1># Configure generation</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=n>config</span> <span class=o>=</span> <span class=n>DataConfig</span><span class=p>(</span>
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a>    <span class=n>num_signals_per_fault</span><span class=o>=</span><span class=mi>130</span><span class=p>,</span>  <span class=c1># 130 signals Ã— 11 fault types = 1,430 total</span>
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a>    <span class=n>rng_seed</span><span class=o>=</span><span class=mi>42</span>                  <span class=c1># For reproducibility</span>
</span><span id=__span-16-8><a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a><span class=p>)</span>
</span><span id=__span-16-9><a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a>
</span><span id=__span-16-10><a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a><span class=c1># Create generator</span>
</span><span id=__span-16-11><a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Initializing signal generator...&quot;</span><span class=p>)</span>
</span><span id=__span-16-12><a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a><span class=n>generator</span> <span class=o>=</span> <span class=n>SignalGenerator</span><span class=p>(</span><span class=n>config</span><span class=p>)</span>
</span><span id=__span-16-13><a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a>
</span><span id=__span-16-14><a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a><span class=c1># Generate all signals</span>
</span><span id=__span-16-15><a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Generating </span><span class=si>{</span><span class=mi>130</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>11</span><span class=si>}</span><span class=s2> bearing fault signals...&quot;</span><span class=p>)</span>
</span><span id=__span-16-16><a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;This will take 5-10 minutes. Good time for coffee! â˜•&quot;</span><span class=p>)</span>
</span><span id=__span-16-17><a id=__codelineno-16-17 name=__codelineno-16-17 href=#__codelineno-16-17></a><span class=n>dataset</span> <span class=o>=</span> <span class=n>generator</span><span class=o>.</span><span class=n>generate_dataset</span><span class=p>()</span>
</span><span id=__span-16-18><a id=__codelineno-16-18 name=__codelineno-16-18 href=#__codelineno-16-18></a>
</span><span id=__span-16-19><a id=__codelineno-16-19 name=__codelineno-16-19 href=#__codelineno-16-19></a><span class=c1># Save as HDF5 with automatic train/val/test splits</span>
</span><span id=__span-16-20><a id=__codelineno-16-20 name=__codelineno-16-20 href=#__codelineno-16-20></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Saving dataset to HDF5 format...&quot;</span><span class=p>)</span>
</span><span id=__span-16-21><a id=__codelineno-16-21 name=__codelineno-16-21 href=#__codelineno-16-21></a><span class=n>paths</span> <span class=o>=</span> <span class=n>generator</span><span class=o>.</span><span class=n>save_dataset</span><span class=p>(</span>
</span><span id=__span-16-22><a id=__codelineno-16-22 name=__codelineno-16-22 href=#__codelineno-16-22></a>    <span class=n>dataset</span><span class=p>,</span>
</span><span id=__span-16-23><a id=__codelineno-16-23 name=__codelineno-16-23 href=#__codelineno-16-23></a>    <span class=n>output_dir</span><span class=o>=</span><span class=s1>&#39;data/processed&#39;</span><span class=p>,</span>
</span><span id=__span-16-24><a id=__codelineno-16-24 name=__codelineno-16-24 href=#__codelineno-16-24></a>    <span class=nb>format</span><span class=o>=</span><span class=s1>&#39;hdf5&#39;</span><span class=p>,</span>
</span><span id=__span-16-25><a id=__codelineno-16-25 name=__codelineno-16-25 href=#__codelineno-16-25></a>    <span class=n>train_val_test_split</span><span class=o>=</span><span class=p>(</span><span class=mf>0.7</span><span class=p>,</span> <span class=mf>0.15</span><span class=p>,</span> <span class=mf>0.15</span><span class=p>)</span>  <span class=c1># 70/15/15 split</span>
</span><span id=__span-16-26><a id=__codelineno-16-26 name=__codelineno-16-26 href=#__codelineno-16-26></a><span class=p>)</span>
</span><span id=__span-16-27><a id=__codelineno-16-27 name=__codelineno-16-27 href=#__codelineno-16-27></a>
</span><span id=__span-16-28><a id=__codelineno-16-28 name=__codelineno-16-28 href=#__codelineno-16-28></a><span class=c1># Summary</span>
</span><span id=__span-16-29><a id=__codelineno-16-29 name=__codelineno-16-29 href=#__codelineno-16-29></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>60</span><span class=p>)</span>
</span><span id=__span-16-30><a id=__codelineno-16-30 name=__codelineno-16-30 href=#__codelineno-16-30></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;âœ… Dataset generation complete!&quot;</span><span class=p>)</span>
</span><span id=__span-16-31><a id=__codelineno-16-31 name=__codelineno-16-31 href=#__codelineno-16-31></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>60</span><span class=p>)</span>
</span><span id=__span-16-32><a id=__codelineno-16-32 name=__codelineno-16-32 href=#__codelineno-16-32></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Total signals: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>dataset</span><span class=p>[</span><span class=s1>&#39;signals&#39;</span><span class=p>])</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-16-33><a id=__codelineno-16-33 name=__codelineno-16-33 href=#__codelineno-16-33></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Signal length: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>dataset</span><span class=p>[</span><span class=s1>&#39;signals&#39;</span><span class=p>][</span><span class=mi>0</span><span class=p>])</span><span class=si>}</span><span class=s2> samples&quot;</span><span class=p>)</span>
</span><span id=__span-16-34><a id=__codelineno-16-34 name=__codelineno-16-34 href=#__codelineno-16-34></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Saved to: </span><span class=si>{</span><span class=n>paths</span><span class=p>[</span><span class=s1>&#39;hdf5&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-16-35><a id=__codelineno-16-35 name=__codelineno-16-35 href=#__codelineno-16-35></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Dataset split:&quot;</span><span class=p>)</span>
</span><span id=__span-16-36><a id=__codelineno-16-36 name=__codelineno-16-36 href=#__codelineno-16-36></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  - Training:   </span><span class=si>{</span><span class=nb>int</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>dataset</span><span class=p>[</span><span class=s1>&#39;signals&#39;</span><span class=p>])</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mf>0.7</span><span class=p>)</span><span class=si>}</span><span class=s2> signals (70%)&quot;</span><span class=p>)</span>
</span><span id=__span-16-37><a id=__codelineno-16-37 name=__codelineno-16-37 href=#__codelineno-16-37></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  - Validation: </span><span class=si>{</span><span class=nb>int</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>dataset</span><span class=p>[</span><span class=s1>&#39;signals&#39;</span><span class=p>])</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mf>0.15</span><span class=p>)</span><span class=si>}</span><span class=s2> signals (15%)&quot;</span><span class=p>)</span>
</span><span id=__span-16-38><a id=__codelineno-16-38 name=__codelineno-16-38 href=#__codelineno-16-38></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  - Test:       </span><span class=si>{</span><span class=nb>int</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>dataset</span><span class=p>[</span><span class=s1>&#39;signals&#39;</span><span class=p>])</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mf>0.15</span><span class=p>)</span><span class=si>}</span><span class=s2> signals (15%)&quot;</span><span class=p>)</span>
</span><span id=__span-16-39><a id=__codelineno-16-39 name=__codelineno-16-39 href=#__codelineno-16-39></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>60</span><span class=p>)</span>
</span></code></pre></div> <p>Run it: <div class="language-bash highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a>python<span class=w> </span>generate_dataset.py
</span></code></pre></div></p> <p><strong>Expected output:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a>Initializing signal generator...
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a>Generating 1430 bearing fault signals...
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a>This will take 5-10 minutes. Good time for coffee! â˜•
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a>
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a>Generating Normal signals... â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 130/130 [00:45]
</span><span id=__span-18-6><a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a>Generating Ball Fault signals... â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 130/130 [00:48]
</span><span id=__span-18-7><a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a>Generating Inner Race signals... â”â”â”â”â”â”â”â”â”â”â”â”â”â” 130/130 [00:47]
</span><span id=__span-18-8><a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a>... (continues for all 11 fault types)
</span><span id=__span-18-9><a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a>
</span><span id=__span-18-10><a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a>Saving dataset to HDF5 format...
</span><span id=__span-18-11><a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a>
</span><span id=__span-18-12><a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a>============================================================
</span><span id=__span-18-13><a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a>âœ… Dataset generation complete!
</span><span id=__span-18-14><a id=__codelineno-18-14 name=__codelineno-18-14 href=#__codelineno-18-14></a>============================================================
</span><span id=__span-18-15><a id=__codelineno-18-15 name=__codelineno-18-15 href=#__codelineno-18-15></a>Total signals: 1430
</span><span id=__span-18-16><a id=__codelineno-18-16 name=__codelineno-18-16 href=#__codelineno-18-16></a>Signal length: 102400 samples
</span><span id=__span-18-17><a id=__codelineno-18-17 name=__codelineno-18-17 href=#__codelineno-18-17></a>Saved to: data/processed/dataset.h5
</span><span id=__span-18-18><a id=__codelineno-18-18 name=__codelineno-18-18 href=#__codelineno-18-18></a>
</span><span id=__span-18-19><a id=__codelineno-18-19 name=__codelineno-18-19 href=#__codelineno-18-19></a>Dataset split:
</span><span id=__span-18-20><a id=__codelineno-18-20 name=__codelineno-18-20 href=#__codelineno-18-20></a>  - Training:   1001 signals (70%)
</span><span id=__span-18-21><a id=__codelineno-18-21 name=__codelineno-18-21 href=#__codelineno-18-21></a>  - Validation: 215 signals (15%)
</span><span id=__span-18-22><a id=__codelineno-18-22 name=__codelineno-18-22 href=#__codelineno-18-22></a>  - Test:       214 signals (15%)
</span><span id=__span-18-23><a id=__codelineno-18-23 name=__codelineno-18-23 href=#__codelineno-18-23></a>============================================================
</span></code></pre></div></p> <h3 id=step-3-verify-the-dataset>Step 3: Verify the Dataset<a class=headerlink href=#step-3-verify-the-dataset title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=c1># Inspect HDF5 file</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>python<span class=w> </span>-c<span class=w> </span><span class=s2>&quot;</span>
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=s2>import h5py</span>
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=s2>import numpy as np</span>
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a>
</span><span id=__span-19-6><a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a><span class=s2>with h5py.File(&#39;data/processed/dataset.h5&#39;, &#39;r&#39;) as f:</span>
</span><span id=__span-19-7><a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a><span class=s2>    print(&#39;HDF5 File Contents:&#39;)</span>
</span><span id=__span-19-8><a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a><span class=s2>    print(&#39;=&#39;*50)</span>
</span><span id=__span-19-9><a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a><span class=s2>    print(f&#39;Train signals: {f[\&quot;train/signals\&quot;].shape}&#39;)</span>
</span><span id=__span-19-10><a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a><span class=s2>    print(f&#39;Train labels:  {f[\&quot;train/labels\&quot;].shape}&#39;)</span>
</span><span id=__span-19-11><a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a><span class=s2>    print(f&#39;Val signals:   {f[\&quot;val/signals\&quot;].shape}&#39;)</span>
</span><span id=__span-19-12><a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a><span class=s2>    print(f&#39;Val labels:    {f[\&quot;val/labels\&quot;].shape}&#39;)</span>
</span><span id=__span-19-13><a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a><span class=s2>    print(f&#39;Test signals:  {f[\&quot;test/signals\&quot;].shape}&#39;)</span>
</span><span id=__span-19-14><a id=__codelineno-19-14 name=__codelineno-19-14 href=#__codelineno-19-14></a><span class=s2>    print(f&#39;Test labels:   {f[\&quot;test/labels\&quot;].shape}&#39;)</span>
</span><span id=__span-19-15><a id=__codelineno-19-15 name=__codelineno-19-15 href=#__codelineno-19-15></a>
</span><span id=__span-19-16><a id=__codelineno-19-16 name=__codelineno-19-16 href=#__codelineno-19-16></a><span class=s2>    # Check label distribution</span>
</span><span id=__span-19-17><a id=__codelineno-19-17 name=__codelineno-19-17 href=#__codelineno-19-17></a><span class=s2>    train_labels = f[&#39;train/labels&#39;][:]</span>
</span><span id=__span-19-18><a id=__codelineno-19-18 name=__codelineno-19-18 href=#__codelineno-19-18></a><span class=s2>    print(f&#39;\nClass distribution (training set):&#39;)</span>
</span><span id=__span-19-19><a id=__codelineno-19-19 name=__codelineno-19-19 href=#__codelineno-19-19></a><span class=s2>    for i in range(11):</span>
</span><span id=__span-19-20><a id=__codelineno-19-20 name=__codelineno-19-20 href=#__codelineno-19-20></a><span class=s2>        count = np.sum(train_labels == i)</span>
</span><span id=__span-19-21><a id=__codelineno-19-21 name=__codelineno-19-21 href=#__codelineno-19-21></a><span class=s2>        print(f&#39;  Class {i}: {count} signals&#39;)</span>
</span><span id=__span-19-22><a id=__codelineno-19-22 name=__codelineno-19-22 href=#__codelineno-19-22></a><span class=s2>&quot;</span>
</span></code></pre></div> <p><strong>Expected output:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a>HDF5 File Contents:
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>==================================================
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a>Train signals: (1001, 102400)
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a>Train labels:  (1001,)
</span><span id=__span-20-5><a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a>Val signals:   (215, 102400)
</span><span id=__span-20-6><a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a>Val labels:    (215,)
</span><span id=__span-20-7><a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a>Test signals:  (214, 102400)
</span><span id=__span-20-8><a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a>Test labels:   (214,)
</span><span id=__span-20-9><a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a>
</span><span id=__span-20-10><a id=__codelineno-20-10 name=__codelineno-20-10 href=#__codelineno-20-10></a>Class distribution (training set):
</span><span id=__span-20-11><a id=__codelineno-20-11 name=__codelineno-20-11 href=#__codelineno-20-11></a>  Class 0: 91 signals
</span><span id=__span-20-12><a id=__codelineno-20-12 name=__codelineno-20-12 href=#__codelineno-20-12></a>  Class 1: 91 signals
</span><span id=__span-20-13><a id=__codelineno-20-13 name=__codelineno-20-13 href=#__codelineno-20-13></a>  Class 2: 91 signals
</span><span id=__span-20-14><a id=__codelineno-20-14 name=__codelineno-20-14 href=#__codelineno-20-14></a>  ... (should be roughly balanced)
</span></code></pre></div></p> <h3 id=what-you-just-learned>What You Just Learned<a class=headerlink href=#what-you-just-learned title="Permanent link">&para;</a></h3> <ul> <li>âœ… How bearing fault signals are generated</li> <li>âœ… The signal parameters (fs=20480 Hz, T=5s)</li> <li>âœ… HDF5 format for efficient data storage</li> <li>âœ… Train/validation/test split rationale</li> <li>âœ… How to verify data integrity</li> </ul> <p><strong>Continue to <a href=#7-phase-1-classical-machine-learning-95-96>Phase 1</a></strong></p> <hr> <h2 id=7-phase-1-classical-machine-learning-95-96>7. Phase 1: Classical Machine Learning (95-96%)<a class=headerlink href=#7-phase-1-classical-machine-learning-95-96 title="Permanent link">&para;</a></h2> <p><strong>Goal:</strong> Establish a baseline using traditional ML <strong>Time:</strong> 30-60 minutes <strong>Accuracy:</strong> 95-96%</p> <h3 id=understanding-phase-1>Understanding Phase 1<a class=headerlink href=#understanding-phase-1 title="Permanent link">&para;</a></h3> <p>Before deep learning, let's see how far classical machine learning can go. We'll: 1. <strong>Extract 36 features</strong> from raw signals (time domain, frequency domain, wavelets) 2. <strong>Select 15 best features</strong> using MRMR (Maximum Relevance Minimum Redundancy) 3. <strong>Train 4 models:</strong> Random Forest, SVM, Neural Network, Gradient Boosting 4. <strong>Optimize hyperparameters</strong> with Bayesian optimization</p> <h3 id=the-36-features-explained>The 36 Features Explained<a class=headerlink href=#the-36-features-explained title="Permanent link">&para;</a></h3> <p><strong>Time Domain (12 features):</strong> - Mean, std, RMS, peak-to-peak - Skewness, kurtosis, crest factor - Clearance factor, shape factor, impulse factor - Energy, zero-crossing rate</p> <p><strong>Frequency Domain (12 features):</strong> - Peak frequency, mean frequency, frequency variance - Spectral centroid, spread, skewness, kurtosis - Spectral rolloff, flux, entropy - Power in bearing fault bands (BPFO, BPFI, BSF, FTF)</p> <p><strong>Wavelet Domain (12 features):</strong> - Energy in 6 wavelet levels (detail coefficients) - Energy in approximation coefficients - Wavelet entropy - Wavelet energy ratio</p> <h3 id=step-1-understand-the-pipeline>Step 1: Understand the Pipeline<a class=headerlink href=#step-1-understand-the-pipeline title="Permanent link">&para;</a></h3> <p>The code is in <code>pipelines/classical_ml_pipeline.py</code>. It does: <div class="language-python highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=n>signals</span> <span class=err>â†’</span> <span class=n>feature_extraction</span> <span class=err>â†’</span> <span class=n>feature_selection</span> <span class=err>â†’</span> <span class=n>model_training</span> <span class=err>â†’</span> <span class=n>evaluation</span>
</span></code></pre></div></p> <h3 id=step-2-run-classical-ml-baseline>Step 2: Run Classical ML Baseline<a class=headerlink href=#step-2-run-classical-ml-baseline title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=c1># Run the complete classical ML pipeline</span>
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a>python<span class=w> </span>scripts/train_classical_ml.py<span class=w> </span><span class=se>\</span>
</span><span id=__span-22-3><a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a><span class=w>    </span>--data<span class=w> </span>data/processed/dataset.h5<span class=w> </span><span class=se>\</span>
</span><span id=__span-22-4><a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a><span class=w>    </span>--output<span class=w> </span>results/phase1/<span class=w> </span><span class=se>\</span>
</span><span id=__span-22-5><a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a><span class=w>    </span>--optimize-hyperparams<span class=w> </span><span class=se>\</span>
</span><span id=__span-22-6><a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a><span class=w>    </span>--n-trials<span class=w> </span><span class=m>50</span>
</span></code></pre></div> <p><strong>What this command does:</strong> - <code>--data</code>: Path to HDF5 dataset - <code>--output</code>: Where to save results - <code>--optimize-hyperparams</code>: Use Bayesian optimization (50 trials) - <code>--n-trials</code>: Number of hyperparameter combinations to try</p> <p><strong>Expected output (takes ~30 min):</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a>Loading dataset from data/processed/dataset.h5...
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a>âœ“ Loaded 1430 signals
</span><span id=__span-23-3><a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a>
</span><span id=__span-23-4><a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a>Extracting features from signals...
</span><span id=__span-23-5><a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a>  Time domain features... â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 100% [01:15]
</span><span id=__span-23-6><a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a>  Frequency domain features... â”â”â”â”â”â”â”â”â”â”â”â”â”â” 100% [01:42]
</span><span id=__span-23-7><a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a>  Wavelet domain features... â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 100% [00:38]
</span><span id=__span-23-8><a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a>âœ“ Extracted 36 features
</span><span id=__span-23-9><a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a>
</span><span id=__span-23-10><a id=__codelineno-23-10 name=__codelineno-23-10 href=#__codelineno-23-10></a>Feature selection (MRMR)...
</span><span id=__span-23-11><a id=__codelineno-23-11 name=__codelineno-23-11 href=#__codelineno-23-11></a>  Evaluating relevance... âœ“
</span><span id=__span-23-12><a id=__codelineno-23-12 name=__codelineno-23-12 href=#__codelineno-23-12></a>  Removing redundancy... âœ“
</span><span id=__span-23-13><a id=__codelineno-23-13 name=__codelineno-23-13 href=#__codelineno-23-13></a>âœ“ Selected 15 features
</span><span id=__span-23-14><a id=__codelineno-23-14 name=__codelineno-23-14 href=#__codelineno-23-14></a>
</span><span id=__span-23-15><a id=__codelineno-23-15 name=__codelineno-23-15 href=#__codelineno-23-15></a>Training models...
</span><span id=__span-23-16><a id=__codelineno-23-16 name=__codelineno-23-16 href=#__codelineno-23-16></a>  Random Forest...
</span><span id=__span-23-17><a id=__codelineno-23-17 name=__codelineno-23-17 href=#__codelineno-23-17></a>    Optimizing hyperparameters (50 trials)...
</span><span id=__span-23-18><a id=__codelineno-23-18 name=__codelineno-23-18 href=#__codelineno-23-18></a>    Best params: {&#39;n_estimators&#39;: 500, &#39;max_depth&#39;: 30, ...}
</span><span id=__span-23-19><a id=__codelineno-23-19 name=__codelineno-23-19 href=#__codelineno-23-19></a>    Validation accuracy: 95.3%
</span><span id=__span-23-20><a id=__codelineno-23-20 name=__codelineno-23-20 href=#__codelineno-23-20></a>  âœ“ Random Forest: 95.3%
</span><span id=__span-23-21><a id=__codelineno-23-21 name=__codelineno-23-21 href=#__codelineno-23-21></a>
</span><span id=__span-23-22><a id=__codelineno-23-22 name=__codelineno-23-22 href=#__codelineno-23-22></a>  SVM...
</span><span id=__span-23-23><a id=__codelineno-23-23 name=__codelineno-23-23 href=#__codelineno-23-23></a>    Optimizing hyperparameters (50 trials)...
</span><span id=__span-23-24><a id=__codelineno-23-24 name=__codelineno-23-24 href=#__codelineno-23-24></a>    Best params: {&#39;C&#39;: 10, &#39;gamma&#39;: &#39;scale&#39;, ...}
</span><span id=__span-23-25><a id=__codelineno-23-25 name=__codelineno-23-25 href=#__codelineno-23-25></a>    Validation accuracy: 94.8%
</span><span id=__span-23-26><a id=__codelineno-23-26 name=__codelineno-23-26 href=#__codelineno-23-26></a>  âœ“ SVM: 94.8%
</span><span id=__span-23-27><a id=__codelineno-23-27 name=__codelineno-23-27 href=#__codelineno-23-27></a>
</span><span id=__span-23-28><a id=__codelineno-23-28 name=__codelineno-23-28 href=#__codelineno-23-28></a>  Neural Network...
</span><span id=__span-23-29><a id=__codelineno-23-29 name=__codelineno-23-29 href=#__codelineno-23-29></a>    Validation accuracy: 93.2%
</span><span id=__span-23-30><a id=__codelineno-23-30 name=__codelineno-23-30 href=#__codelineno-23-30></a>  âœ“ Neural Network: 93.2%
</span><span id=__span-23-31><a id=__codelineno-23-31 name=__codelineno-23-31 href=#__codelineno-23-31></a>
</span><span id=__span-23-32><a id=__codelineno-23-32 name=__codelineno-23-32 href=#__codelineno-23-32></a>  Gradient Boosting...
</span><span id=__span-23-33><a id=__codelineno-23-33 name=__codelineno-23-33 href=#__codelineno-23-33></a>    Optimizing hyperparameters (50 trials)...
</span><span id=__span-23-34><a id=__codelineno-23-34 name=__codelineno-23-34 href=#__codelineno-23-34></a>    Best params: {&#39;n_estimators&#39;: 200, &#39;learning_rate&#39;: 0.1, ...}
</span><span id=__span-23-35><a id=__codelineno-23-35 name=__codelineno-23-35 href=#__codelineno-23-35></a>    Validation accuracy: 94.5%
</span><span id=__span-23-36><a id=__codelineno-23-36 name=__codelineno-23-36 href=#__codelineno-23-36></a>  âœ“ Gradient Boosting: 94.5%
</span><span id=__span-23-37><a id=__codelineno-23-37 name=__codelineno-23-37 href=#__codelineno-23-37></a>
</span><span id=__span-23-38><a id=__codelineno-23-38 name=__codelineno-23-38 href=#__codelineno-23-38></a>Evaluating on test set...
</span><span id=__span-23-39><a id=__codelineno-23-39 name=__codelineno-23-39 href=#__codelineno-23-39></a>
</span><span id=__span-23-40><a id=__codelineno-23-40 name=__codelineno-23-40 href=#__codelineno-23-40></a>============================================================
</span><span id=__span-23-41><a id=__codelineno-23-41 name=__codelineno-23-41 href=#__codelineno-23-41></a>ðŸ† Best Model: Random Forest
</span><span id=__span-23-42><a id=__codelineno-23-42 name=__codelineno-23-42 href=#__codelineno-23-42></a>============================================================
</span><span id=__span-23-43><a id=__codelineno-23-43 name=__codelineno-23-43 href=#__codelineno-23-43></a>Test Accuracy:  95.33%
</span><span id=__span-23-44><a id=__codelineno-23-44 name=__codelineno-23-44 href=#__codelineno-23-44></a>Precision:      95.45%
</span><span id=__span-23-45><a id=__codelineno-23-45 name=__codelineno-23-45 href=#__codelineno-23-45></a>Recall:         95.33%
</span><span id=__span-23-46><a id=__codelineno-23-46 name=__codelineno-23-46 href=#__codelineno-23-46></a>F1-Score:       95.38%
</span><span id=__span-23-47><a id=__codelineno-23-47 name=__codelineno-23-47 href=#__codelineno-23-47></a>
</span><span id=__span-23-48><a id=__codelineno-23-48 name=__codelineno-23-48 href=#__codelineno-23-48></a>Per-class accuracy:
</span><span id=__span-23-49><a id=__codelineno-23-49 name=__codelineno-23-49 href=#__codelineno-23-49></a>  Normal:          100.0%
</span><span id=__span-23-50><a id=__codelineno-23-50 name=__codelineno-23-50 href=#__codelineno-23-50></a>  Ball Fault:       93.5%
</span><span id=__span-23-51><a id=__codelineno-23-51 name=__codelineno-23-51 href=#__codelineno-23-51></a>  Inner Race:       95.2%
</span><span id=__span-23-52><a id=__codelineno-23-52 name=__codelineno-23-52 href=#__codelineno-23-52></a>  Outer Race:       96.8%
</span><span id=__span-23-53><a id=__codelineno-23-53 name=__codelineno-23-53 href=#__codelineno-23-53></a>  Combined:         87.1%  â† (hardest class)
</span><span id=__span-23-54><a id=__codelineno-23-54 name=__codelineno-23-54 href=#__codelineno-23-54></a>  Imbalance:        97.4%
</span><span id=__span-23-55><a id=__codelineno-23-55 name=__codelineno-23-55 href=#__codelineno-23-55></a>  Misalignment:     96.8%
</span><span id=__span-23-56><a id=__codelineno-23-56 name=__codelineno-23-56 href=#__codelineno-23-56></a>  Oil Whirl:        93.5%
</span><span id=__span-23-57><a id=__codelineno-23-57 name=__codelineno-23-57 href=#__codelineno-23-57></a>  Cavitation:       95.2%
</span><span id=__span-23-58><a id=__codelineno-23-58 name=__codelineno-23-58 href=#__codelineno-23-58></a>  Looseness:        92.3%
</span><span id=__span-23-59><a id=__codelineno-23-59 name=__codelineno-23-59 href=#__codelineno-23-59></a>  Oil Deficiency:   96.8%
</span><span id=__span-23-60><a id=__codelineno-23-60 name=__codelineno-23-60 href=#__codelineno-23-60></a>
</span><span id=__span-23-61><a id=__codelineno-23-61 name=__codelineno-23-61 href=#__codelineno-23-61></a>Model saved: results/phase1/random_forest_best.pkl
</span><span id=__span-23-62><a id=__codelineno-23-62 name=__codelineno-23-62 href=#__codelineno-23-62></a>Results saved: results/phase1/results.json
</span><span id=__span-23-63><a id=__codelineno-23-63 name=__codelineno-23-63 href=#__codelineno-23-63></a>Confusion matrix: results/phase1/confusion_matrix.png
</span><span id=__span-23-64><a id=__codelineno-23-64 name=__codelineno-23-64 href=#__codelineno-23-64></a>============================================================
</span></code></pre></div></p> <h3 id=step-3-understand-the-results>Step 3: Understand the Results<a class=headerlink href=#step-3-understand-the-results title="Permanent link">&para;</a></h3> <p><strong>Confusion Matrix:</strong> <div class="language-bash highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=c1># View the confusion matrix</span>
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a>python<span class=w> </span>-c<span class=w> </span><span class=s2>&quot;</span>
</span><span id=__span-24-3><a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=s2>from PIL import Image</span>
</span><span id=__span-24-4><a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=s2>img = Image.open(&#39;results/phase1/confusion_matrix.png&#39;)</span>
</span><span id=__span-24-5><a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a><span class=s2>img.show()</span>
</span><span id=__span-24-6><a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a><span class=s2>&quot;</span>
</span></code></pre></div></p> <p>The diagonal should be bright (correct predictions), off-diagonal dark (mistakes).</p> <p><strong>Feature Importance:</strong> The 15 selected features are saved in <code>results/phase1/selected_features.txt</code>. Example: <div class="language-text highlight"><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a>1. RMS (time domain) - 0.245
</span><span id=__span-25-2><a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a>2. Peak frequency (frequency domain) - 0.198
</span><span id=__span-25-3><a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a>3. Kurtosis (time domain) - 0.187
</span><span id=__span-25-4><a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a>... (12 more)
</span></code></pre></div></p> <h3 id=what-you-just-learned_1>What You Just Learned<a class=headerlink href=#what-you-just-learned_1 title="Permanent link">&para;</a></h3> <ul> <li>âœ… Feature engineering for vibration signals</li> <li>âœ… MRMR feature selection algorithm</li> <li>âœ… Hyperparameter optimization with Optuna</li> <li>âœ… Baseline performance: <strong>95.33% accuracy</strong></li> <li>âœ… Random Forest outperforms other classical ML models</li> </ul> <p><strong>Key Insight:</strong> We achieved 95% accuracy without deep learning! But we can do better...</p> <hr> <h2 id=8-phase-2-deep-learning-1d-cnns-93-95>8. Phase 2: Deep Learning - 1D CNNs (93-95%)<a class=headerlink href=#8-phase-2-deep-learning-1d-cnns-93-95 title="Permanent link">&para;</a></h2> <p><strong>Goal:</strong> Let neural networks learn features automatically <strong>Time:</strong> 2-3 hours (GPU) or 10-15 hours (CPU) <strong>Accuracy:</strong> 93-95% (slightly lower than Phase 1, but more scalable)</p> <h3 id=understanding-phase-2>Understanding Phase 2<a class=headerlink href=#understanding-phase-2 title="Permanent link">&para;</a></h3> <p>Instead of manually engineering 36 features, we'll use <strong>1D Convolutional Neural Networks (CNNs)</strong> to learn optimal features directly from raw signals.</p> <p><strong>Architecture:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a>Input signal [102,400]
</span><span id=__span-26-2><a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a>    â†“
</span><span id=__span-26-3><a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a>Conv1D (kernel=15, filters=32)
</span><span id=__span-26-4><a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a>    â†“
</span><span id=__span-26-5><a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a>BatchNorm + ReLU + MaxPool
</span><span id=__span-26-6><a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a>    â†“
</span><span id=__span-26-7><a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a>Conv1D (kernel=11, filters=64)
</span><span id=__span-26-8><a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a>    â†“
</span><span id=__span-26-9><a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a>BatchNorm + ReLU + MaxPool
</span><span id=__span-26-10><a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a>    â†“
</span><span id=__span-26-11><a id=__codelineno-26-11 name=__codelineno-26-11 href=#__codelineno-26-11></a>Conv1D (kernel=7, filters=128)
</span><span id=__span-26-12><a id=__codelineno-26-12 name=__codelineno-26-12 href=#__codelineno-26-12></a>    â†“
</span><span id=__span-26-13><a id=__codelineno-26-13 name=__codelineno-26-13 href=#__codelineno-26-13></a>BatchNorm + ReLU + MaxPool
</span><span id=__span-26-14><a id=__codelineno-26-14 name=__codelineno-26-14 href=#__codelineno-26-14></a>    â†“
</span><span id=__span-26-15><a id=__codelineno-26-15 name=__codelineno-26-15 href=#__codelineno-26-15></a>Conv1D (kernel=5, filters=256)
</span><span id=__span-26-16><a id=__codelineno-26-16 name=__codelineno-26-16 href=#__codelineno-26-16></a>    â†“
</span><span id=__span-26-17><a id=__codelineno-26-17 name=__codelineno-26-17 href=#__codelineno-26-17></a>Global Average Pooling
</span><span id=__span-26-18><a id=__codelineno-26-18 name=__codelineno-26-18 href=#__codelineno-26-18></a>    â†“
</span><span id=__span-26-19><a id=__codelineno-26-19 name=__codelineno-26-19 href=#__codelineno-26-19></a>Dropout (0.5)
</span><span id=__span-26-20><a id=__codelineno-26-20 name=__codelineno-26-20 href=#__codelineno-26-20></a>    â†“
</span><span id=__span-26-21><a id=__codelineno-26-21 name=__codelineno-26-21 href=#__codelineno-26-21></a>Dense (11 classes)
</span></code></pre></div></p> <h3 id=step-1-train-baseline-cnn>Step 1: Train Baseline CNN<a class=headerlink href=#step-1-train-baseline-cnn title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=c1># Train the baseline 1D CNN</span>
</span><span id=__span-27-2><a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a>python<span class=w> </span>scripts/train_cnn.py<span class=w> </span><span class=se>\</span>
</span><span id=__span-27-3><a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a><span class=w>    </span>--model<span class=w> </span>cnn1d<span class=w> </span><span class=se>\</span>
</span><span id=__span-27-4><a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a><span class=w>    </span>--data-path<span class=w> </span>data/processed/dataset.h5<span class=w> </span><span class=se>\</span>
</span><span id=__span-27-5><a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a><span class=w>    </span>--epochs<span class=w> </span><span class=m>100</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-27-6><a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a><span class=w>    </span>--batch-size<span class=w> </span><span class=m>32</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-27-7><a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a><span class=w>    </span>--lr<span class=w> </span><span class=m>0</span>.001<span class=w> </span><span class=se>\</span>
</span><span id=__span-27-8><a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a><span class=w>    </span>--checkpoint-dir<span class=w> </span>checkpoints/phase2<span class=w> </span><span class=se>\</span>
</span><span id=__span-27-9><a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a><span class=w>    </span>--early-stopping<span class=w> </span><span class=se>\</span>
</span><span id=__span-27-10><a id=__codelineno-27-10 name=__codelineno-27-10 href=#__codelineno-27-10></a><span class=w>    </span>--patience<span class=w> </span><span class=m>15</span>
</span></code></pre></div> <p><strong>Arguments explained:</strong> - <code>--model cnn1d</code>: Multi-scale 1D CNN architecture - <code>--epochs 100</code>: Maximum training epochs - <code>--batch-size 32</code>: Process 32 signals at once - <code>--lr 0.001</code>: Learning rate - <code>--early-stopping</code>: Stop if validation accuracy doesn't improve for 15 epochs</p> <p><strong>Expected output (training progress):</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a>Loading dataset from HDF5...
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a>âœ“ Train: 1001 signals | Val: 215 signals | Test: 214 signals
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a>
</span><span id=__span-28-4><a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a>Model: CNN1D
</span><span id=__span-28-5><a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a>Parameters: 2,345,219
</span><span id=__span-28-6><a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a>GPU: NVIDIA RTX 3080 (10GB)
</span><span id=__span-28-7><a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a>
</span><span id=__span-28-8><a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a>Training...
</span><span id=__span-28-9><a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a>Epoch   1/100 | Loss: 2.234 | Train Acc: 34.2% | Val Acc: 44.5% | Time: 2.3min
</span><span id=__span-28-10><a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a>Epoch   5/100 | Loss: 0.982 | Train Acc: 76.3% | Val Acc: 81.2% | Time: 2.1min
</span><span id=__span-28-11><a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a>Epoch  10/100 | Loss: 0.523 | Train Acc: 89.3% | Val Acc: 92.1% | Time: 2.1min
</span><span id=__span-28-12><a id=__codelineno-28-12 name=__codelineno-28-12 href=#__codelineno-28-12></a>Epoch  20/100 | Loss: 0.234 | Train Acc: 94.8% | Val Acc: 93.5% | Time: 2.1min
</span><span id=__span-28-13><a id=__codelineno-28-13 name=__codelineno-28-13 href=#__codelineno-28-13></a>Epoch  30/100 | Loss: 0.121 | Train Acc: 96.5% | Val Acc: 94.2% | Time: 2.1min
</span><span id=__span-28-14><a id=__codelineno-28-14 name=__codelineno-28-14 href=#__codelineno-28-14></a>Epoch  40/100 | Loss: 0.067 | Train Acc: 97.8% | Val Acc: 94.6% | Time: 2.1min
</span><span id=__span-28-15><a id=__codelineno-28-15 name=__codelineno-28-15 href=#__codelineno-28-15></a>Epoch  50/100 | Loss: 0.039 | Train Acc: 98.5% | Val Acc: 94.7% | Time: 2.1min
</span><span id=__span-28-16><a id=__codelineno-28-16 name=__codelineno-28-16 href=#__codelineno-28-16></a>...
</span><span id=__span-28-17><a id=__codelineno-28-17 name=__codelineno-28-17 href=#__codelineno-28-17></a>Epoch  94/100 | Loss: 0.015 | Train Acc: 99.7% | Val Acc: 94.7% | Time: 2.1min
</span><span id=__span-28-18><a id=__codelineno-28-18 name=__codelineno-28-18 href=#__codelineno-28-18></a>
</span><span id=__span-28-19><a id=__codelineno-28-19 name=__codelineno-28-19 href=#__codelineno-28-19></a>Early stopping triggered (no improvement for 15 epochs)
</span><span id=__span-28-20><a id=__codelineno-28-20 name=__codelineno-28-20 href=#__codelineno-28-20></a>Best epoch: 79
</span><span id=__span-28-21><a id=__codelineno-28-21 name=__codelineno-28-21 href=#__codelineno-28-21></a>Best validation accuracy: 94.7%
</span><span id=__span-28-22><a id=__codelineno-28-22 name=__codelineno-28-22 href=#__codelineno-28-22></a>
</span><span id=__span-28-23><a id=__codelineno-28-23 name=__codelineno-28-23 href=#__codelineno-28-23></a>Evaluating on test set...
</span><span id=__span-28-24><a id=__codelineno-28-24 name=__codelineno-28-24 href=#__codelineno-28-24></a>
</span><span id=__span-28-25><a id=__codelineno-28-25 name=__codelineno-28-25 href=#__codelineno-28-25></a>============================================================
</span><span id=__span-28-26><a id=__codelineno-28-26 name=__codelineno-28-26 href=#__codelineno-28-26></a>ðŸ“Š CNN1D Results
</span><span id=__span-28-27><a id=__codelineno-28-27 name=__codelineno-28-27 href=#__codelineno-28-27></a>============================================================
</span><span id=__span-28-28><a id=__codelineno-28-28 name=__codelineno-28-28 href=#__codelineno-28-28></a>Test Accuracy:  94.39%
</span><span id=__span-28-29><a id=__codelineno-28-29 name=__codelineno-28-29 href=#__codelineno-28-29></a>Precision:      94.52%
</span><span id=__span-28-30><a id=__codelineno-28-30 name=__codelineno-28-30 href=#__codelineno-28-30></a>Recall:         94.39%
</span><span id=__span-28-31><a id=__codelineno-28-31 name=__codelineno-28-31 href=#__codelineno-28-31></a>F1-Score:       94.41%
</span><span id=__span-28-32><a id=__codelineno-28-32 name=__codelineno-28-32 href=#__codelineno-28-32></a>
</span><span id=__span-28-33><a id=__codelineno-28-33 name=__codelineno-28-33 href=#__codelineno-28-33></a>Training time: 3h 15min
</span><span id=__span-28-34><a id=__codelineno-28-34 name=__codelineno-28-34 href=#__codelineno-28-34></a>Inference time per signal: 45.2 ms
</span><span id=__span-28-35><a id=__codelineno-28-35 name=__codelineno-28-35 href=#__codelineno-28-35></a>
</span><span id=__span-28-36><a id=__codelineno-28-36 name=__codelineno-28-36 href=#__codelineno-28-36></a>Model saved: checkpoints/phase2/cnn1d_best.pth
</span><span id=__span-28-37><a id=__codelineno-28-37 name=__codelineno-28-37 href=#__codelineno-28-37></a>Training curves: results/phase2/training_curves.png
</span><span id=__span-28-38><a id=__codelineno-28-38 name=__codelineno-28-38 href=#__codelineno-28-38></a>============================================================
</span></code></pre></div></p> <h3 id=step-2-visualize-training>Step 2: Visualize Training<a class=headerlink href=#step-2-visualize-training title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-29-1><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=c1># Plot training history</span>
</span><span id=__span-29-2><a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a>python<span class=w> </span>-c<span class=w> </span><span class=s2>&quot;</span>
</span><span id=__span-29-3><a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a><span class=s2>import torch</span>
</span><span id=__span-29-4><a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a><span class=s2>import matplotlib.pyplot as plt</span>
</span><span id=__span-29-5><a id=__codelineno-29-5 name=__codelineno-29-5 href=#__codelineno-29-5></a>
</span><span id=__span-29-6><a id=__codelineno-29-6 name=__codelineno-29-6 href=#__codelineno-29-6></a><span class=s2># Load checkpoint</span>
</span><span id=__span-29-7><a id=__codelineno-29-7 name=__codelineno-29-7 href=#__codelineno-29-7></a><span class=s2>checkpoint = torch.load(&#39;checkpoints/phase2/cnn1d_best.pth&#39;)</span>
</span><span id=__span-29-8><a id=__codelineno-29-8 name=__codelineno-29-8 href=#__codelineno-29-8></a><span class=s2>history = checkpoint[&#39;history&#39;]</span>
</span><span id=__span-29-9><a id=__codelineno-29-9 name=__codelineno-29-9 href=#__codelineno-29-9></a>
</span><span id=__span-29-10><a id=__codelineno-29-10 name=__codelineno-29-10 href=#__codelineno-29-10></a><span class=s2># Plot</span>
</span><span id=__span-29-11><a id=__codelineno-29-11 name=__codelineno-29-11 href=#__codelineno-29-11></a><span class=s2>fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 4))</span>
</span><span id=__span-29-12><a id=__codelineno-29-12 name=__codelineno-29-12 href=#__codelineno-29-12></a>
</span><span id=__span-29-13><a id=__codelineno-29-13 name=__codelineno-29-13 href=#__codelineno-29-13></a><span class=s2># Loss</span>
</span><span id=__span-29-14><a id=__codelineno-29-14 name=__codelineno-29-14 href=#__codelineno-29-14></a><span class=s2>ax1.plot(history[&#39;train_loss&#39;], label=&#39;Train&#39;)</span>
</span><span id=__span-29-15><a id=__codelineno-29-15 name=__codelineno-29-15 href=#__codelineno-29-15></a><span class=s2>ax1.plot(history[&#39;val_loss&#39;], label=&#39;Validation&#39;)</span>
</span><span id=__span-29-16><a id=__codelineno-29-16 name=__codelineno-29-16 href=#__codelineno-29-16></a><span class=s2>ax1.set_xlabel(&#39;Epoch&#39;)</span>
</span><span id=__span-29-17><a id=__codelineno-29-17 name=__codelineno-29-17 href=#__codelineno-29-17></a><span class=s2>ax1.set_ylabel(&#39;Loss&#39;)</span>
</span><span id=__span-29-18><a id=__codelineno-29-18 name=__codelineno-29-18 href=#__codelineno-29-18></a><span class=s2>ax1.set_title(&#39;Training Loss&#39;)</span>
</span><span id=__span-29-19><a id=__codelineno-29-19 name=__codelineno-29-19 href=#__codelineno-29-19></a><span class=s2>ax1.legend()</span>
</span><span id=__span-29-20><a id=__codelineno-29-20 name=__codelineno-29-20 href=#__codelineno-29-20></a><span class=s2>ax1.grid(True)</span>
</span><span id=__span-29-21><a id=__codelineno-29-21 name=__codelineno-29-21 href=#__codelineno-29-21></a>
</span><span id=__span-29-22><a id=__codelineno-29-22 name=__codelineno-29-22 href=#__codelineno-29-22></a><span class=s2># Accuracy</span>
</span><span id=__span-29-23><a id=__codelineno-29-23 name=__codelineno-29-23 href=#__codelineno-29-23></a><span class=s2>ax2.plot(history[&#39;train_acc&#39;], label=&#39;Train&#39;)</span>
</span><span id=__span-29-24><a id=__codelineno-29-24 name=__codelineno-29-24 href=#__codelineno-29-24></a><span class=s2>ax2.plot(history[&#39;val_acc&#39;], label=&#39;Validation&#39;)</span>
</span><span id=__span-29-25><a id=__codelineno-29-25 name=__codelineno-29-25 href=#__codelineno-29-25></a><span class=s2>ax2.set_xlabel(&#39;Epoch&#39;)</span>
</span><span id=__span-29-26><a id=__codelineno-29-26 name=__codelineno-29-26 href=#__codelineno-29-26></a><span class=s2>ax2.set_ylabel(&#39;Accuracy (%)&#39;)</span>
</span><span id=__span-29-27><a id=__codelineno-29-27 name=__codelineno-29-27 href=#__codelineno-29-27></a><span class=s2>ax2.set_title(&#39;Accuracy&#39;)</span>
</span><span id=__span-29-28><a id=__codelineno-29-28 name=__codelineno-29-28 href=#__codelineno-29-28></a><span class=s2>ax2.legend()</span>
</span><span id=__span-29-29><a id=__codelineno-29-29 name=__codelineno-29-29 href=#__codelineno-29-29></a><span class=s2>ax2.grid(True)</span>
</span><span id=__span-29-30><a id=__codelineno-29-30 name=__codelineno-29-30 href=#__codelineno-29-30></a>
</span><span id=__span-29-31><a id=__codelineno-29-31 name=__codelineno-29-31 href=#__codelineno-29-31></a><span class=s2>plt.tight_layout()</span>
</span><span id=__span-29-32><a id=__codelineno-29-32 name=__codelineno-29-32 href=#__codelineno-29-32></a><span class=s2>plt.savefig(&#39;results/phase2/training_curves.png&#39;, dpi=150)</span>
</span><span id=__span-29-33><a id=__codelineno-29-33 name=__codelineno-29-33 href=#__codelineno-29-33></a><span class=s2>print(&#39;âœ“ Saved to results/phase2/training_curves.png&#39;)</span>
</span><span id=__span-29-34><a id=__codelineno-29-34 name=__codelineno-29-34 href=#__codelineno-29-34></a><span class=s2>&quot;</span>
</span></code></pre></div> <h3 id=step-3-understand-the-results_1>Step 3: Understand the Results<a class=headerlink href=#step-3-understand-the-results_1 title="Permanent link">&para;</a></h3> <p><strong>Why is CNN accuracy (94.4%) slightly lower than Random Forest (95.3%)?</strong></p> <ol> <li><strong>Small dataset</strong>: Only 1,430 signals. Deep learning needs 10,000+ for best performance.</li> <li><strong>Overfitting</strong>: CNN has 2.3M parameters but only 1,001 training samples.</li> <li><strong>Solution</strong>: More data OR better architecture (Phase 3)</li> </ol> <p><strong>But CNNs have advantages:</strong> - <strong>Scalable</strong>: Performance improves with more data - <strong>End-to-end</strong>: No manual feature engineering - <strong>Transferable</strong>: Can fine-tune on new bearing types - <strong>Fast inference</strong>: 45ms vs Random Forest's ~300ms</p> <h3 id=what-you-just-learned_2>What You Just Learned<a class=headerlink href=#what-you-just-learned_2 title="Permanent link">&para;</a></h3> <ul> <li>âœ… 1D CNNs for time-series classification</li> <li>âœ… Multi-scale kernels (15, 11, 7, 5) capture different patterns</li> <li>âœ… Batch normalization stabilizes training</li> <li>âœ… Early stopping prevents overfitting</li> <li>âœ… Trade-off: CNNs need more data but scale better</li> </ul> <hr> <h2 id=9-phase-3-advanced-cnns-96-97>9. Phase 3: Advanced CNNs (96-97%)<a class=headerlink href=#9-phase-3-advanced-cnns-96-97 title="Permanent link">&para;</a></h2> <p><strong>Goal:</strong> Use state-of-the-art CNN architectures <strong>Time:</strong> 3-4 hours per model <strong>Accuracy:</strong> 96-97%</p> <h3 id=understanding-phase-3>Understanding Phase 3<a class=headerlink href=#understanding-phase-3 title="Permanent link">&para;</a></h3> <p>We'll train several advanced architectures adapted for 1D signals:</p> <ol> <li><strong>ResNet-18/34/50</strong>: Residual connections allow very deep networks</li> <li><strong>SE-ResNet</strong>: Adds "squeeze-and-excitation" attention</li> <li><strong>EfficientNet</strong>: Compound scaling (width, depth, resolution)</li> <li><strong>Wide ResNet</strong>: Wider instead of deeper</li> </ol> <h3 id=step-1-train-resnet-34-recommended>Step 1: Train ResNet-34 (Recommended)<a class=headerlink href=#step-1-train-resnet-34-recommended title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-30-1><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=c1># ResNet-34 for 1D signals</span>
</span><span id=__span-30-2><a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a>python<span class=w> </span>scripts/train_cnn.py<span class=w> </span><span class=se>\</span>
</span><span id=__span-30-3><a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a><span class=w>    </span>--model<span class=w> </span>resnet34<span class=w> </span><span class=se>\</span>
</span><span id=__span-30-4><a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a><span class=w>    </span>--data-path<span class=w> </span>data/processed/dataset.h5<span class=w> </span><span class=se>\</span>
</span><span id=__span-30-5><a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a><span class=w>    </span>--epochs<span class=w> </span><span class=m>150</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-30-6><a id=__codelineno-30-6 name=__codelineno-30-6 href=#__codelineno-30-6></a><span class=w>    </span>--batch-size<span class=w> </span><span class=m>32</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-30-7><a id=__codelineno-30-7 name=__codelineno-30-7 href=#__codelineno-30-7></a><span class=w>    </span>--lr<span class=w> </span><span class=m>0</span>.001<span class=w> </span><span class=se>\</span>
</span><span id=__span-30-8><a id=__codelineno-30-8 name=__codelineno-30-8 href=#__codelineno-30-8></a><span class=w>    </span>--scheduler<span class=w> </span>reduce_lr_on_plateau<span class=w> </span><span class=se>\</span>
</span><span id=__span-30-9><a id=__codelineno-30-9 name=__codelineno-30-9 href=#__codelineno-30-9></a><span class=w>    </span>--checkpoint-dir<span class=w> </span>checkpoints/phase3/resnet34
</span></code></pre></div> <p><strong>Expected result:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-31-1><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a>Model: ResNet-34-1D
</span><span id=__span-31-2><a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a>Parameters: 21,234,123
</span><span id=__span-31-3><a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a>
</span><span id=__span-31-4><a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a>Best validation accuracy: 96.7%
</span><span id=__span-31-5><a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a>Test accuracy: 96.5%
</span><span id=__span-31-6><a id=__codelineno-31-6 name=__codelineno-31-6 href=#__codelineno-31-6></a>
</span><span id=__span-31-7><a id=__codelineno-31-7 name=__codelineno-31-7 href=#__codelineno-31-7></a>Improvement over Phase 2: +2.1 percentage points
</span></code></pre></div></p> <h3 id=step-2-train-multiple-models-in-parallel>Step 2: Train Multiple Models in Parallel<a class=headerlink href=#step-2-train-multiple-models-in-parallel title="Permanent link">&para;</a></h3> <p>To save time, train models simultaneously on different GPUs (if you have multiple):</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-32-1><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=c1># Terminal 1 (GPU 0)</span>
</span><span id=__span-32-2><a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a><span class=nv>CUDA_VISIBLE_DEVICES</span><span class=o>=</span><span class=m>0</span><span class=w> </span>python<span class=w> </span>scripts/train_cnn.py<span class=w> </span>--model<span class=w> </span>resnet18<span class=w> </span>...
</span><span id=__span-32-3><a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a>
</span><span id=__span-32-4><a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a><span class=c1># Terminal 2 (GPU 1)</span>
</span><span id=__span-32-5><a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a><span class=nv>CUDA_VISIBLE_DEVICES</span><span class=o>=</span><span class=m>1</span><span class=w> </span>python<span class=w> </span>scripts/train_cnn.py<span class=w> </span>--model<span class=w> </span>resnet50<span class=w> </span>...
</span><span id=__span-32-6><a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a>
</span><span id=__span-32-7><a id=__codelineno-32-7 name=__codelineno-32-7 href=#__codelineno-32-7></a><span class=c1># Terminal 3 (GPU 2)</span>
</span><span id=__span-32-8><a id=__codelineno-32-8 name=__codelineno-32-8 href=#__codelineno-32-8></a><span class=nv>CUDA_VISIBLE_DEVICES</span><span class=o>=</span><span class=m>2</span><span class=w> </span>python<span class=w> </span>scripts/train_cnn.py<span class=w> </span>--model<span class=w> </span>efficientnet_b3<span class=w> </span>...
</span></code></pre></div> <p>Or sequentially: <div class="language-bash highlight"><pre><span></span><code><span id=__span-33-1><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=k>for</span><span class=w> </span>model<span class=w> </span><span class=k>in</span><span class=w> </span>resnet18<span class=w> </span>resnet34<span class=w> </span>resnet50<span class=w> </span>efficientnet_b3<span class=p>;</span><span class=w> </span><span class=k>do</span>
</span><span id=__span-33-2><a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a><span class=w>    </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;Training </span><span class=nv>$model</span><span class=s2>...&quot;</span>
</span><span id=__span-33-3><a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a><span class=w>    </span>python<span class=w> </span>scripts/train_cnn.py<span class=w> </span><span class=se>\</span>
</span><span id=__span-33-4><a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a><span class=w>        </span>--model<span class=w> </span><span class=nv>$model</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-33-5><a id=__codelineno-33-5 name=__codelineno-33-5 href=#__codelineno-33-5></a><span class=w>        </span>--data-path<span class=w> </span>data/processed/dataset.h5<span class=w> </span><span class=se>\</span>
</span><span id=__span-33-6><a id=__codelineno-33-6 name=__codelineno-33-6 href=#__codelineno-33-6></a><span class=w>        </span>--epochs<span class=w> </span><span class=m>150</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-33-7><a id=__codelineno-33-7 name=__codelineno-33-7 href=#__codelineno-33-7></a><span class=w>        </span>--checkpoint-dir<span class=w> </span>checkpoints/phase3/<span class=nv>$model</span>
</span><span id=__span-33-8><a id=__codelineno-33-8 name=__codelineno-33-8 href=#__codelineno-33-8></a><span class=k>done</span>
</span></code></pre></div></p> <h3 id=step-3-compare-all-models>Step 3: Compare All Models<a class=headerlink href=#step-3-compare-all-models title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-34-1><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=c1># Evaluate all Phase 3 models</span>
</span><span id=__span-34-2><a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a>python<span class=w> </span>scripts/compare_models.py<span class=w> </span><span class=se>\</span>
</span><span id=__span-34-3><a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a><span class=w>    </span>--models<span class=w> </span>checkpoints/phase3/*/best.pth<span class=w> </span><span class=se>\</span>
</span><span id=__span-34-4><a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a><span class=w>    </span>--test-data<span class=w> </span>data/processed/dataset.h5<span class=w> </span><span class=se>\</span>
</span><span id=__span-34-5><a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a><span class=w>    </span>--output<span class=w> </span>results/phase3/comparison.html
</span></code></pre></div> <p><strong>Expected comparison:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-35-1><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a>Model             Test Acc   Params     Inference Time
</span><span id=__span-35-2><a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a>---------------------------------------------------------
</span><span id=__span-35-3><a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a>ResNet-18         96.2%      11.2M      28.3ms
</span><span id=__span-35-4><a id=__codelineno-35-4 name=__codelineno-35-4 href=#__codelineno-35-4></a>ResNet-34         96.7%      21.3M      38.5ms  â† Best accuracy
</span><span id=__span-35-5><a id=__codelineno-35-5 name=__codelineno-35-5 href=#__codelineno-35-5></a>ResNet-50         96.5%      23.5M      52.1ms
</span><span id=__span-35-6><a id=__codelineno-35-6 name=__codelineno-35-6 href=#__codelineno-35-6></a>SE-ResNet-34      96.8%      21.4M      41.2ms
</span><span id=__span-35-7><a id=__codelineno-35-7 name=__codelineno-35-7 href=#__codelineno-35-7></a>EfficientNet-B3   96.4%      12.2M      35.7ms  â† Best efficiency
</span><span id=__span-35-8><a id=__codelineno-35-8 name=__codelineno-35-8 href=#__codelineno-35-8></a>Wide-ResNet       96.1%      35.8M      67.3ms
</span></code></pre></div></p> <h3 id=what-you-just-learned_3>What You Just Learned<a class=headerlink href=#what-you-just-learned_3 title="Permanent link">&para;</a></h3> <ul> <li>âœ… Residual connections help train deep networks</li> <li>âœ… ResNet-34 achieves 96.7% (vs 95.3% Phase 1, 94.4% Phase 2)</li> <li>âœ… Architecture matters more than depth</li> <li>âœ… SE-ResNet-34 is the winner for Phase 3</li> </ul> <hr> <h2 id=10-phase-4-transformers-96-97>10. Phase 4: Transformers (96-97%)<a class=headerlink href=#10-phase-4-transformers-96-97 title="Permanent link">&para;</a></h2> <p><strong>Goal:</strong> Apply self-attention to vibration signals <strong>Time:</strong> 4-6 hours <strong>Accuracy:</strong> 96-97%</p> <h3 id=understanding-transformers>Understanding Transformers<a class=headerlink href=#understanding-transformers title="Permanent link">&para;</a></h3> <p>Transformers use <strong>self-attention</strong> to capture long-range dependencies. For vibration signals: - Divide signal into <strong>patches</strong> (e.g., 512 patches of 200 samples each) - Each patch attends to all other patches - Learns which parts of the signal are important</p> <p><strong>Architecture:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-36-1><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a>Input signal [102,400]
</span><span id=__span-36-2><a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a>    â†“
</span><span id=__span-36-3><a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a>Patch Embedding (200 samples/patch â†’ 512 patches)
</span><span id=__span-36-4><a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a>    â†“
</span><span id=__span-36-5><a id=__codelineno-36-5 name=__codelineno-36-5 href=#__codelineno-36-5></a>Positional Encoding
</span><span id=__span-36-6><a id=__codelineno-36-6 name=__codelineno-36-6 href=#__codelineno-36-6></a>    â†“
</span><span id=__span-36-7><a id=__codelineno-36-7 name=__codelineno-36-7 href=#__codelineno-36-7></a>Transformer Encoder (6 layers, 8 heads)
</span><span id=__span-36-8><a id=__codelineno-36-8 name=__codelineno-36-8 href=#__codelineno-36-8></a>    â†“
</span><span id=__span-36-9><a id=__codelineno-36-9 name=__codelineno-36-9 href=#__codelineno-36-9></a>Global Average Pooling
</span><span id=__span-36-10><a id=__codelineno-36-10 name=__codelineno-36-10 href=#__codelineno-36-10></a>    â†“
</span><span id=__span-36-11><a id=__codelineno-36-11 name=__codelineno-36-11 href=#__codelineno-36-11></a>Classification Head (11 classes)
</span></code></pre></div></p> <h3 id=step-1-train-transformer>Step 1: Train Transformer<a class=headerlink href=#step-1-train-transformer title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-37-1><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=c1># Train transformer</span>
</span><span id=__span-37-2><a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a>python<span class=w> </span>scripts/train_transformer.py<span class=w> </span><span class=se>\</span>
</span><span id=__span-37-3><a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a><span class=w>    </span>--data-path<span class=w> </span>data/processed/dataset.h5<span class=w> </span><span class=se>\</span>
</span><span id=__span-37-4><a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a><span class=w>    </span>--d-model<span class=w> </span><span class=m>256</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-37-5><a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a><span class=w>    </span>--nhead<span class=w> </span><span class=m>8</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-37-6><a id=__codelineno-37-6 name=__codelineno-37-6 href=#__codelineno-37-6></a><span class=w>    </span>--num-layers<span class=w> </span><span class=m>6</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-37-7><a id=__codelineno-37-7 name=__codelineno-37-7 href=#__codelineno-37-7></a><span class=w>    </span>--epochs<span class=w> </span><span class=m>100</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-37-8><a id=__codelineno-37-8 name=__codelineno-37-8 href=#__codelineno-37-8></a><span class=w>    </span>--batch-size<span class=w> </span><span class=m>32</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-37-9><a id=__codelineno-37-9 name=__codelineno-37-9 href=#__codelineno-37-9></a><span class=w>    </span>--warmup-epochs<span class=w> </span><span class=m>10</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-37-10><a id=__codelineno-37-10 name=__codelineno-37-10 href=#__codelineno-37-10></a><span class=w>    </span>--checkpoint-dir<span class=w> </span>checkpoints/phase4
</span></code></pre></div> <p><strong>Critical:</strong> Transformers require <strong>learning rate warmup</strong>!</p> <h3 id=step-2-visualize-attention>Step 2: Visualize Attention<a class=headerlink href=#step-2-visualize-attention title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-38-1><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=c1># attention_visualization.py</span>
</span><span id=__span-38-2><a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a><span class=kn>from</span><span class=w> </span><span class=nn>transformers</span><span class=w> </span><span class=kn>import</span> <span class=n>load_transformer</span>
</span><span id=__span-38-3><a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a><span class=kn>from</span><span class=w> </span><span class=nn>utils.plotting</span><span class=w> </span><span class=kn>import</span> <span class=n>plot_attention_weights</span>
</span><span id=__span-38-4><a id=__codelineno-38-4 name=__codelineno-38-4 href=#__codelineno-38-4></a><span class=kn>import</span><span class=w> </span><span class=nn>h5py</span>
</span><span id=__span-38-5><a id=__codelineno-38-5 name=__codelineno-38-5 href=#__codelineno-38-5></a>
</span><span id=__span-38-6><a id=__codelineno-38-6 name=__codelineno-38-6 href=#__codelineno-38-6></a><span class=c1># Load model and signal</span>
</span><span id=__span-38-7><a id=__codelineno-38-7 name=__codelineno-38-7 href=#__codelineno-38-7></a><span class=n>model</span> <span class=o>=</span> <span class=n>load_transformer</span><span class=p>(</span><span class=s1>&#39;checkpoints/phase4/best.pth&#39;</span><span class=p>)</span>
</span><span id=__span-38-8><a id=__codelineno-38-8 name=__codelineno-38-8 href=#__codelineno-38-8></a><span class=k>with</span> <span class=n>h5py</span><span class=o>.</span><span class=n>File</span><span class=p>(</span><span class=s1>&#39;data/processed/dataset.h5&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-38-9><a id=__codelineno-38-9 name=__codelineno-38-9 href=#__codelineno-38-9></a>    <span class=n>signal</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=s1>&#39;test/signals&#39;</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span>  <span class=c1># First test signal</span>
</span><span id=__span-38-10><a id=__codelineno-38-10 name=__codelineno-38-10 href=#__codelineno-38-10></a>
</span><span id=__span-38-11><a id=__codelineno-38-11 name=__codelineno-38-11 href=#__codelineno-38-11></a><span class=c1># Get attention weights</span>
</span><span id=__span-38-12><a id=__codelineno-38-12 name=__codelineno-38-12 href=#__codelineno-38-12></a><span class=k>with</span> <span class=n>torch</span><span class=o>.</span><span class=n>no_grad</span><span class=p>():</span>
</span><span id=__span-38-13><a id=__codelineno-38-13 name=__codelineno-38-13 href=#__codelineno-38-13></a>    <span class=n>outputs</span><span class=p>,</span> <span class=n>attention_weights</span> <span class=o>=</span> <span class=n>model</span><span class=p>(</span><span class=n>signal</span><span class=p>,</span> <span class=n>return_attention</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-38-14><a id=__codelineno-38-14 name=__codelineno-38-14 href=#__codelineno-38-14></a>
</span><span id=__span-38-15><a id=__codelineno-38-15 name=__codelineno-38-15 href=#__codelineno-38-15></a><span class=c1># Plot</span>
</span><span id=__span-38-16><a id=__codelineno-38-16 name=__codelineno-38-16 href=#__codelineno-38-16></a><span class=n>plot_attention_weights</span><span class=p>(</span>
</span><span id=__span-38-17><a id=__codelineno-38-17 name=__codelineno-38-17 href=#__codelineno-38-17></a>    <span class=n>signal</span><span class=o>=</span><span class=n>signal</span><span class=p>,</span>
</span><span id=__span-38-18><a id=__codelineno-38-18 name=__codelineno-38-18 href=#__codelineno-38-18></a>    <span class=n>attention_weights</span><span class=o>=</span><span class=n>attention_weights</span><span class=p>,</span>
</span><span id=__span-38-19><a id=__codelineno-38-19 name=__codelineno-38-19 href=#__codelineno-38-19></a>    <span class=n>layer</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span>  <span class=c1># Last layer</span>
</span><span id=__span-38-20><a id=__codelineno-38-20 name=__codelineno-38-20 href=#__codelineno-38-20></a>    <span class=n>head</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>   <span class=c1># First attention head</span>
</span><span id=__span-38-21><a id=__codelineno-38-21 name=__codelineno-38-21 href=#__codelineno-38-21></a>    <span class=n>save_path</span><span class=o>=</span><span class=s1>&#39;results/phase4/attention_map.png&#39;</span>
</span><span id=__span-38-22><a id=__codelineno-38-22 name=__codelineno-38-22 href=#__codelineno-38-22></a><span class=p>)</span>
</span></code></pre></div> <p>This shows which parts of the signal the transformer "pays attention to".</p> <h3 id=what-you-just-learned_4>What You Just Learned<a class=headerlink href=#what-you-just-learned_4 title="Permanent link">&para;</a></h3> <ul> <li>âœ… Transformers for time-series classification</li> <li>âœ… Patch-based encoding for long signals</li> <li>âœ… Self-attention learns temporal dependencies</li> <li>âœ… Comparable accuracy to CNNs (96.5%)</li> <li>âœ… Attention visualization for interpretability</li> </ul> <hr> <h2 id=11-phase-5-time-frequency-analysis-96-98>11. Phase 5: Time-Frequency Analysis (96-98%)<a class=headerlink href=#11-phase-5-time-frequency-analysis-96-98 title="Permanent link">&para;</a></h2> <p><strong>Goal:</strong> Convert signals to spectrograms, train 2D CNNs <strong>Time:</strong> 3-4 hours (including spectrogram generation) <strong>Accuracy:</strong> 96-98%</p> <h3 id=understanding-time-frequency-representations>Understanding Time-Frequency Representations<a class=headerlink href=#understanding-time-frequency-representations title="Permanent link">&para;</a></h3> <p>Vibration signals contain information in <strong>both time and frequency</strong>. Three methods:</p> <ol> <li><strong>STFT</strong> (Short-Time Fourier Transform): Time vs frequency, fixed window</li> <li><strong>CWT</strong> (Continuous Wavelet Transform): Time vs scale, variable resolution</li> <li><strong>WVD</strong> (Wigner-Ville Distribution): Highest resolution, but cross-terms</li> </ol> <h3 id=step-1-precompute-spectrograms>Step 1: Precompute Spectrograms<a class=headerlink href=#step-1-precompute-spectrograms title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-39-1><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a><span class=c1># Generate STFT spectrograms (recommended)</span>
</span><span id=__span-39-2><a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a>python<span class=w> </span>scripts/precompute_spectrograms.py<span class=w> </span><span class=se>\</span>
</span><span id=__span-39-3><a id=__codelineno-39-3 name=__codelineno-39-3 href=#__codelineno-39-3></a><span class=w>    </span>--signals_cache<span class=w> </span>data/processed/dataset.h5<span class=w> </span><span class=se>\</span>
</span><span id=__span-39-4><a id=__codelineno-39-4 name=__codelineno-39-4 href=#__codelineno-39-4></a><span class=w>    </span>--output_dir<span class=w> </span>data/spectrograms/stft/<span class=w> </span><span class=se>\</span>
</span><span id=__span-39-5><a id=__codelineno-39-5 name=__codelineno-39-5 href=#__codelineno-39-5></a><span class=w>    </span>--tfr_type<span class=w> </span>stft<span class=w> </span><span class=se>\</span>
</span><span id=__span-39-6><a id=__codelineno-39-6 name=__codelineno-39-6 href=#__codelineno-39-6></a><span class=w>    </span>--nperseg<span class=w> </span><span class=m>256</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-39-7><a id=__codelineno-39-7 name=__codelineno-39-7 href=#__codelineno-39-7></a><span class=w>    </span>--noverlap<span class=w> </span><span class=m>128</span>
</span></code></pre></div> <p><strong>What this does:</strong> - Loads each signal - Computes STFT with 256-sample window, 50% overlap - Saves spectrogram as image (129 freq bins Ã— 400 time steps) - Takes ~10 minutes for 1,430 signals</p> <p><strong>Output:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-40-1><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a>Generating STFT spectrograms...
</span><span id=__span-40-2><a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a>  Normal... â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 130/130 [00:42]
</span><span id=__span-40-3><a id=__codelineno-40-3 name=__codelineno-40-3 href=#__codelineno-40-3></a>  Ball Fault... â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 130/130 [00:43]
</span><span id=__span-40-4><a id=__codelineno-40-4 name=__codelineno-40-4 href=#__codelineno-40-4></a>  ... (continues for all classes)
</span><span id=__span-40-5><a id=__codelineno-40-5 name=__codelineno-40-5 href=#__codelineno-40-5></a>
</span><span id=__span-40-6><a id=__codelineno-40-6 name=__codelineno-40-6 href=#__codelineno-40-6></a>âœ“ Saved 1430 spectrograms
</span><span id=__span-40-7><a id=__codelineno-40-7 name=__codelineno-40-7 href=#__codelineno-40-7></a>  Shape: (129, 400) per spectrogram
</span><span id=__span-40-8><a id=__codelineno-40-8 name=__codelineno-40-8 href=#__codelineno-40-8></a>  Format: PNG (uint8, normalized)
</span><span id=__span-40-9><a id=__codelineno-40-9 name=__codelineno-40-9 href=#__codelineno-40-9></a>  Directory: data/spectrograms/stft/
</span></code></pre></div></p> <h3 id=step-2-train-2d-cnn-on-spectrograms>Step 2: Train 2D CNN on Spectrograms<a class=headerlink href=#step-2-train-2d-cnn-on-spectrograms title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-41-1><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a><span class=c1># ResNet-18 for 2D spectrograms</span>
</span><span id=__span-41-2><a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a>python<span class=w> </span>scripts/train_spectrogram_cnn.py<span class=w> </span><span class=se>\</span>
</span><span id=__span-41-3><a id=__codelineno-41-3 name=__codelineno-41-3 href=#__codelineno-41-3></a><span class=w>    </span>--model<span class=w> </span>resnet2d<span class=w> </span><span class=se>\</span>
</span><span id=__span-41-4><a id=__codelineno-41-4 name=__codelineno-41-4 href=#__codelineno-41-4></a><span class=w>    </span>--spectrogram-dir<span class=w> </span>data/spectrograms/stft/<span class=w> </span><span class=se>\</span>
</span><span id=__span-41-5><a id=__codelineno-41-5 name=__codelineno-41-5 href=#__codelineno-41-5></a><span class=w>    </span>--epochs<span class=w> </span><span class=m>100</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-41-6><a id=__codelineno-41-6 name=__codelineno-41-6 href=#__codelineno-41-6></a><span class=w>    </span>--batch-size<span class=w> </span><span class=m>32</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-41-7><a id=__codelineno-41-7 name=__codelineno-41-7 href=#__codelineno-41-7></a><span class=w>    </span>--checkpoint-dir<span class=w> </span>checkpoints/phase5/stft
</span></code></pre></div> <p><strong>Expected result:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-42-1><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a>Test Accuracy: 97.2%  â† Best so far!
</span><span id=__span-42-2><a id=__codelineno-42-2 name=__codelineno-42-2 href=#__codelineno-42-2></a>Improvement over Phase 3: +0.5 percentage points
</span></code></pre></div></p> <h3 id=step-3-try-continuous-wavelet-transform-cwt>Step 3: Try Continuous Wavelet Transform (CWT)<a class=headerlink href=#step-3-try-continuous-wavelet-transform-cwt title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-43-1><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a><span class=c1># Generate CWT spectrograms</span>
</span><span id=__span-43-2><a id=__codelineno-43-2 name=__codelineno-43-2 href=#__codelineno-43-2></a>python<span class=w> </span>scripts/precompute_spectrograms.py<span class=w> </span><span class=se>\</span>
</span><span id=__span-43-3><a id=__codelineno-43-3 name=__codelineno-43-3 href=#__codelineno-43-3></a><span class=w>    </span>--signals_cache<span class=w> </span>data/processed/dataset.h5<span class=w> </span><span class=se>\</span>
</span><span id=__span-43-4><a id=__codelineno-43-4 name=__codelineno-43-4 href=#__codelineno-43-4></a><span class=w>    </span>--output_dir<span class=w> </span>data/spectrograms/cwt/<span class=w> </span><span class=se>\</span>
</span><span id=__span-43-5><a id=__codelineno-43-5 name=__codelineno-43-5 href=#__codelineno-43-5></a><span class=w>    </span>--tfr_type<span class=w> </span>cwt<span class=w> </span><span class=se>\</span>
</span><span id=__span-43-6><a id=__codelineno-43-6 name=__codelineno-43-6 href=#__codelineno-43-6></a><span class=w>    </span>--scales<span class=w> </span><span class=m>64</span>
</span><span id=__span-43-7><a id=__codelineno-43-7 name=__codelineno-43-7 href=#__codelineno-43-7></a>
</span><span id=__span-43-8><a id=__codelineno-43-8 name=__codelineno-43-8 href=#__codelineno-43-8></a><span class=c1># Train on CWT</span>
</span><span id=__span-43-9><a id=__codelineno-43-9 name=__codelineno-43-9 href=#__codelineno-43-9></a>python<span class=w> </span>scripts/train_spectrogram_cnn.py<span class=w> </span><span class=se>\</span>
</span><span id=__span-43-10><a id=__codelineno-43-10 name=__codelineno-43-10 href=#__codelineno-43-10></a><span class=w>    </span>--model<span class=w> </span>resnet2d<span class=w> </span><span class=se>\</span>
</span><span id=__span-43-11><a id=__codelineno-43-11 name=__codelineno-43-11 href=#__codelineno-43-11></a><span class=w>    </span>--spectrogram-dir<span class=w> </span>data/spectrograms/cwt/<span class=w> </span><span class=se>\</span>
</span><span id=__span-43-12><a id=__codelineno-43-12 name=__codelineno-43-12 href=#__codelineno-43-12></a><span class=w>    </span>--epochs<span class=w> </span><span class=m>100</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-43-13><a id=__codelineno-43-13 name=__codelineno-43-13 href=#__codelineno-43-13></a><span class=w>    </span>--checkpoint-dir<span class=w> </span>checkpoints/phase5/cwt
</span></code></pre></div> <p><strong>Expected result:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-44-1><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a>Test Accuracy: 97.4%  â† Even better!
</span></code></pre></div></p> <h3 id=why-do-spectrograms-help>Why Do Spectrograms Help?<a class=headerlink href=#why-do-spectrograms-help title="Permanent link">&para;</a></h3> <p>Bearing faults create <strong>time-varying frequency patterns</strong>: - <strong>Ball faults:</strong> Periodic impulses â†’ horizontal lines in spectrogram - <strong>Imbalance:</strong> Constant frequency (1Ã— RPM) â†’ vertical line - <strong>Misalignment:</strong> Harmonics (1Ã—, 2Ã—, 3Ã— RPM) â†’ multiple vertical lines</p> <p>Spectrograms make these patterns easier for CNNs to learn.</p> <h3 id=what-you-just-learned_5>What You Just Learned<a class=headerlink href=#what-you-just-learned_5 title="Permanent link">&para;</a></h3> <ul> <li>âœ… Time-frequency analysis for bearing diagnostics</li> <li>âœ… STFT vs CWT vs WVD trade-offs</li> <li>âœ… 2D CNNs on spectrograms achieve 97.4%</li> <li>âœ… Visualization helps understand fault signatures</li> </ul> <hr> <h2 id=12-phase-6-physics-informed-neural-networks-97-98>12. Phase 6: Physics-Informed Neural Networks (97-98%)<a class=headerlink href=#12-phase-6-physics-informed-neural-networks-97-98 title="Permanent link">&para;</a></h2> <p><strong>Goal:</strong> Incorporate physics knowledge into neural networks <strong>Time:</strong> 4-5 hours <strong>Accuracy:</strong> 97-98%</p> <h3 id=understanding-pinns>Understanding PINNs<a class=headerlink href=#understanding-pinns title="Permanent link">&para;</a></h3> <p>Traditional deep learning ignores physics. <strong>Physics-Informed Neural Networks (PINNs)</strong> add physics constraints:</p> <ol> <li><strong>Energy conservation:</strong> Kinetic + potential energy = constant</li> <li><strong>Momentum conservation:</strong> Force = mass Ã— acceleration</li> <li><strong>Bearing dynamics:</strong> Hertzian contact forces, bearing frequencies</li> </ol> <p><strong>Loss function:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-45-1><a id=__codelineno-45-1 name=__codelineno-45-1 href=#__codelineno-45-1></a><span class=n>Total</span> <span class=n>Loss</span> <span class=o>=</span> <span class=n>Classification</span> <span class=n>Loss</span> <span class=o>+</span> <span class=n>Î»</span><span class=err>â‚Ã—</span><span class=n>Energy</span> <span class=n>Loss</span> <span class=o>+</span> <span class=n>Î»</span><span class=err>â‚‚Ã—</span><span class=n>Momentum</span> <span class=n>Loss</span>
</span></code></pre></div></p> <h3 id=step-1-train-pinn>Step 1: Train PINN<a class=headerlink href=#step-1-train-pinn title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-46-1><a id=__codelineno-46-1 name=__codelineno-46-1 href=#__codelineno-46-1></a><span class=c1># Train physics-informed network</span>
</span><span id=__span-46-2><a id=__codelineno-46-2 name=__codelineno-46-2 href=#__codelineno-46-2></a>python<span class=w> </span>scripts/train_pinn.py<span class=w> </span><span class=se>\</span>
</span><span id=__span-46-3><a id=__codelineno-46-3 name=__codelineno-46-3 href=#__codelineno-46-3></a><span class=w>    </span>--base-model<span class=w> </span>resnet34<span class=w> </span><span class=se>\</span>
</span><span id=__span-46-4><a id=__codelineno-46-4 name=__codelineno-46-4 href=#__codelineno-46-4></a><span class=w>    </span>--data-path<span class=w> </span>data/processed/dataset.h5<span class=w> </span><span class=se>\</span>
</span><span id=__span-46-5><a id=__codelineno-46-5 name=__codelineno-46-5 href=#__codelineno-46-5></a><span class=w>    </span>--physics-losses<span class=w> </span>energy<span class=w> </span>momentum<span class=w> </span>bearing<span class=w> </span><span class=se>\</span>
</span><span id=__span-46-6><a id=__codelineno-46-6 name=__codelineno-46-6 href=#__codelineno-46-6></a><span class=w>    </span>--lambda-physics<span class=w> </span><span class=m>0</span>.1<span class=w> </span><span class=se>\</span>
</span><span id=__span-46-7><a id=__codelineno-46-7 name=__codelineno-46-7 href=#__codelineno-46-7></a><span class=w>    </span>--epochs<span class=w> </span><span class=m>150</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-46-8><a id=__codelineno-46-8 name=__codelineno-46-8 href=#__codelineno-46-8></a><span class=w>    </span>--checkpoint-dir<span class=w> </span>checkpoints/phase6
</span></code></pre></div> <p><strong>What's different:</strong> - Starts with pretrained ResNet-34 - Adds physics loss terms - Fine-tunes with combined loss</p> <p><strong>Expected result:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-47-1><a id=__codelineno-47-1 name=__codelineno-47-1 href=#__codelineno-47-1></a>Base model (ResNet-34): 96.7%
</span><span id=__span-47-2><a id=__codelineno-47-2 name=__codelineno-47-2 href=#__codelineno-47-2></a>PINN (ResNet-34 + physics): 97.6%
</span><span id=__span-47-3><a id=__codelineno-47-3 name=__codelineno-47-3 href=#__codelineno-47-3></a>
</span><span id=__span-47-4><a id=__codelineno-47-4 name=__codelineno-47-4 href=#__codelineno-47-4></a>Improvement: +0.9 percentage points
</span><span id=__span-47-5><a id=__codelineno-47-5 name=__codelineno-47-5 href=#__codelineno-47-5></a>Better generalization to unseen operating conditions
</span></code></pre></div></p> <h3 id=step-2-understand-physics-losses>Step 2: Understand Physics Losses<a class=headerlink href=#step-2-understand-physics-losses title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-48-1><a id=__codelineno-48-1 name=__codelineno-48-1 href=#__codelineno-48-1></a><span class=c1># Example: Energy conservation loss</span>
</span><span id=__span-48-2><a id=__codelineno-48-2 name=__codelineno-48-2 href=#__codelineno-48-2></a><span class=k>def</span><span class=w> </span><span class=nf>energy_conservation_loss</span><span class=p>(</span><span class=n>signal</span><span class=p>,</span> <span class=n>fs</span><span class=o>=</span><span class=mi>20480</span><span class=p>):</span>
</span><span id=__span-48-3><a id=__codelineno-48-3 name=__codelineno-48-3 href=#__codelineno-48-3></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-48-4><a id=__codelineno-48-4 name=__codelineno-48-4 href=#__codelineno-48-4></a><span class=sd>    Total energy should be conserved (no external work).</span>
</span><span id=__span-48-5><a id=__codelineno-48-5 name=__codelineno-48-5 href=#__codelineno-48-5></a><span class=sd>    E_kinetic + E_potential = constant</span>
</span><span id=__span-48-6><a id=__codelineno-48-6 name=__codelineno-48-6 href=#__codelineno-48-6></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-48-7><a id=__codelineno-48-7 name=__codelineno-48-7 href=#__codelineno-48-7></a>    <span class=c1># Compute velocity (derivative of signal)</span>
</span><span id=__span-48-8><a id=__codelineno-48-8 name=__codelineno-48-8 href=#__codelineno-48-8></a>    <span class=n>velocity</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>diff</span><span class=p>(</span><span class=n>signal</span><span class=p>,</span> <span class=n>dim</span><span class=o>=-</span><span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=n>fs</span>
</span><span id=__span-48-9><a id=__codelineno-48-9 name=__codelineno-48-9 href=#__codelineno-48-9></a>    <span class=n>kinetic_energy</span> <span class=o>=</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=n>velocity</span><span class=o>**</span><span class=mi>2</span>
</span><span id=__span-48-10><a id=__codelineno-48-10 name=__codelineno-48-10 href=#__codelineno-48-10></a>
</span><span id=__span-48-11><a id=__codelineno-48-11 name=__codelineno-48-11 href=#__codelineno-48-11></a>    <span class=c1># Potential energy (from displacement)</span>
</span><span id=__span-48-12><a id=__codelineno-48-12 name=__codelineno-48-12 href=#__codelineno-48-12></a>    <span class=n>potential_energy</span> <span class=o>=</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=n>signal</span><span class=o>**</span><span class=mi>2</span>
</span><span id=__span-48-13><a id=__codelineno-48-13 name=__codelineno-48-13 href=#__codelineno-48-13></a>
</span><span id=__span-48-14><a id=__codelineno-48-14 name=__codelineno-48-14 href=#__codelineno-48-14></a>    <span class=c1># Total energy</span>
</span><span id=__span-48-15><a id=__codelineno-48-15 name=__codelineno-48-15 href=#__codelineno-48-15></a>    <span class=n>total_energy</span> <span class=o>=</span> <span class=n>kinetic_energy</span> <span class=o>+</span> <span class=n>potential_energy</span>
</span><span id=__span-48-16><a id=__codelineno-48-16 name=__codelineno-48-16 href=#__codelineno-48-16></a>
</span><span id=__span-48-17><a id=__codelineno-48-17 name=__codelineno-48-17 href=#__codelineno-48-17></a>    <span class=c1># Loss: variance of total energy (should be constant)</span>
</span><span id=__span-48-18><a id=__codelineno-48-18 name=__codelineno-48-18 href=#__codelineno-48-18></a>    <span class=k>return</span> <span class=n>torch</span><span class=o>.</span><span class=n>var</span><span class=p>(</span><span class=n>total_energy</span><span class=p>)</span>
</span></code></pre></div> <h3 id=what-you-just-learned_6>What You Just Learned<a class=headerlink href=#what-you-just-learned_6 title="Permanent link">&para;</a></h3> <ul> <li>âœ… PINNs combine data-driven and physics-based modeling</li> <li>âœ… Physics constraints improve generalization</li> <li>âœ… Achieved 97.6% accuracy</li> <li>âœ… More robust to distribution shift (different RPMs, loads, etc.)</li> </ul> <hr> <h2 id=13-phase-7-explainable-ai>13. Phase 7: Explainable AI<a class=headerlink href=#13-phase-7-explainable-ai title="Permanent link">&para;</a></h2> <p><strong>Goal:</strong> Understand WHY models make predictions <strong>Time:</strong> 1-2 hours <strong>Output:</strong> Visualizations showing which parts of signals are important</p> <h3 id=understanding-xai>Understanding XAI<a class=headerlink href=#understanding-xai title="Permanent link">&para;</a></h3> <p>Models are "black boxes". Explainable AI answers: - <strong>Which parts of the signal</strong> caused this prediction? - <strong>What features</strong> are most important? - <strong>How confident</strong> is the model?</p> <p><strong>Four methods:</strong></p> <ol> <li><strong>SHAP</strong> (SHapley Additive exPlanations): Game theory</li> <li><strong>LIME</strong> (Local Interpretable Model-agnostic Explanations): Local linear approximation</li> <li><strong>Integrated Gradients</strong>: Gradient-based attribution</li> <li><strong>Grad-CAM</strong>: CNN activation visualization</li> </ol> <h3 id=step-1-generate-shap-explanation>Step 1: Generate SHAP Explanation<a class=headerlink href=#step-1-generate-shap-explanation title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-49-1><a id=__codelineno-49-1 name=__codelineno-49-1 href=#__codelineno-49-1></a><span class=c1># Explain a single prediction</span>
</span><span id=__span-49-2><a id=__codelineno-49-2 name=__codelineno-49-2 href=#__codelineno-49-2></a>python<span class=w> </span>scripts/explain_prediction.py<span class=w> </span><span class=se>\</span>
</span><span id=__span-49-3><a id=__codelineno-49-3 name=__codelineno-49-3 href=#__codelineno-49-3></a><span class=w>    </span>--model<span class=w> </span>checkpoints/phase6/best_pinn.pth<span class=w> </span><span class=se>\</span>
</span><span id=__span-49-4><a id=__codelineno-49-4 name=__codelineno-49-4 href=#__codelineno-49-4></a><span class=w>    </span>--signal-index<span class=w> </span><span class=m>0</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-49-5><a id=__codelineno-49-5 name=__codelineno-49-5 href=#__codelineno-49-5></a><span class=w>    </span>--method<span class=w> </span>shap<span class=w> </span><span class=se>\</span>
</span><span id=__span-49-6><a id=__codelineno-49-6 name=__codelineno-49-6 href=#__codelineno-49-6></a><span class=w>    </span>--output<span class=w> </span>results/phase7/
</span></code></pre></div> <p><strong>Output:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-50-1><a id=__codelineno-50-1 name=__codelineno-50-1 href=#__codelineno-50-1></a>Loading model...
</span><span id=__span-50-2><a id=__codelineno-50-2 name=__codelineno-50-2 href=#__codelineno-50-2></a>Loading signal #0 (class: Ball Fault)
</span><span id=__span-50-3><a id=__codelineno-50-3 name=__codelineno-50-3 href=#__codelineno-50-3></a>
</span><span id=__span-50-4><a id=__codelineno-50-4 name=__codelineno-50-4 href=#__codelineno-50-4></a>Generating SHAP explanation...
</span><span id=__span-50-5><a id=__codelineno-50-5 name=__codelineno-50-5 href=#__codelineno-50-5></a>  Computing baseline (100 background samples)... âœ“
</span><span id=__span-50-6><a id=__codelineno-50-6 name=__codelineno-50-6 href=#__codelineno-50-6></a>  Computing Shapley values... â”â”â”â”â”â”â”â”â”â”â”â” 100% [00:23]
</span><span id=__span-50-7><a id=__codelineno-50-7 name=__codelineno-50-7 href=#__codelineno-50-7></a>
</span><span id=__span-50-8><a id=__codelineno-50-8 name=__codelineno-50-8 href=#__codelineno-50-8></a>Prediction: Ball Fault (confidence: 98.3%)
</span><span id=__span-50-9><a id=__codelineno-50-9 name=__codelineno-50-9 href=#__codelineno-50-9></a>Top 5 contributing time steps:
</span><span id=__span-50-10><a id=__codelineno-50-10 name=__codelineno-50-10 href=#__codelineno-50-10></a>  1. t=8234 (sample 8234): +0.042
</span><span id=__span-50-11><a id=__codelineno-50-11 name=__codelineno-50-11 href=#__codelineno-50-11></a>  2. t=12441: +0.039
</span><span id=__span-50-12><a id=__codelineno-50-12 name=__codelineno-50-12 href=#__codelineno-50-12></a>  3. t=4892: +0.035
</span><span id=__span-50-13><a id=__codelineno-50-13 name=__codelineno-50-13 href=#__codelineno-50-13></a>  ... (showing periodic pattern)
</span><span id=__span-50-14><a id=__codelineno-50-14 name=__codelineno-50-14 href=#__codelineno-50-14></a>
</span><span id=__span-50-15><a id=__codelineno-50-15 name=__codelineno-50-15 href=#__codelineno-50-15></a>âœ“ Saved visualization: results/phase7/shap_signal_0.png
</span></code></pre></div></p> <h3 id=step-2-launch-interactive-xai-dashboard>Step 2: Launch Interactive XAI Dashboard<a class=headerlink href=#step-2-launch-interactive-xai-dashboard title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-51-1><a id=__codelineno-51-1 name=__codelineno-51-1 href=#__codelineno-51-1></a><span class=c1># Start Streamlit dashboard</span>
</span><span id=__span-51-2><a id=__codelineno-51-2 name=__codelineno-51-2 href=#__codelineno-51-2></a>streamlit<span class=w> </span>run<span class=w> </span>explainability/xai_dashboard.py
</span></code></pre></div> <p>Open browser to <code>http://localhost:8501</code>. You can: - Select any model - Choose any test signal - Generate explanations (SHAP, LIME, IG, Grad-CAM) - Interactive plots - Export results</p> <h3 id=step-3-understand-the-explanation>Step 3: Understand the Explanation<a class=headerlink href=#step-3-understand-the-explanation title="Permanent link">&para;</a></h3> <p>Example SHAP output:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-52-1><a id=__codelineno-52-1 name=__codelineno-52-1 href=#__codelineno-52-1></a>Signal: [0.1, -0.2, 0.3, ..., -0.1]
</span><span id=__span-52-2><a id=__codelineno-52-2 name=__codelineno-52-2 href=#__codelineno-52-2></a>         â†“     â†“     â†“          â†“
</span><span id=__span-52-3><a id=__codelineno-52-3 name=__codelineno-52-3 href=#__codelineno-52-3></a>SHAP:   [+0.03, -0.01, +0.05, ..., -0.02]
</span><span id=__span-52-4><a id=__codelineno-52-4 name=__codelineno-52-4 href=#__codelineno-52-4></a>         GREEN  RED    GREEN      RED
</span><span id=__span-52-5><a id=__codelineno-52-5 name=__codelineno-52-5 href=#__codelineno-52-5></a>
</span><span id=__span-52-6><a id=__codelineno-52-6 name=__codelineno-52-6 href=#__codelineno-52-6></a>Interpretation:
</span><span id=__span-52-7><a id=__codelineno-52-7 name=__codelineno-52-7 href=#__codelineno-52-7></a>- Green (positive SHAP): Increases Ball Fault probability
</span><span id=__span-52-8><a id=__codelineno-52-8 name=__codelineno-52-8 href=#__codelineno-52-8></a>- Red (negative SHAP): Decreases Ball Fault probability
</span><span id=__span-52-9><a id=__codelineno-52-9 name=__codelineno-52-9 href=#__codelineno-52-9></a>- Large magnitude: More important
</span></code></pre></div> <p>For bearing faults: - <strong>Ball faults:</strong> Periodic impulses have high positive SHAP - <strong>Imbalance:</strong> Low-frequency components have high positive SHAP - <strong>Normal:</strong> All SHAP values near zero (no strong patterns)</p> <h3 id=what-you-just-learned_7>What You Just Learned<a class=headerlink href=#what-you-just-learned_7 title="Permanent link">&para;</a></h3> <ul> <li>âœ… SHAP quantifies feature importance</li> <li>âœ… LIME provides local explanations</li> <li>âœ… Grad-CAM visualizes what CNNs "see"</li> <li>âœ… Explainability builds trust in predictions</li> <li>âœ… Interactive dashboard for exploration</li> </ul> <hr> <h2 id=14-phase-8-ensemble-methods-98-99>14. Phase 8: Ensemble Methods (98-99%)<a class=headerlink href=#14-phase-8-ensemble-methods-98-99 title="Permanent link">&para;</a></h2> <p><strong>Goal:</strong> Combine multiple models for best accuracy <strong>Time:</strong> 3-4 hours <strong>Accuracy:</strong> 98-99% â­ <strong>Best result!</strong></p> <h3 id=understanding-ensembles>Understanding Ensembles<a class=headerlink href=#understanding-ensembles title="Permanent link">&para;</a></h3> <p><strong>Wisdom of crowds:</strong> Multiple models are better than one.</p> <p><strong>Three approaches:</strong></p> <ol> <li><strong>Voting Ensemble:</strong> Each model votes, majority wins</li> <li><strong>Stacked Ensemble:</strong> Train a meta-model on predictions</li> <li><strong>Mixture of Experts (MoE):</strong> Dynamic model selection</li> </ol> <h3 id=step-1-create-voting-ensemble>Step 1: Create Voting Ensemble<a class=headerlink href=#step-1-create-voting-ensemble title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-53-1><a id=__codelineno-53-1 name=__codelineno-53-1 href=#__codelineno-53-1></a><span class=c1># voting_ensemble.py</span>
</span><span id=__span-53-2><a id=__codelineno-53-2 name=__codelineno-53-2 href=#__codelineno-53-2></a><span class=kn>from</span><span class=w> </span><span class=nn>models.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>VotingEnsemble</span>
</span><span id=__span-53-3><a id=__codelineno-53-3 name=__codelineno-53-3 href=#__codelineno-53-3></a><span class=kn>import</span><span class=w> </span><span class=nn>torch</span>
</span><span id=__span-53-4><a id=__codelineno-53-4 name=__codelineno-53-4 href=#__codelineno-53-4></a>
</span><span id=__span-53-5><a id=__codelineno-53-5 name=__codelineno-53-5 href=#__codelineno-53-5></a><span class=c1># Load your best models</span>
</span><span id=__span-53-6><a id=__codelineno-53-6 name=__codelineno-53-6 href=#__codelineno-53-6></a><span class=n>model_rf</span> <span class=o>=</span> <span class=n>load_model</span><span class=p>(</span><span class=s1>&#39;results/phase1/random_forest_best.pkl&#39;</span><span class=p>)</span>  <span class=c1># 95.3%</span>
</span><span id=__span-53-7><a id=__codelineno-53-7 name=__codelineno-53-7 href=#__codelineno-53-7></a><span class=n>model_resnet</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s1>&#39;checkpoints/phase3/resnet34/best.pth&#39;</span><span class=p>)</span>  <span class=c1># 96.7%</span>
</span><span id=__span-53-8><a id=__codelineno-53-8 name=__codelineno-53-8 href=#__codelineno-53-8></a><span class=n>model_transformer</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s1>&#39;checkpoints/phase4/best.pth&#39;</span><span class=p>)</span>  <span class=c1># 96.5%</span>
</span><span id=__span-53-9><a id=__codelineno-53-9 name=__codelineno-53-9 href=#__codelineno-53-9></a><span class=n>model_pinn</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s1>&#39;checkpoints/phase6/best_pinn.pth&#39;</span><span class=p>)</span>  <span class=c1># 97.6%</span>
</span><span id=__span-53-10><a id=__codelineno-53-10 name=__codelineno-53-10 href=#__codelineno-53-10></a>
</span><span id=__span-53-11><a id=__codelineno-53-11 name=__codelineno-53-11 href=#__codelineno-53-11></a><span class=c1># Create voting ensemble</span>
</span><span id=__span-53-12><a id=__codelineno-53-12 name=__codelineno-53-12 href=#__codelineno-53-12></a><span class=n>ensemble</span> <span class=o>=</span> <span class=n>VotingEnsemble</span><span class=p>(</span>
</span><span id=__span-53-13><a id=__codelineno-53-13 name=__codelineno-53-13 href=#__codelineno-53-13></a>    <span class=n>models</span><span class=o>=</span><span class=p>[</span><span class=n>model_rf</span><span class=p>,</span> <span class=n>model_resnet</span><span class=p>,</span> <span class=n>model_transformer</span><span class=p>,</span> <span class=n>model_pinn</span><span class=p>],</span>
</span><span id=__span-53-14><a id=__codelineno-53-14 name=__codelineno-53-14 href=#__codelineno-53-14></a>    <span class=n>voting</span><span class=o>=</span><span class=s1>&#39;soft&#39;</span><span class=p>,</span>  <span class=c1># Use probabilities, not hard votes</span>
</span><span id=__span-53-15><a id=__codelineno-53-15 name=__codelineno-53-15 href=#__codelineno-53-15></a>    <span class=n>weights</span><span class=o>=</span><span class=p>[</span><span class=mf>0.2</span><span class=p>,</span> <span class=mf>0.25</span><span class=p>,</span> <span class=mf>0.25</span><span class=p>,</span> <span class=mf>0.3</span><span class=p>]</span>  <span class=c1># PINN gets highest weight</span>
</span><span id=__span-53-16><a id=__codelineno-53-16 name=__codelineno-53-16 href=#__codelineno-53-16></a><span class=p>)</span>
</span><span id=__span-53-17><a id=__codelineno-53-17 name=__codelineno-53-17 href=#__codelineno-53-17></a>
</span><span id=__span-53-18><a id=__codelineno-53-18 name=__codelineno-53-18 href=#__codelineno-53-18></a><span class=c1># Evaluate</span>
</span><span id=__span-53-19><a id=__codelineno-53-19 name=__codelineno-53-19 href=#__codelineno-53-19></a><span class=n>test_acc</span> <span class=o>=</span> <span class=n>evaluate</span><span class=p>(</span><span class=n>ensemble</span><span class=p>,</span> <span class=n>test_loader</span><span class=p>)</span>
</span><span id=__span-53-20><a id=__codelineno-53-20 name=__codelineno-53-20 href=#__codelineno-53-20></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Voting Ensemble Accuracy: </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>%&quot;</span><span class=p>)</span>
</span><span id=__span-53-21><a id=__codelineno-53-21 name=__codelineno-53-21 href=#__codelineno-53-21></a><span class=c1># Expected: 97.8%</span>
</span></code></pre></div> <h3 id=step-2-train-stacked-ensemble-best-performance>Step 2: Train Stacked Ensemble (Best Performance)<a class=headerlink href=#step-2-train-stacked-ensemble-best-performance title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-54-1><a id=__codelineno-54-1 name=__codelineno-54-1 href=#__codelineno-54-1></a><span class=c1># Train stacked ensemble with XGBoost meta-learner</span>
</span><span id=__span-54-2><a id=__codelineno-54-2 name=__codelineno-54-2 href=#__codelineno-54-2></a>python<span class=w> </span>scripts/train_stacked_ensemble.py<span class=w> </span><span class=se>\</span>
</span><span id=__span-54-3><a id=__codelineno-54-3 name=__codelineno-54-3 href=#__codelineno-54-3></a><span class=w>    </span>--base-models<span class=w> </span><span class=se>\</span>
</span><span id=__span-54-4><a id=__codelineno-54-4 name=__codelineno-54-4 href=#__codelineno-54-4></a><span class=w>        </span>checkpoints/phase3/resnet34/best.pth<span class=w> </span><span class=se>\</span>
</span><span id=__span-54-5><a id=__codelineno-54-5 name=__codelineno-54-5 href=#__codelineno-54-5></a><span class=w>        </span>checkpoints/phase4/best.pth<span class=w> </span><span class=se>\</span>
</span><span id=__span-54-6><a id=__codelineno-54-6 name=__codelineno-54-6 href=#__codelineno-54-6></a><span class=w>        </span>checkpoints/phase6/best_pinn.pth<span class=w> </span><span class=se>\</span>
</span><span id=__span-54-7><a id=__codelineno-54-7 name=__codelineno-54-7 href=#__codelineno-54-7></a><span class=w>    </span>--meta-learner<span class=w> </span>xgboost<span class=w> </span><span class=se>\</span>
</span><span id=__span-54-8><a id=__codelineno-54-8 name=__codelineno-54-8 href=#__codelineno-54-8></a><span class=w>    </span>--output<span class=w> </span>checkpoints/phase8/stacked_ensemble.pth
</span></code></pre></div> <p><strong>How stacking works:</strong> 1. Each base model predicts probabilities for train/val set 2. These predictions become features for meta-learner 3. Meta-learner (XGBoost) learns to combine predictions optimally</p> <p><strong>Expected result:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-55-1><a id=__codelineno-55-1 name=__codelineno-55-1 href=#__codelineno-55-1></a>Base model predictions shape: (1001, 3, 11)
</span><span id=__span-55-2><a id=__codelineno-55-2 name=__codelineno-55-2 href=#__codelineno-55-2></a>  - 1001 training samples
</span><span id=__span-55-3><a id=__codelineno-55-3 name=__codelineno-55-3 href=#__codelineno-55-3></a>  - 3 base models
</span><span id=__span-55-4><a id=__codelineno-55-4 name=__codelineno-55-4 href=#__codelineno-55-4></a>  - 11 class probabilities each
</span><span id=__span-55-5><a id=__codelineno-55-5 name=__codelineno-55-5 href=#__codelineno-55-5></a>
</span><span id=__span-55-6><a id=__codelineno-55-6 name=__codelineno-55-6 href=#__codelineno-55-6></a>Training XGBoost meta-learner...
</span><span id=__span-55-7><a id=__codelineno-55-7 name=__codelineno-55-7 href=#__codelineno-55-7></a>  n_estimators: 100
</span><span id=__span-55-8><a id=__codelineno-55-8 name=__codelineno-55-8 href=#__codelineno-55-8></a>  max_depth: 6
</span><span id=__span-55-9><a id=__codelineno-55-9 name=__codelineno-55-9 href=#__codelineno-55-9></a>  learning_rate: 0.1
</span><span id=__span-55-10><a id=__codelineno-55-10 name=__codelineno-55-10 href=#__codelineno-55-10></a>
</span><span id=__span-55-11><a id=__codelineno-55-11 name=__codelineno-55-11 href=#__codelineno-55-11></a>Cross-validation accuracy: 98.3%
</span><span id=__span-55-12><a id=__codelineno-55-12 name=__codelineno-55-12 href=#__codelineno-55-12></a>Test accuracy: 98.4%  â† Best result!
</span><span id=__span-55-13><a id=__codelineno-55-13 name=__codelineno-55-13 href=#__codelineno-55-13></a>
</span><span id=__span-55-14><a id=__codelineno-55-14 name=__codelineno-55-14 href=#__codelineno-55-14></a>Saved: checkpoints/phase8/stacked_ensemble.pth
</span></code></pre></div></p> <h3 id=step-3-analyze-ensemble-performance>Step 3: Analyze Ensemble Performance<a class=headerlink href=#step-3-analyze-ensemble-performance title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-56-1><a id=__codelineno-56-1 name=__codelineno-56-1 href=#__codelineno-56-1></a><span class=c1># Compare all approaches</span>
</span><span id=__span-56-2><a id=__codelineno-56-2 name=__codelineno-56-2 href=#__codelineno-56-2></a>python<span class=w> </span>scripts/compare_ensembles.py<span class=w> </span><span class=se>\</span>
</span><span id=__span-56-3><a id=__codelineno-56-3 name=__codelineno-56-3 href=#__codelineno-56-3></a><span class=w>    </span>--models<span class=w> </span><span class=se>\</span>
</span><span id=__span-56-4><a id=__codelineno-56-4 name=__codelineno-56-4 href=#__codelineno-56-4></a><span class=w>        </span>checkpoints/phase3/resnet34/best.pth<span class=w> </span><span class=se>\</span>
</span><span id=__span-56-5><a id=__codelineno-56-5 name=__codelineno-56-5 href=#__codelineno-56-5></a><span class=w>        </span>checkpoints/phase4/best.pth<span class=w> </span><span class=se>\</span>
</span><span id=__span-56-6><a id=__codelineno-56-6 name=__codelineno-56-6 href=#__codelineno-56-6></a><span class=w>        </span>checkpoints/phase6/best_pinn.pth<span class=w> </span><span class=se>\</span>
</span><span id=__span-56-7><a id=__codelineno-56-7 name=__codelineno-56-7 href=#__codelineno-56-7></a><span class=w>        </span>checkpoints/phase8/voting_ensemble.pth<span class=w> </span><span class=se>\</span>
</span><span id=__span-56-8><a id=__codelineno-56-8 name=__codelineno-56-8 href=#__codelineno-56-8></a><span class=w>        </span>checkpoints/phase8/stacked_ensemble.pth<span class=w> </span><span class=se>\</span>
</span><span id=__span-56-9><a id=__codelineno-56-9 name=__codelineno-56-9 href=#__codelineno-56-9></a><span class=w>    </span>--test-data<span class=w> </span>data/processed/dataset.h5
</span></code></pre></div> <p><strong>Expected comparison:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-57-1><a id=__codelineno-57-1 name=__codelineno-57-1 href=#__codelineno-57-1></a>Model                      Test Accuracy   Inference Time
</span><span id=__span-57-2><a id=__codelineno-57-2 name=__codelineno-57-2 href=#__codelineno-57-2></a>---------------------------------------------------------
</span><span id=__span-57-3><a id=__codelineno-57-3 name=__codelineno-57-3 href=#__codelineno-57-3></a>ResNet-34 (Phase 3)        96.7%           38.5ms
</span><span id=__span-57-4><a id=__codelineno-57-4 name=__codelineno-57-4 href=#__codelineno-57-4></a>Transformer (Phase 4)      96.5%           52.3ms
</span><span id=__span-57-5><a id=__codelineno-57-5 name=__codelineno-57-5 href=#__codelineno-57-5></a>PINN (Phase 6)             97.6%           42.1ms
</span><span id=__span-57-6><a id=__codelineno-57-6 name=__codelineno-57-6 href=#__codelineno-57-6></a>Voting Ensemble            97.8%           133ms  (3 models)
</span><span id=__span-57-7><a id=__codelineno-57-7 name=__codelineno-57-7 href=#__codelineno-57-7></a>Stacked Ensemble           98.4%           145ms  (3 models + meta)
</span></code></pre></div></p> <h3 id=why-does-ensemble-work>Why Does Ensemble Work?<a class=headerlink href=#why-does-ensemble-work title="Permanent link">&para;</a></h3> <p><strong>Diversity:</strong> Different models make different mistakes. - ResNet: Good at general patterns - Transformer: Good at long-range dependencies - PINN: Good at physics-based reasoning</p> <p><strong>Combination:</strong> Ensemble corrects individual model errors.</p> <p>Example: <div class="language-text highlight"><pre><span></span><code><span id=__span-58-1><a id=__codelineno-58-1 name=__codelineno-58-1 href=#__codelineno-58-1></a>Signal #42 (True label: Combined Fault)
</span><span id=__span-58-2><a id=__codelineno-58-2 name=__codelineno-58-2 href=#__codelineno-58-2></a>
</span><span id=__span-58-3><a id=__codelineno-58-3 name=__codelineno-58-3 href=#__codelineno-58-3></a>Predictions:
</span><span id=__span-58-4><a id=__codelineno-58-4 name=__codelineno-58-4 href=#__codelineno-58-4></a>  ResNet:      Inner Race (confidence: 65%)  â† Wrong
</span><span id=__span-58-5><a id=__codelineno-58-5 name=__codelineno-58-5 href=#__codelineno-58-5></a>  Transformer: Combined (confidence: 55%)    â† Correct but uncertain
</span><span id=__span-58-6><a id=__codelineno-58-6 name=__codelineno-58-6 href=#__codelineno-58-6></a>  PINN:        Combined (confidence: 75%)    â† Correct and confident
</span><span id=__span-58-7><a id=__codelineno-58-7 name=__codelineno-58-7 href=#__codelineno-58-7></a>
</span><span id=__span-58-8><a id=__codelineno-58-8 name=__codelineno-58-8 href=#__codelineno-58-8></a>Ensemble (stacked):
</span><span id=__span-58-9><a id=__codelineno-58-9 name=__codelineno-58-9 href=#__codelineno-58-9></a>  Learns that PINN is most reliable for &quot;Combined Fault&quot;
</span><span id=__span-58-10><a id=__codelineno-58-10 name=__codelineno-58-10 href=#__codelineno-58-10></a>  Final prediction: Combined (confidence: 89%)  â† Correct!
</span></code></pre></div></p> <h3 id=what-you-just-learned_8>What You Just Learned<a class=headerlink href=#what-you-just-learned_8 title="Permanent link">&para;</a></h3> <ul> <li>âœ… Ensemble methods combine model strengths</li> <li>âœ… Stacking &gt; Voting &gt; Single model</li> <li>âœ… Achieved <strong>98.4% accuracy</strong> (vs 95.3% in Phase 1)</li> <li>âœ… Trade-off: Higher accuracy but slower inference</li> </ul> <hr> <h2 id=15-phase-9-production-deployment>15. Phase 9: Production Deployment<a class=headerlink href=#15-phase-9-production-deployment title="Permanent link">&para;</a></h2> <p><strong>Goal:</strong> Optimize for production (speed, size, deployment) <strong>Time:</strong> 2-3 hours <strong>Target:</strong> &lt;50ms inference latency</p> <h3 id=understanding-deployment-requirements>Understanding Deployment Requirements<a class=headerlink href=#understanding-deployment-requirements title="Permanent link">&para;</a></h3> <p>Production systems need: 1. <strong>Small model size</strong> (for edge devices) 2. <strong>Fast inference</strong> (&lt;50ms per prediction) 3. <strong>Cross-platform</strong> (deploy anywhere) 4. <strong>Easy integration</strong> (REST API)</p> <p><strong>Four techniques:</strong></p> <ol> <li><strong>Quantization:</strong> INT8 (4Ã— smaller, 3Ã— faster)</li> <li><strong>ONNX Export:</strong> Framework-agnostic format</li> <li><strong>REST API:</strong> FastAPI server</li> <li><strong>Docker:</strong> Containerized deployment</li> </ol> <h3 id=step-1-quantize-model-to-int8>Step 1: Quantize Model to INT8<a class=headerlink href=#step-1-quantize-model-to-int8 title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-59-1><a id=__codelineno-59-1 name=__codelineno-59-1 href=#__codelineno-59-1></a><span class=c1># Quantize best model (ResNet-34 PINN)</span>
</span><span id=__span-59-2><a id=__codelineno-59-2 name=__codelineno-59-2 href=#__codelineno-59-2></a>python<span class=w> </span>scripts/quantize_model.py<span class=w> </span><span class=se>\</span>
</span><span id=__span-59-3><a id=__codelineno-59-3 name=__codelineno-59-3 href=#__codelineno-59-3></a><span class=w>    </span>--model<span class=w> </span>checkpoints/phase6/best_pinn.pth<span class=w> </span><span class=se>\</span>
</span><span id=__span-59-4><a id=__codelineno-59-4 name=__codelineno-59-4 href=#__codelineno-59-4></a><span class=w>    </span>--output<span class=w> </span>checkpoints/phase9/pinn_int8.pth<span class=w> </span><span class=se>\</span>
</span><span id=__span-59-5><a id=__codelineno-59-5 name=__codelineno-59-5 href=#__codelineno-59-5></a><span class=w>    </span>--quantization-type<span class=w> </span>dynamic<span class=w> </span><span class=se>\</span>
</span><span id=__span-59-6><a id=__codelineno-59-6 name=__codelineno-59-6 href=#__codelineno-59-6></a><span class=w>    </span>--calibration-data<span class=w> </span>data/processed/dataset.h5<span class=w> </span><span class=se>\</span>
</span><span id=__span-59-7><a id=__codelineno-59-7 name=__codelineno-59-7 href=#__codelineno-59-7></a><span class=w>    </span>--calibration-samples<span class=w> </span><span class=m>100</span>
</span></code></pre></div> <p><strong>Expected output:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-60-1><a id=__codelineno-60-1 name=__codelineno-60-1 href=#__codelineno-60-1></a>Loading model...
</span><span id=__span-60-2><a id=__codelineno-60-2 name=__codelineno-60-2 href=#__codelineno-60-2></a>  Original size: 47.2 MB
</span><span id=__span-60-3><a id=__codelineno-60-3 name=__codelineno-60-3 href=#__codelineno-60-3></a>  Parameters: 21,234,123
</span><span id=__span-60-4><a id=__codelineno-60-4 name=__codelineno-60-4 href=#__codelineno-60-4></a>
</span><span id=__span-60-5><a id=__codelineno-60-5 name=__codelineno-60-5 href=#__codelineno-60-5></a>Calibrating quantization...
</span><span id=__span-60-6><a id=__codelineno-60-6 name=__codelineno-60-6 href=#__codelineno-60-6></a>  Using 100 calibration samples... âœ“
</span><span id=__span-60-7><a id=__codelineno-60-7 name=__codelineno-60-7 href=#__codelineno-60-7></a>
</span><span id=__span-60-8><a id=__codelineno-60-8 name=__codelineno-60-8 href=#__codelineno-60-8></a>Quantizing to INT8...
</span><span id=__span-60-9><a id=__codelineno-60-9 name=__codelineno-60-9 href=#__codelineno-60-9></a>  Weights: FP32 â†’ INT8
</span><span id=__span-60-10><a id=__codelineno-60-10 name=__codelineno-60-10 href=#__codelineno-60-10></a>  Activations: FP32 â†’ INT8 (dynamic)
</span><span id=__span-60-11><a id=__codelineno-60-11 name=__codelineno-60-11 href=#__codelineno-60-11></a>
</span><span id=__span-60-12><a id=__codelineno-60-12 name=__codelineno-60-12 href=#__codelineno-60-12></a>Validating quantized model...
</span><span id=__span-60-13><a id=__codelineno-60-13 name=__codelineno-60-13 href=#__codelineno-60-13></a>  Original accuracy: 97.6%
</span><span id=__span-60-14><a id=__codelineno-60-14 name=__codelineno-60-14 href=#__codelineno-60-14></a>  Quantized accuracy: 97.3%
</span><span id=__span-60-15><a id=__codelineno-60-15 name=__codelineno-60-15 href=#__codelineno-60-15></a>  Accuracy loss: 0.3% âœ“ Acceptable
</span><span id=__span-60-16><a id=__codelineno-60-16 name=__codelineno-60-16 href=#__codelineno-60-16></a>
</span><span id=__span-60-17><a id=__codelineno-60-17 name=__codelineno-60-17 href=#__codelineno-60-17></a>Benchmarking inference...
</span><span id=__span-60-18><a id=__codelineno-60-18 name=__codelineno-60-18 href=#__codelineno-60-18></a>  Original: 42.1ms per sample
</span><span id=__span-60-19><a id=__codelineno-60-19 name=__codelineno-60-19 href=#__codelineno-60-19></a>  Quantized: 14.8ms per sample
</span><span id=__span-60-20><a id=__codelineno-60-20 name=__codelineno-60-20 href=#__codelineno-60-20></a>  Speedup: 2.84Ã—
</span><span id=__span-60-21><a id=__codelineno-60-21 name=__codelineno-60-21 href=#__codelineno-60-21></a>
</span><span id=__span-60-22><a id=__codelineno-60-22 name=__codelineno-60-22 href=#__codelineno-60-22></a>Results:
</span><span id=__span-60-23><a id=__codelineno-60-23 name=__codelineno-60-23 href=#__codelineno-60-23></a>  âœ“ Model size: 47.2 MB â†’ 11.8 MB (4.0Ã— reduction)
</span><span id=__span-60-24><a id=__codelineno-60-24 name=__codelineno-60-24 href=#__codelineno-60-24></a>  âœ“ Inference time: 42.1ms â†’ 14.8ms (2.84Ã— speedup)
</span><span id=__span-60-25><a id=__codelineno-60-25 name=__codelineno-60-25 href=#__codelineno-60-25></a>  âœ“ Accuracy: 97.6% â†’ 97.3% (0.3% loss)
</span><span id=__span-60-26><a id=__codelineno-60-26 name=__codelineno-60-26 href=#__codelineno-60-26></a>
</span><span id=__span-60-27><a id=__codelineno-60-27 name=__codelineno-60-27 href=#__codelineno-60-27></a>Saved: checkpoints/phase9/pinn_int8.pth
</span></code></pre></div></p> <h3 id=step-2-export-to-onnx>Step 2: Export to ONNX<a class=headerlink href=#step-2-export-to-onnx title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-61-1><a id=__codelineno-61-1 name=__codelineno-61-1 href=#__codelineno-61-1></a><span class=c1># Export to ONNX format</span>
</span><span id=__span-61-2><a id=__codelineno-61-2 name=__codelineno-61-2 href=#__codelineno-61-2></a>python<span class=w> </span>scripts/export_onnx.py<span class=w> </span><span class=se>\</span>
</span><span id=__span-61-3><a id=__codelineno-61-3 name=__codelineno-61-3 href=#__codelineno-61-3></a><span class=w>    </span>--model<span class=w> </span>checkpoints/phase9/pinn_int8.pth<span class=w> </span><span class=se>\</span>
</span><span id=__span-61-4><a id=__codelineno-61-4 name=__codelineno-61-4 href=#__codelineno-61-4></a><span class=w>    </span>--output<span class=w> </span>models/pinn.onnx<span class=w> </span><span class=se>\</span>
</span><span id=__span-61-5><a id=__codelineno-61-5 name=__codelineno-61-5 href=#__codelineno-61-5></a><span class=w>    </span>--validate<span class=w> </span><span class=se>\</span>
</span><span id=__span-61-6><a id=__codelineno-61-6 name=__codelineno-61-6 href=#__codelineno-61-6></a><span class=w>    </span>--optimize
</span></code></pre></div> <p><strong>Expected output:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-62-1><a id=__codelineno-62-1 name=__codelineno-62-1 href=#__codelineno-62-1></a>Exporting to ONNX...
</span><span id=__span-62-2><a id=__codelineno-62-2 name=__codelineno-62-2 href=#__codelineno-62-2></a>  Input shape: (1, 1, 102400)
</span><span id=__span-62-3><a id=__codelineno-62-3 name=__codelineno-62-3 href=#__codelineno-62-3></a>  Output shape: (1, 11)
</span><span id=__span-62-4><a id=__codelineno-62-4 name=__codelineno-62-4 href=#__codelineno-62-4></a>  Opset version: 14
</span><span id=__span-62-5><a id=__codelineno-62-5 name=__codelineno-62-5 href=#__codelineno-62-5></a>
</span><span id=__span-62-6><a id=__codelineno-62-6 name=__codelineno-62-6 href=#__codelineno-62-6></a>Validating ONNX model...
</span><span id=__span-62-7><a id=__codelineno-62-7 name=__codelineno-62-7 href=#__codelineno-62-7></a>  âœ“ Model structure valid
</span><span id=__span-62-8><a id=__codelineno-62-8 name=__codelineno-62-8 href=#__codelineno-62-8></a>  âœ“ Inference test passed
</span><span id=__span-62-9><a id=__codelineno-62-9 name=__codelineno-62-9 href=#__codelineno-62-9></a>  âœ“ Outputs match PyTorch (max diff: 1e-6)
</span><span id=__span-62-10><a id=__codelineno-62-10 name=__codelineno-62-10 href=#__codelineno-62-10></a>
</span><span id=__span-62-11><a id=__codelineno-62-11 name=__codelineno-62-11 href=#__codelineno-62-11></a>Optimizing ONNX graph...
</span><span id=__span-62-12><a id=__codelineno-62-12 name=__codelineno-62-12 href=#__codelineno-62-12></a>  âœ“ Fused 23 operators
</span><span id=__span-62-13><a id=__codelineno-62-13 name=__codelineno-62-13 href=#__codelineno-62-13></a>  âœ“ Constant folding applied
</span><span id=__span-62-14><a id=__codelineno-62-14 name=__codelineno-62-14 href=#__codelineno-62-14></a>  âœ“ Reduced graph size by 15%
</span><span id=__span-62-15><a id=__codelineno-62-15 name=__codelineno-62-15 href=#__codelineno-62-15></a>
</span><span id=__span-62-16><a id=__codelineno-62-16 name=__codelineno-62-16 href=#__codelineno-62-16></a>Saved: models/pinn.onnx (10.2 MB)
</span></code></pre></div></p> <h3 id=step-3-start-rest-api>Step 3: Start REST API<a class=headerlink href=#step-3-start-rest-api title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-63-1><a id=__codelineno-63-1 name=__codelineno-63-1 href=#__codelineno-63-1></a><span class=c1># Set environment variables</span>
</span><span id=__span-63-2><a id=__codelineno-63-2 name=__codelineno-63-2 href=#__codelineno-63-2></a><span class=nb>export</span><span class=w> </span><span class=nv>MODEL_PATH</span><span class=o>=</span>checkpoints/phase9/pinn_int8.pth
</span><span id=__span-63-3><a id=__codelineno-63-3 name=__codelineno-63-3 href=#__codelineno-63-3></a><span class=nb>export</span><span class=w> </span><span class=nv>DEVICE</span><span class=o>=</span>cuda<span class=w>  </span><span class=c1># or &#39;cpu&#39;</span>
</span><span id=__span-63-4><a id=__codelineno-63-4 name=__codelineno-63-4 href=#__codelineno-63-4></a><span class=nb>export</span><span class=w> </span><span class=nv>PORT</span><span class=o>=</span><span class=m>8000</span>
</span><span id=__span-63-5><a id=__codelineno-63-5 name=__codelineno-63-5 href=#__codelineno-63-5></a>
</span><span id=__span-63-6><a id=__codelineno-63-6 name=__codelineno-63-6 href=#__codelineno-63-6></a><span class=c1># Start FastAPI server</span>
</span><span id=__span-63-7><a id=__codelineno-63-7 name=__codelineno-63-7 href=#__codelineno-63-7></a>uvicorn<span class=w> </span>api.main:app<span class=w> </span>--host<span class=w> </span><span class=m>0</span>.0.0.0<span class=w> </span>--port<span class=w> </span><span class=m>8000</span>
</span></code></pre></div> <p><strong>API is now running at</strong> <code>http://localhost:8000</code></p> <h3 id=step-4-test-the-api>Step 4: Test the API<a class=headerlink href=#step-4-test-the-api title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-64-1><a id=__codelineno-64-1 name=__codelineno-64-1 href=#__codelineno-64-1></a><span class=c1># Health check</span>
</span><span id=__span-64-2><a id=__codelineno-64-2 name=__codelineno-64-2 href=#__codelineno-64-2></a>curl<span class=w> </span>http://localhost:8000/health
</span><span id=__span-64-3><a id=__codelineno-64-3 name=__codelineno-64-3 href=#__codelineno-64-3></a><span class=c1># Response:</span>
</span><span id=__span-64-4><a id=__codelineno-64-4 name=__codelineno-64-4 href=#__codelineno-64-4></a><span class=c1># {</span>
</span><span id=__span-64-5><a id=__codelineno-64-5 name=__codelineno-64-5 href=#__codelineno-64-5></a><span class=c1>#   &quot;status&quot;: &quot;healthy&quot;,</span>
</span><span id=__span-64-6><a id=__codelineno-64-6 name=__codelineno-64-6 href=#__codelineno-64-6></a><span class=c1>#   &quot;model_loaded&quot;: true,</span>
</span><span id=__span-64-7><a id=__codelineno-64-7 name=__codelineno-64-7 href=#__codelineno-64-7></a><span class=c1>#   &quot;device&quot;: &quot;cuda&quot;,</span>
</span><span id=__span-64-8><a id=__codelineno-64-8 name=__codelineno-64-8 href=#__codelineno-64-8></a><span class=c1>#   &quot;model_type&quot;: &quot;PINN-ResNet34-INT8&quot;,</span>
</span><span id=__span-64-9><a id=__codelineno-64-9 name=__codelineno-64-9 href=#__codelineno-64-9></a><span class=c1>#   &quot;num_classes&quot;: 11</span>
</span><span id=__span-64-10><a id=__codelineno-64-10 name=__codelineno-64-10 href=#__codelineno-64-10></a><span class=c1># }</span>
</span><span id=__span-64-11><a id=__codelineno-64-11 name=__codelineno-64-11 href=#__codelineno-64-11></a>
</span><span id=__span-64-12><a id=__codelineno-64-12 name=__codelineno-64-12 href=#__codelineno-64-12></a><span class=c1># Model info</span>
</span><span id=__span-64-13><a id=__codelineno-64-13 name=__codelineno-64-13 href=#__codelineno-64-13></a>curl<span class=w> </span>http://localhost:8000/model/info
</span><span id=__span-64-14><a id=__codelineno-64-14 name=__codelineno-64-14 href=#__codelineno-64-14></a><span class=c1># Response:</span>
</span><span id=__span-64-15><a id=__codelineno-64-15 name=__codelineno-64-15 href=#__codelineno-64-15></a><span class=c1># {</span>
</span><span id=__span-64-16><a id=__codelineno-64-16 name=__codelineno-64-16 href=#__codelineno-64-16></a><span class=c1>#   &quot;architecture&quot;: &quot;PINN-ResNet34&quot;,</span>
</span><span id=__span-64-17><a id=__codelineno-64-17 name=__codelineno-64-17 href=#__codelineno-64-17></a><span class=c1>#   &quot;quantization&quot;: &quot;INT8&quot;,</span>
</span><span id=__span-64-18><a id=__codelineno-64-18 name=__codelineno-64-18 href=#__codelineno-64-18></a><span class=c1>#   &quot;accuracy&quot;: 97.3,</span>
</span><span id=__span-64-19><a id=__codelineno-64-19 name=__codelineno-64-19 href=#__codelineno-64-19></a><span class=c1>#   &quot;inference_time_ms&quot;: 14.8,</span>
</span><span id=__span-64-20><a id=__codelineno-64-20 name=__codelineno-64-20 href=#__codelineno-64-20></a><span class=c1>#   &quot;classes&quot;: [&quot;normal&quot;, &quot;ball_fault&quot;, &quot;inner_race&quot;, ...]</span>
</span><span id=__span-64-21><a id=__codelineno-64-21 name=__codelineno-64-21 href=#__codelineno-64-21></a><span class=c1># }</span>
</span><span id=__span-64-22><a id=__codelineno-64-22 name=__codelineno-64-22 href=#__codelineno-64-22></a>
</span><span id=__span-64-23><a id=__codelineno-64-23 name=__codelineno-64-23 href=#__codelineno-64-23></a><span class=c1># Make a prediction</span>
</span><span id=__span-64-24><a id=__codelineno-64-24 name=__codelineno-64-24 href=#__codelineno-64-24></a>curl<span class=w> </span>-X<span class=w> </span>POST<span class=w> </span>http://localhost:8000/predict<span class=w> </span><span class=se>\</span>
</span><span id=__span-64-25><a id=__codelineno-64-25 name=__codelineno-64-25 href=#__codelineno-64-25></a><span class=w>  </span>-H<span class=w> </span><span class=s2>&quot;Content-Type: application/json&quot;</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-64-26><a id=__codelineno-64-26 name=__codelineno-64-26 href=#__codelineno-64-26></a><span class=w>  </span>-d<span class=w> </span><span class=s1>&#39;{</span>
</span><span id=__span-64-27><a id=__codelineno-64-27 name=__codelineno-64-27 href=#__codelineno-64-27></a><span class=s1>    &quot;signal&quot;: [0.1, 0.2, ..., 0.3],  # 102,400 values</span>
</span><span id=__span-64-28><a id=__codelineno-64-28 name=__codelineno-64-28 href=#__codelineno-64-28></a><span class=s1>    &quot;return_probabilities&quot;: true</span>
</span><span id=__span-64-29><a id=__codelineno-64-29 name=__codelineno-64-29 href=#__codelineno-64-29></a><span class=s1>  }&#39;</span>
</span><span id=__span-64-30><a id=__codelineno-64-30 name=__codelineno-64-30 href=#__codelineno-64-30></a>
</span><span id=__span-64-31><a id=__codelineno-64-31 name=__codelineno-64-31 href=#__codelineno-64-31></a><span class=c1># Response:</span>
</span><span id=__span-64-32><a id=__codelineno-64-32 name=__codelineno-64-32 href=#__codelineno-64-32></a><span class=c1># {</span>
</span><span id=__span-64-33><a id=__codelineno-64-33 name=__codelineno-64-33 href=#__codelineno-64-33></a><span class=c1>#   &quot;predicted_class&quot;: 1,</span>
</span><span id=__span-64-34><a id=__codelineno-64-34 name=__codelineno-64-34 href=#__codelineno-64-34></a><span class=c1>#   &quot;class_name&quot;: &quot;ball_fault&quot;,</span>
</span><span id=__span-64-35><a id=__codelineno-64-35 name=__codelineno-64-35 href=#__codelineno-64-35></a><span class=c1>#   &quot;confidence&quot;: 0.983,</span>
</span><span id=__span-64-36><a id=__codelineno-64-36 name=__codelineno-64-36 href=#__codelineno-64-36></a><span class=c1>#   &quot;probabilities&quot;: [0.001, 0.983, 0.003, ...],</span>
</span><span id=__span-64-37><a id=__codelineno-64-37 name=__codelineno-64-37 href=#__codelineno-64-37></a><span class=c1>#   &quot;inference_time_ms&quot;: 14.2</span>
</span><span id=__span-64-38><a id=__codelineno-64-38 name=__codelineno-64-38 href=#__codelineno-64-38></a><span class=c1># }</span>
</span></code></pre></div> <h3 id=step-5-deploy-with-docker>Step 5: Deploy with Docker<a class=headerlink href=#step-5-deploy-with-docker title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-65-1><a id=__codelineno-65-1 name=__codelineno-65-1 href=#__codelineno-65-1></a><span class=c1># Build Docker image</span>
</span><span id=__span-65-2><a id=__codelineno-65-2 name=__codelineno-65-2 href=#__codelineno-65-2></a>docker<span class=w> </span>build<span class=w> </span>-t<span class=w> </span>lstm_pfd:latest<span class=w> </span>.
</span><span id=__span-65-3><a id=__codelineno-65-3 name=__codelineno-65-3 href=#__codelineno-65-3></a>
</span><span id=__span-65-4><a id=__codelineno-65-4 name=__codelineno-65-4 href=#__codelineno-65-4></a><span class=c1># Run container</span>
</span><span id=__span-65-5><a id=__codelineno-65-5 name=__codelineno-65-5 href=#__codelineno-65-5></a>docker<span class=w> </span>run<span class=w> </span>-d<span class=w> </span><span class=se>\</span>
</span><span id=__span-65-6><a id=__codelineno-65-6 name=__codelineno-65-6 href=#__codelineno-65-6></a><span class=w>  </span>-p<span class=w> </span><span class=m>8000</span>:8000<span class=w> </span><span class=se>\</span>
</span><span id=__span-65-7><a id=__codelineno-65-7 name=__codelineno-65-7 href=#__codelineno-65-7></a><span class=w>  </span>-v<span class=w> </span><span class=k>$(</span><span class=nb>pwd</span><span class=k>)</span>/checkpoints:/app/checkpoints:ro<span class=w> </span><span class=se>\</span>
</span><span id=__span-65-8><a id=__codelineno-65-8 name=__codelineno-65-8 href=#__codelineno-65-8></a><span class=w>  </span>--name<span class=w> </span>lstm_pfd_api<span class=w> </span><span class=se>\</span>
</span><span id=__span-65-9><a id=__codelineno-65-9 name=__codelineno-65-9 href=#__codelineno-65-9></a><span class=w>  </span>lstm_pfd:latest
</span><span id=__span-65-10><a id=__codelineno-65-10 name=__codelineno-65-10 href=#__codelineno-65-10></a>
</span><span id=__span-65-11><a id=__codelineno-65-11 name=__codelineno-65-11 href=#__codelineno-65-11></a><span class=c1># Check logs</span>
</span><span id=__span-65-12><a id=__codelineno-65-12 name=__codelineno-65-12 href=#__codelineno-65-12></a>docker<span class=w> </span>logs<span class=w> </span>lstm_pfd_api
</span><span id=__span-65-13><a id=__codelineno-65-13 name=__codelineno-65-13 href=#__codelineno-65-13></a>
</span><span id=__span-65-14><a id=__codelineno-65-14 name=__codelineno-65-14 href=#__codelineno-65-14></a><span class=c1># Test</span>
</span><span id=__span-65-15><a id=__codelineno-65-15 name=__codelineno-65-15 href=#__codelineno-65-15></a>curl<span class=w> </span>http://localhost:8000/health
</span></code></pre></div> <p><strong>Or use docker-compose:</strong> <div class="language-bash highlight"><pre><span></span><code><span id=__span-66-1><a id=__codelineno-66-1 name=__codelineno-66-1 href=#__codelineno-66-1></a>docker-compose<span class=w> </span>up<span class=w> </span>-d
</span></code></pre></div></p> <h3 id=step-6-benchmark-performance>Step 6: Benchmark Performance<a class=headerlink href=#step-6-benchmark-performance title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-67-1><a id=__codelineno-67-1 name=__codelineno-67-1 href=#__codelineno-67-1></a><span class=c1># Run comprehensive benchmarks</span>
</span><span id=__span-67-2><a id=__codelineno-67-2 name=__codelineno-67-2 href=#__codelineno-67-2></a>python<span class=w> </span>tests/benchmarks/benchmark_suite.py<span class=w> </span><span class=se>\</span>
</span><span id=__span-67-3><a id=__codelineno-67-3 name=__codelineno-67-3 href=#__codelineno-67-3></a><span class=w>    </span>--model<span class=w> </span>checkpoints/phase9/pinn_int8.pth<span class=w> </span><span class=se>\</span>
</span><span id=__span-67-4><a id=__codelineno-67-4 name=__codelineno-67-4 href=#__codelineno-67-4></a><span class=w>    </span>--test-data<span class=w> </span>data/processed/dataset.h5<span class=w> </span><span class=se>\</span>
</span><span id=__span-67-5><a id=__codelineno-67-5 name=__codelineno-67-5 href=#__codelineno-67-5></a><span class=w>    </span>--output<span class=w> </span>benchmark_results.json
</span></code></pre></div> <p><strong>Expected results:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-68-1><a id=__codelineno-68-1 name=__codelineno-68-1 href=#__codelineno-68-1></a>============================================================
</span><span id=__span-68-2><a id=__codelineno-68-2 name=__codelineno-68-2 href=#__codelineno-68-2></a>Performance Benchmark Results
</span><span id=__span-68-3><a id=__codelineno-68-3 name=__codelineno-68-3 href=#__codelineno-68-3></a>============================================================
</span><span id=__span-68-4><a id=__codelineno-68-4 name=__codelineno-68-4 href=#__codelineno-68-4></a>Model: PINN-ResNet34-INT8
</span><span id=__span-68-5><a id=__codelineno-68-5 name=__codelineno-68-5 href=#__codelineno-68-5></a>Device: NVIDIA RTX 3080
</span><span id=__span-68-6><a id=__codelineno-68-6 name=__codelineno-68-6 href=#__codelineno-68-6></a>Batch size: 1
</span><span id=__span-68-7><a id=__codelineno-68-7 name=__codelineno-68-7 href=#__codelineno-68-7></a>
</span><span id=__span-68-8><a id=__codelineno-68-8 name=__codelineno-68-8 href=#__codelineno-68-8></a>Feature Extraction:
</span><span id=__span-68-9><a id=__codelineno-68-9 name=__codelineno-68-9 href=#__codelineno-68-9></a>  Mean: 8.5ms
</span><span id=__span-68-10><a id=__codelineno-68-10 name=__codelineno-68-10 href=#__codelineno-68-10></a>  Median: 8.3ms
</span><span id=__span-68-11><a id=__codelineno-68-11 name=__codelineno-68-11 href=#__codelineno-68-11></a>  P95: 9.2ms
</span><span id=__span-68-12><a id=__codelineno-68-12 name=__codelineno-68-12 href=#__codelineno-68-12></a>  P99: 10.1ms
</span><span id=__span-68-13><a id=__codelineno-68-13 name=__codelineno-68-13 href=#__codelineno-68-13></a>
</span><span id=__span-68-14><a id=__codelineno-68-14 name=__codelineno-68-14 href=#__codelineno-68-14></a>Model Inference:
</span><span id=__span-68-15><a id=__codelineno-68-15 name=__codelineno-68-15 href=#__codelineno-68-15></a>  Mean: 14.8ms
</span><span id=__span-68-16><a id=__codelineno-68-16 name=__codelineno-68-16 href=#__codelineno-68-16></a>  Median: 14.5ms
</span><span id=__span-68-17><a id=__codelineno-68-17 name=__codelineno-68-17 href=#__codelineno-68-17></a>  P95: 16.3ms
</span><span id=__span-68-18><a id=__codelineno-68-18 name=__codelineno-68-18 href=#__codelineno-68-18></a>  P99: 18.2ms
</span><span id=__span-68-19><a id=__codelineno-68-19 name=__codelineno-68-19 href=#__codelineno-68-19></a>
</span><span id=__span-68-20><a id=__codelineno-68-20 name=__codelineno-68-20 href=#__codelineno-68-20></a>Total Latency (feature + inference):
</span><span id=__span-68-21><a id=__codelineno-68-21 name=__codelineno-68-21 href=#__codelineno-68-21></a>  Mean: 23.3ms
</span><span id=__span-68-22><a id=__codelineno-68-22 name=__codelineno-68-22 href=#__codelineno-68-22></a>  Median: 22.8ms
</span><span id=__span-68-23><a id=__codelineno-68-23 name=__codelineno-68-23 href=#__codelineno-68-23></a>  P95: 25.5ms  âœ“ &lt;50ms target met!
</span><span id=__span-68-24><a id=__codelineno-68-24 name=__codelineno-68-24 href=#__codelineno-68-24></a>  P99: 28.3ms
</span><span id=__span-68-25><a id=__codelineno-68-25 name=__codelineno-68-25 href=#__codelineno-68-25></a>
</span><span id=__span-68-26><a id=__codelineno-68-26 name=__codelineno-68-26 href=#__codelineno-68-26></a>Throughput:
</span><span id=__span-68-27><a id=__codelineno-68-27 name=__codelineno-68-27 href=#__codelineno-68-27></a>  Samples/second: 42.9
</span><span id=__span-68-28><a id=__codelineno-68-28 name=__codelineno-68-28 href=#__codelineno-68-28></a>  Daily capacity: 3.7M predictions
</span><span id=__span-68-29><a id=__codelineno-68-29 name=__codelineno-68-29 href=#__codelineno-68-29></a>
</span><span id=__span-68-30><a id=__codelineno-68-30 name=__codelineno-68-30 href=#__codelineno-68-30></a>Memory Usage:
</span><span id=__span-68-31><a id=__codelineno-68-31 name=__codelineno-68-31 href=#__codelineno-68-31></a>  Model: 11.8 MB
</span><span id=__span-68-32><a id=__codelineno-68-32 name=__codelineno-68-32 href=#__codelineno-68-32></a>  Runtime: 245 MB
</span><span id=__span-68-33><a id=__codelineno-68-33 name=__codelineno-68-33 href=#__codelineno-68-33></a>
</span><span id=__span-68-34><a id=__codelineno-68-34 name=__codelineno-68-34 href=#__codelineno-68-34></a>âœ“ All performance targets met!
</span><span id=__span-68-35><a id=__codelineno-68-35 name=__codelineno-68-35 href=#__codelineno-68-35></a>============================================================
</span></code></pre></div></p> <h3 id=what-you-just-learned_9>What You Just Learned<a class=headerlink href=#what-you-just-learned_9 title="Permanent link">&para;</a></h3> <ul> <li>âœ… INT8 quantization: 4Ã— smaller, 3Ã— faster</li> <li>âœ… ONNX export for cross-platform deployment</li> <li>âœ… FastAPI provides production-ready REST API</li> <li>âœ… Docker containerization for easy deployment</li> <li>âœ… Achieved &lt;50ms latency target</li> </ul> <hr> <h2 id=16-phase-10-testing-everything>16. Phase 10: Testing Everything<a class=headerlink href=#16-phase-10-testing-everything title="Permanent link">&para;</a></h2> <p><strong>Goal:</strong> Comprehensive testing to ensure reliability <strong>Time:</strong> 1 hour <strong>Coverage:</strong> 90%+</p> <h3 id=understanding-testing>Understanding Testing<a class=headerlink href=#understanding-testing title="Permanent link">&para;</a></h3> <p><strong>Three test categories:</strong></p> <ol> <li><strong>Unit Tests:</strong> Test individual functions</li> <li><strong>Integration Tests:</strong> Test end-to-end pipelines</li> <li><strong>Benchmark Tests:</strong> Test performance</li> </ol> <h3 id=step-1-run-all-unit-tests>Step 1: Run All Unit Tests<a class=headerlink href=#step-1-run-all-unit-tests title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-69-1><a id=__codelineno-69-1 name=__codelineno-69-1 href=#__codelineno-69-1></a><span class=c1># Install test dependencies</span>
</span><span id=__span-69-2><a id=__codelineno-69-2 name=__codelineno-69-2 href=#__codelineno-69-2></a>pip<span class=w> </span>install<span class=w> </span>-r<span class=w> </span>requirements-test.txt
</span><span id=__span-69-3><a id=__codelineno-69-3 name=__codelineno-69-3 href=#__codelineno-69-3></a>
</span><span id=__span-69-4><a id=__codelineno-69-4 name=__codelineno-69-4 href=#__codelineno-69-4></a><span class=c1># Run unit tests</span>
</span><span id=__span-69-5><a id=__codelineno-69-5 name=__codelineno-69-5 href=#__codelineno-69-5></a>pytest<span class=w> </span>tests/unit/<span class=w> </span>-v
</span><span id=__span-69-6><a id=__codelineno-69-6 name=__codelineno-69-6 href=#__codelineno-69-6></a>
</span><span id=__span-69-7><a id=__codelineno-69-7 name=__codelineno-69-7 href=#__codelineno-69-7></a><span class=c1># Expected output:</span>
</span><span id=__span-69-8><a id=__codelineno-69-8 name=__codelineno-69-8 href=#__codelineno-69-8></a><span class=c1># tests/unit/test_api.py::test_health_endpoint PASSED</span>
</span><span id=__span-69-9><a id=__codelineno-69-9 name=__codelineno-69-9 href=#__codelineno-69-9></a><span class=c1># tests/unit/test_api.py::test_predict_endpoint PASSED</span>
</span><span id=__span-69-10><a id=__codelineno-69-10 name=__codelineno-69-10 href=#__codelineno-69-10></a><span class=c1># tests/unit/test_features.py::test_time_domain_features PASSED</span>
</span><span id=__span-69-11><a id=__codelineno-69-11 name=__codelineno-69-11 href=#__codelineno-69-11></a><span class=c1># tests/unit/test_features.py::test_frequency_domain_features PASSED</span>
</span><span id=__span-69-12><a id=__codelineno-69-12 name=__codelineno-69-12 href=#__codelineno-69-12></a><span class=c1># tests/unit/test_deployment.py::test_quantization PASSED</span>
</span><span id=__span-69-13><a id=__codelineno-69-13 name=__codelineno-69-13 href=#__codelineno-69-13></a><span class=c1># tests/unit/test_deployment.py::test_onnx_export PASSED</span>
</span><span id=__span-69-14><a id=__codelineno-69-14 name=__codelineno-69-14 href=#__codelineno-69-14></a><span class=c1># ... (50+ tests)</span>
</span><span id=__span-69-15><a id=__codelineno-69-15 name=__codelineno-69-15 href=#__codelineno-69-15></a><span class=c1>#</span>
</span><span id=__span-69-16><a id=__codelineno-69-16 name=__codelineno-69-16 href=#__codelineno-69-16></a><span class=c1># ======================== 53 passed in 42.3s =========================</span>
</span></code></pre></div> <h3 id=step-2-run-integration-tests>Step 2: Run Integration Tests<a class=headerlink href=#step-2-run-integration-tests title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-70-1><a id=__codelineno-70-1 name=__codelineno-70-1 href=#__codelineno-70-1></a><span class=c1># Integration tests (end-to-end pipelines)</span>
</span><span id=__span-70-2><a id=__codelineno-70-2 name=__codelineno-70-2 href=#__codelineno-70-2></a>pytest<span class=w> </span>tests/integration/<span class=w> </span>-v
</span><span id=__span-70-3><a id=__codelineno-70-3 name=__codelineno-70-3 href=#__codelineno-70-3></a>
</span><span id=__span-70-4><a id=__codelineno-70-4 name=__codelineno-70-4 href=#__codelineno-70-4></a><span class=c1># Expected output:</span>
</span><span id=__span-70-5><a id=__codelineno-70-5 name=__codelineno-70-5 href=#__codelineno-70-5></a><span class=c1># tests/integration/test_pipelines.py::test_classical_ml_pipeline PASSED</span>
</span><span id=__span-70-6><a id=__codelineno-70-6 name=__codelineno-70-6 href=#__codelineno-70-6></a><span class=c1># tests/integration/test_pipelines.py::test_cnn_pipeline PASSED</span>
</span><span id=__span-70-7><a id=__codelineno-70-7 name=__codelineno-70-7 href=#__codelineno-70-7></a><span class=c1># tests/integration/test_pipelines.py::test_ensemble_pipeline PASSED</span>
</span><span id=__span-70-8><a id=__codelineno-70-8 name=__codelineno-70-8 href=#__codelineno-70-8></a><span class=c1># ... (11 tests)</span>
</span><span id=__span-70-9><a id=__codelineno-70-9 name=__codelineno-70-9 href=#__codelineno-70-9></a><span class=c1>#</span>
</span><span id=__span-70-10><a id=__codelineno-70-10 name=__codelineno-70-10 href=#__codelineno-70-10></a><span class=c1># ======================== 11 passed in 8m 23s ========================</span>
</span></code></pre></div> <h3 id=step-3-run-dashboard-tests>Step 3: Run Dashboard Tests<a class=headerlink href=#step-3-run-dashboard-tests title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-71-1><a id=__codelineno-71-1 name=__codelineno-71-1 href=#__codelineno-71-1></a><span class=c1># Dashboard-specific tests</span>
</span><span id=__span-71-2><a id=__codelineno-71-2 name=__codelineno-71-2 href=#__codelineno-71-2></a><span class=nb>cd</span><span class=w> </span>dash_app
</span><span id=__span-71-3><a id=__codelineno-71-3 name=__codelineno-71-3 href=#__codelineno-71-3></a>pytest<span class=w> </span>tests/<span class=w> </span>-v
</span><span id=__span-71-4><a id=__codelineno-71-4 name=__codelineno-71-4 href=#__codelineno-71-4></a>
</span><span id=__span-71-5><a id=__codelineno-71-5 name=__codelineno-71-5 href=#__codelineno-71-5></a><span class=c1># Expected output:</span>
</span><span id=__span-71-6><a id=__codelineno-71-6 name=__codelineno-71-6 href=#__codelineno-71-6></a><span class=c1># tests/test_auth.py::test_jwt_authentication PASSED</span>
</span><span id=__span-71-7><a id=__codelineno-71-7 name=__codelineno-71-7 href=#__codelineno-71-7></a><span class=c1># tests/test_auth.py::test_login_logout PASSED</span>
</span><span id=__span-71-8><a id=__codelineno-71-8 name=__codelineno-71-8 href=#__codelineno-71-8></a><span class=c1># tests/test_rate_limiting.py::test_rate_limit_enforcement PASSED</span>
</span><span id=__span-71-9><a id=__codelineno-71-9 name=__codelineno-71-9 href=#__codelineno-71-9></a><span class=c1># tests/test_database.py::test_experiment_model PASSED</span>
</span><span id=__span-71-10><a id=__codelineno-71-10 name=__codelineno-71-10 href=#__codelineno-71-10></a><span class=c1># tests/test_experiments.py::test_create_experiment PASSED</span>
</span><span id=__span-71-11><a id=__codelineno-71-11 name=__codelineno-71-11 href=#__codelineno-71-11></a><span class=c1># tests/test_monitoring.py::test_system_metrics PASSED</span>
</span><span id=__span-71-12><a id=__codelineno-71-12 name=__codelineno-71-12 href=#__codelineno-71-12></a><span class=c1># tests/test_security.py::test_xss_protection PASSED</span>
</span><span id=__span-71-13><a id=__codelineno-71-13 name=__codelineno-71-13 href=#__codelineno-71-13></a><span class=c1># ... (40+ tests)</span>
</span><span id=__span-71-14><a id=__codelineno-71-14 name=__codelineno-71-14 href=#__codelineno-71-14></a><span class=c1>#</span>
</span><span id=__span-71-15><a id=__codelineno-71-15 name=__codelineno-71-15 href=#__codelineno-71-15></a><span class=c1># ======================== 40 passed in 1m 15s ========================</span>
</span></code></pre></div> <h3 id=step-4-generate-coverage-report>Step 4: Generate Coverage Report<a class=headerlink href=#step-4-generate-coverage-report title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-72-1><a id=__codelineno-72-1 name=__codelineno-72-1 href=#__codelineno-72-1></a><span class=c1># Run all tests with coverage</span>
</span><span id=__span-72-2><a id=__codelineno-72-2 name=__codelineno-72-2 href=#__codelineno-72-2></a>pytest<span class=w> </span>--cov<span class=o>=</span>.<span class=w> </span>--cov-report<span class=o>=</span>html<span class=w> </span>--cov-report<span class=o>=</span>term-missing
</span><span id=__span-72-3><a id=__codelineno-72-3 name=__codelineno-72-3 href=#__codelineno-72-3></a>
</span><span id=__span-72-4><a id=__codelineno-72-4 name=__codelineno-72-4 href=#__codelineno-72-4></a><span class=c1># Expected output:</span>
</span><span id=__span-72-5><a id=__codelineno-72-5 name=__codelineno-72-5 href=#__codelineno-72-5></a><span class=c1># Name                          Stmts   Miss  Cover</span>
</span><span id=__span-72-6><a id=__codelineno-72-6 name=__codelineno-72-6 href=#__codelineno-72-6></a><span class=c1># -------------------------------------------------</span>
</span><span id=__span-72-7><a id=__codelineno-72-7 name=__codelineno-72-7 href=#__codelineno-72-7></a><span class=c1># data/signal_generator.py        432     18    96%</span>
</span><span id=__span-72-8><a id=__codelineno-72-8 name=__codelineno-72-8 href=#__codelineno-72-8></a><span class=c1># models/cnn.py                   156      8    95%</span>
</span><span id=__span-72-9><a id=__codelineno-72-9 name=__codelineno-72-9 href=#__codelineno-72-9></a><span class=c1># models/resnet.py                234     12    95%</span>
</span><span id=__span-72-10><a id=__codelineno-72-10 name=__codelineno-72-10 href=#__codelineno-72-10></a><span class=c1># training/trainer.py             287     15    95%</span>
</span><span id=__span-72-11><a id=__codelineno-72-11 name=__codelineno-72-11 href=#__codelineno-72-11></a><span class=c1># api/main.py                     124      8    94%</span>
</span><span id=__span-72-12><a id=__codelineno-72-12 name=__codelineno-72-12 href=#__codelineno-72-12></a><span class=c1># ... (many more files)</span>
</span><span id=__span-72-13><a id=__codelineno-72-13 name=__codelineno-72-13 href=#__codelineno-72-13></a><span class=c1># -------------------------------------------------</span>
</span><span id=__span-72-14><a id=__codelineno-72-14 name=__codelineno-72-14 href=#__codelineno-72-14></a><span class=c1># TOTAL                          7854    723    91%</span>
</span><span id=__span-72-15><a id=__codelineno-72-15 name=__codelineno-72-15 href=#__codelineno-72-15></a><span class=c1>#</span>
</span><span id=__span-72-16><a id=__codelineno-72-16 name=__codelineno-72-16 href=#__codelineno-72-16></a><span class=c1># Coverage HTML report: htmlcov/index.html</span>
</span></code></pre></div> <p>View the HTML report: <div class="language-bash highlight"><pre><span></span><code><span id=__span-73-1><a id=__codelineno-73-1 name=__codelineno-73-1 href=#__codelineno-73-1></a><span class=c1># Open in browser</span>
</span><span id=__span-73-2><a id=__codelineno-73-2 name=__codelineno-73-2 href=#__codelineno-73-2></a>open<span class=w> </span>htmlcov/index.html<span class=w>  </span><span class=c1># macOS</span>
</span><span id=__span-73-3><a id=__codelineno-73-3 name=__codelineno-73-3 href=#__codelineno-73-3></a>xdg-open<span class=w> </span>htmlcov/index.html<span class=w>  </span><span class=c1># Linux</span>
</span><span id=__span-73-4><a id=__codelineno-73-4 name=__codelineno-73-4 href=#__codelineno-73-4></a>start<span class=w> </span>htmlcov/index.html<span class=w>  </span><span class=c1># Windows</span>
</span></code></pre></div></p> <h3 id=step-5-run-benchmarks>Step 5: Run Benchmarks<a class=headerlink href=#step-5-run-benchmarks title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-74-1><a id=__codelineno-74-1 name=__codelineno-74-1 href=#__codelineno-74-1></a><span class=c1># Performance benchmarks</span>
</span><span id=__span-74-2><a id=__codelineno-74-2 name=__codelineno-74-2 href=#__codelineno-74-2></a>python<span class=w> </span>tests/benchmarks/benchmark_suite.py<span class=w> </span><span class=se>\</span>
</span><span id=__span-74-3><a id=__codelineno-74-3 name=__codelineno-74-3 href=#__codelineno-74-3></a><span class=w>    </span>--model<span class=w> </span>checkpoints/phase9/pinn_int8.pth<span class=w> </span><span class=se>\</span>
</span><span id=__span-74-4><a id=__codelineno-74-4 name=__codelineno-74-4 href=#__codelineno-74-4></a><span class=w>    </span>--output<span class=w> </span>benchmark_results.json
</span><span id=__span-74-5><a id=__codelineno-74-5 name=__codelineno-74-5 href=#__codelineno-74-5></a>
</span><span id=__span-74-6><a id=__codelineno-74-6 name=__codelineno-74-6 href=#__codelineno-74-6></a><span class=c1># View results</span>
</span><span id=__span-74-7><a id=__codelineno-74-7 name=__codelineno-74-7 href=#__codelineno-74-7></a>cat<span class=w> </span>benchmark_results.json
</span></code></pre></div> <h3 id=what-you-just-learned_10>What You Just Learned<a class=headerlink href=#what-you-just-learned_10 title="Permanent link">&para;</a></h3> <ul> <li>âœ… 90%+ test coverage ensures reliability</li> <li>âœ… 53 unit tests + 11 integration tests + 40 dashboard tests</li> <li>âœ… All tests pass</li> <li>âœ… Performance benchmarks document speed</li> <li>âœ… Ready for production deployment</li> </ul> <hr> <h2 id=17-phase-11-enterprise-dashboard>17. Phase 11: Enterprise Dashboard<a class=headerlink href=#17-phase-11-enterprise-dashboard title="Permanent link">&para;</a></h2> <p><strong>Goal:</strong> Web-based interface for all operations <strong>Time:</strong> 2-3 hours (mostly setup) <strong>Accessibility:</strong> No coding required!</p> <h3 id=understanding-the-dashboard>Understanding the Dashboard<a class=headerlink href=#understanding-the-dashboard title="Permanent link">&para;</a></h3> <p>The dashboard provides a <strong>complete web UI</strong> for: - Data generation and exploration - Training experiments - Real-time monitoring - Result visualization - Explainable AI - Hyperparameter optimization</p> <p><strong>Built with:</strong> - Plotly Dash (frontend) - PostgreSQL (database) - Redis (caching) - Celery (background tasks)</p> <h3 id=step-1-setup-environment-variables>Step 1: Setup Environment Variables<a class=headerlink href=#step-1-setup-environment-variables title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-75-1><a id=__codelineno-75-1 name=__codelineno-75-1 href=#__codelineno-75-1></a><span class=c1># Navigate to dashboard directory</span>
</span><span id=__span-75-2><a id=__codelineno-75-2 name=__codelineno-75-2 href=#__codelineno-75-2></a><span class=nb>cd</span><span class=w> </span>dash_app
</span><span id=__span-75-3><a id=__codelineno-75-3 name=__codelineno-75-3 href=#__codelineno-75-3></a>
</span><span id=__span-75-4><a id=__codelineno-75-4 name=__codelineno-75-4 href=#__codelineno-75-4></a><span class=c1># Copy environment template</span>
</span><span id=__span-75-5><a id=__codelineno-75-5 name=__codelineno-75-5 href=#__codelineno-75-5></a>cp<span class=w> </span>.env.example<span class=w> </span>.env
</span><span id=__span-75-6><a id=__codelineno-75-6 name=__codelineno-75-6 href=#__codelineno-75-6></a>
</span><span id=__span-75-7><a id=__codelineno-75-7 name=__codelineno-75-7 href=#__codelineno-75-7></a><span class=c1># Generate secure secrets</span>
</span><span id=__span-75-8><a id=__codelineno-75-8 name=__codelineno-75-8 href=#__codelineno-75-8></a>python<span class=w> </span>-c<span class=w> </span><span class=s1>&#39;import secrets; print(&quot;SECRET_KEY=&quot; + secrets.token_hex(32))&#39;</span><span class=w> </span>&gt;&gt;<span class=w> </span>.env
</span><span id=__span-75-9><a id=__codelineno-75-9 name=__codelineno-75-9 href=#__codelineno-75-9></a>python<span class=w> </span>-c<span class=w> </span><span class=s1>&#39;import secrets; print(&quot;JWT_SECRET_KEY=&quot; + secrets.token_hex(32))&#39;</span><span class=w> </span>&gt;&gt;<span class=w> </span>.env
</span><span id=__span-75-10><a id=__codelineno-75-10 name=__codelineno-75-10 href=#__codelineno-75-10></a>
</span><span id=__span-75-11><a id=__codelineno-75-11 name=__codelineno-75-11 href=#__codelineno-75-11></a><span class=c1># Edit .env to set DATABASE_URL</span>
</span><span id=__span-75-12><a id=__codelineno-75-12 name=__codelineno-75-12 href=#__codelineno-75-12></a>nano<span class=w> </span>.env
</span></code></pre></div> <p><strong>Edit <code>.env</code> file:</strong> <div class="language-bash highlight"><pre><span></span><code><span id=__span-76-1><a id=__codelineno-76-1 name=__codelineno-76-1 href=#__codelineno-76-1></a><span class=c1># Database (REQUIRED)</span>
</span><span id=__span-76-2><a id=__codelineno-76-2 name=__codelineno-76-2 href=#__codelineno-76-2></a><span class=nv>DATABASE_URL</span><span class=o>=</span>postgresql://lstm_user:your_password@localhost:5432/lstm_dashboard
</span><span id=__span-76-3><a id=__codelineno-76-3 name=__codelineno-76-3 href=#__codelineno-76-3></a>
</span><span id=__span-76-4><a id=__codelineno-76-4 name=__codelineno-76-4 href=#__codelineno-76-4></a><span class=c1># Redis</span>
</span><span id=__span-76-5><a id=__codelineno-76-5 name=__codelineno-76-5 href=#__codelineno-76-5></a><span class=nv>REDIS_URL</span><span class=o>=</span>redis://localhost:6379/0
</span><span id=__span-76-6><a id=__codelineno-76-6 name=__codelineno-76-6 href=#__codelineno-76-6></a>
</span><span id=__span-76-7><a id=__codelineno-76-7 name=__codelineno-76-7 href=#__codelineno-76-7></a><span class=c1># Celery</span>
</span><span id=__span-76-8><a id=__codelineno-76-8 name=__codelineno-76-8 href=#__codelineno-76-8></a><span class=nv>CELERY_BROKER_URL</span><span class=o>=</span>redis://localhost:6379/0
</span><span id=__span-76-9><a id=__codelineno-76-9 name=__codelineno-76-9 href=#__codelineno-76-9></a><span class=nv>CELERY_RESULT_BACKEND</span><span class=o>=</span>redis://localhost:6379/0
</span><span id=__span-76-10><a id=__codelineno-76-10 name=__codelineno-76-10 href=#__codelineno-76-10></a>
</span><span id=__span-76-11><a id=__codelineno-76-11 name=__codelineno-76-11 href=#__codelineno-76-11></a><span class=c1># Security (auto-generated above)</span>
</span><span id=__span-76-12><a id=__codelineno-76-12 name=__codelineno-76-12 href=#__codelineno-76-12></a><span class=nv>SECRET_KEY</span><span class=o>=</span>&lt;your-generated-secret&gt;
</span><span id=__span-76-13><a id=__codelineno-76-13 name=__codelineno-76-13 href=#__codelineno-76-13></a><span class=nv>JWT_SECRET_KEY</span><span class=o>=</span>&lt;your-generated-jwt-secret&gt;
</span><span id=__span-76-14><a id=__codelineno-76-14 name=__codelineno-76-14 href=#__codelineno-76-14></a>
</span><span id=__span-76-15><a id=__codelineno-76-15 name=__codelineno-76-15 href=#__codelineno-76-15></a><span class=c1># Application</span>
</span><span id=__span-76-16><a id=__codelineno-76-16 name=__codelineno-76-16 href=#__codelineno-76-16></a><span class=nv>ENV</span><span class=o>=</span>development
</span><span id=__span-76-17><a id=__codelineno-76-17 name=__codelineno-76-17 href=#__codelineno-76-17></a><span class=nv>DEBUG</span><span class=o>=</span>True
</span><span id=__span-76-18><a id=__codelineno-76-18 name=__codelineno-76-18 href=#__codelineno-76-18></a><span class=nv>APP_PORT</span><span class=o>=</span><span class=m>8050</span>
</span></code></pre></div></p> <h3 id=step-2-start-infrastructure-docker>Step 2: Start Infrastructure (Docker)<a class=headerlink href=#step-2-start-infrastructure-docker title="Permanent link">&para;</a></h3> <p><strong>Option A: Docker Compose (Recommended)</strong> <div class="language-bash highlight"><pre><span></span><code><span id=__span-77-1><a id=__codelineno-77-1 name=__codelineno-77-1 href=#__codelineno-77-1></a><span class=c1># Start PostgreSQL + Redis + Dashboard</span>
</span><span id=__span-77-2><a id=__codelineno-77-2 name=__codelineno-77-2 href=#__codelineno-77-2></a>docker-compose<span class=w> </span>up
</span></code></pre></div></p> <p><strong>Option B: Manual Setup</strong> <div class="language-bash highlight"><pre><span></span><code><span id=__span-78-1><a id=__codelineno-78-1 name=__codelineno-78-1 href=#__codelineno-78-1></a><span class=c1># Terminal 1: PostgreSQL</span>
</span><span id=__span-78-2><a id=__codelineno-78-2 name=__codelineno-78-2 href=#__codelineno-78-2></a>docker<span class=w> </span>run<span class=w> </span>--name<span class=w> </span>postgres<span class=w> </span><span class=se>\</span>
</span><span id=__span-78-3><a id=__codelineno-78-3 name=__codelineno-78-3 href=#__codelineno-78-3></a><span class=w>  </span>-e<span class=w> </span><span class=nv>POSTGRES_USER</span><span class=o>=</span>lstm_user<span class=w> </span><span class=se>\</span>
</span><span id=__span-78-4><a id=__codelineno-78-4 name=__codelineno-78-4 href=#__codelineno-78-4></a><span class=w>  </span>-e<span class=w> </span><span class=nv>POSTGRES_PASSWORD</span><span class=o>=</span>your_password<span class=w> </span><span class=se>\</span>
</span><span id=__span-78-5><a id=__codelineno-78-5 name=__codelineno-78-5 href=#__codelineno-78-5></a><span class=w>  </span>-e<span class=w> </span><span class=nv>POSTGRES_DB</span><span class=o>=</span>lstm_dashboard<span class=w> </span><span class=se>\</span>
</span><span id=__span-78-6><a id=__codelineno-78-6 name=__codelineno-78-6 href=#__codelineno-78-6></a><span class=w>  </span>-p<span class=w> </span><span class=m>5432</span>:5432<span class=w> </span><span class=se>\</span>
</span><span id=__span-78-7><a id=__codelineno-78-7 name=__codelineno-78-7 href=#__codelineno-78-7></a><span class=w>  </span>-d<span class=w> </span>postgres:15
</span><span id=__span-78-8><a id=__codelineno-78-8 name=__codelineno-78-8 href=#__codelineno-78-8></a>
</span><span id=__span-78-9><a id=__codelineno-78-9 name=__codelineno-78-9 href=#__codelineno-78-9></a><span class=c1># Terminal 2: Redis</span>
</span><span id=__span-78-10><a id=__codelineno-78-10 name=__codelineno-78-10 href=#__codelineno-78-10></a>docker<span class=w> </span>run<span class=w> </span>--name<span class=w> </span>redis<span class=w> </span>-p<span class=w> </span><span class=m>6379</span>:6379<span class=w> </span>-d<span class=w> </span>redis:7
</span><span id=__span-78-11><a id=__codelineno-78-11 name=__codelineno-78-11 href=#__codelineno-78-11></a>
</span><span id=__span-78-12><a id=__codelineno-78-12 name=__codelineno-78-12 href=#__codelineno-78-12></a><span class=c1># Terminal 3: Initialize database</span>
</span><span id=__span-78-13><a id=__codelineno-78-13 name=__codelineno-78-13 href=#__codelineno-78-13></a><span class=nb>cd</span><span class=w> </span>dash_app
</span><span id=__span-78-14><a id=__codelineno-78-14 name=__codelineno-78-14 href=#__codelineno-78-14></a>python<span class=w> </span>-c<span class=w> </span><span class=s2>&quot;</span>
</span><span id=__span-78-15><a id=__codelineno-78-15 name=__codelineno-78-15 href=#__codelineno-78-15></a><span class=s2>from database.connection import init_database</span>
</span><span id=__span-78-16><a id=__codelineno-78-16 name=__codelineno-78-16 href=#__codelineno-78-16></a><span class=s2>from database.seed_data import seed_initial_data</span>
</span><span id=__span-78-17><a id=__codelineno-78-17 name=__codelineno-78-17 href=#__codelineno-78-17></a><span class=s2>init_database()</span>
</span><span id=__span-78-18><a id=__codelineno-78-18 name=__codelineno-78-18 href=#__codelineno-78-18></a><span class=s2>seed_initial_data()</span>
</span><span id=__span-78-19><a id=__codelineno-78-19 name=__codelineno-78-19 href=#__codelineno-78-19></a><span class=s2>&quot;</span>
</span><span id=__span-78-20><a id=__codelineno-78-20 name=__codelineno-78-20 href=#__codelineno-78-20></a>
</span><span id=__span-78-21><a id=__codelineno-78-21 name=__codelineno-78-21 href=#__codelineno-78-21></a><span class=c1># Terminal 4: Start Celery worker</span>
</span><span id=__span-78-22><a id=__codelineno-78-22 name=__codelineno-78-22 href=#__codelineno-78-22></a>celery<span class=w> </span>-A<span class=w> </span>tasks.celery_app<span class=w> </span>worker<span class=w> </span>--loglevel<span class=o>=</span>info
</span><span id=__span-78-23><a id=__codelineno-78-23 name=__codelineno-78-23 href=#__codelineno-78-23></a>
</span><span id=__span-78-24><a id=__codelineno-78-24 name=__codelineno-78-24 href=#__codelineno-78-24></a><span class=c1># Terminal 5: Start dashboard</span>
</span><span id=__span-78-25><a id=__codelineno-78-25 name=__codelineno-78-25 href=#__codelineno-78-25></a>python<span class=w> </span>app.py
</span></code></pre></div></p> <h3 id=step-3-access-the-dashboard>Step 3: Access the Dashboard<a class=headerlink href=#step-3-access-the-dashboard title="Permanent link">&para;</a></h3> <p><strong>Open browser to:</strong> <code>http://localhost:8050</code></p> <p><strong>Default login:</strong> - Username: <code>admin</code> - Password: <code>admin</code> - (Change this immediately!)</p> <h3 id=step-4-complete-walkthrough>Step 4: Complete Walkthrough<a class=headerlink href=#step-4-complete-walkthrough title="Permanent link">&para;</a></h3> <p><strong>Home Page (<code>/</code>):</strong> - System overview - Recent experiments - Quick stats - Health gauges</p> <p><strong>Data Generation (<code>/data-generation</code>):</strong> 1. Click "Generate Data" 2. Configure: - Dataset name: <code>my_bearing_dataset</code> - Signals per fault: 50 (for quick test) - Fault types: Select all 11 - Output format: HDF5 3. Click "Generate Dataset" 4. Wait ~5 minutes</p> <p><strong>New Experiment (<code>/experiment/new</code>):</strong> 1. Click "New Experiment" 2. Basic info: - Name: <code>my_first_cnn</code> - Description: "Testing CNN model" 3. Dataset: Select <code>my_bearing_dataset</code> 4. Model: CNN1D 5. Hyperparameters: Use defaults 6. Launch!</p> <p><strong>Monitor Training (<code>/experiment/&lt;id&gt;/monitor</code>):</strong> - Real-time progress bar - Live loss/accuracy curves (auto-refresh) - Training logs - Estimated time remaining</p> <p><strong>View Results (<code>/experiment/&lt;id&gt;/results</code>):</strong> - Confusion matrix - Per-class metrics - Training history - Download model</p> <p><strong>XAI Dashboard (<code>/xai</code>):</strong> 1. Select your trained model 2. Choose a test signal 3. Select explanation method (SHAP) 4. Generate explanation 5. Explore interactive visualization</p> <h3 id=step-5-test-all-features>Step 5: Test All Features<a class=headerlink href=#step-5-test-all-features title="Permanent link">&para;</a></h3> <p><strong>Checklist:</strong> - [ ] Generate dataset via web UI - [ ] Create and launch experiment - [ ] Monitor training in real-time - [ ] View results and confusion matrix - [ ] Generate SHAP explanation - [ ] Compare multiple experiments - [ ] Export results to PDF</p> <h3 id=what-you-just-learned_11>What You Just Learned<a class=headerlink href=#what-you-just-learned_11 title="Permanent link">&para;</a></h3> <ul> <li>âœ… Complete web-based ML operations platform</li> <li>âœ… No coding required for entire workflow</li> <li>âœ… Real-time training monitoring</li> <li>âœ… Interactive explainability</li> <li>âœ… Production-ready with authentication and monitoring</li> </ul> <hr> <h2 id=18-updating-documentation>18. Updating Documentation<a class=headerlink href=#18-updating-documentation title="Permanent link">&para;</a></h2> <h3 id=issues-found-during-code-review>Issues Found During Code Review<a class=headerlink href=#issues-found-during-code-review title="Permanent link">&para;</a></h3> <p><strong>1. Placeholder URLs (FIXED)</strong> - âœ… Already replaced in commit <code>18ba101</code> - Was: <code>https://github.com/yourusername/LSTM_PFD</code> - Now: <code>https://github.com/abbas-ahmad-cowlar/LSTM_PFD</code></p> <p><strong>2. Placeholder Email (README.md line 1091)</strong> - âŒ Still needs fixing - Current: <code>your.email@example.com</code> - Action needed: Replace with actual contact email</p> <p><strong>3. Placeholder Author (README.md line 1053)</strong> - âŒ Still needs fixing - Current: <code>Your Name</code> in citation - Action needed: Replace with actual author name</p> <h3 id=update-documentation>Update Documentation<a class=headerlink href=#update-documentation title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-79-1><a id=__codelineno-79-1 name=__codelineno-79-1 href=#__codelineno-79-1></a><span class=c1># Open README.md</span>
</span><span id=__span-79-2><a id=__codelineno-79-2 name=__codelineno-79-2 href=#__codelineno-79-2></a>nano<span class=w> </span>README.md
</span><span id=__span-79-3><a id=__codelineno-79-3 name=__codelineno-79-3 href=#__codelineno-79-3></a>
</span><span id=__span-79-4><a id=__codelineno-79-4 name=__codelineno-79-4 href=#__codelineno-79-4></a><span class=c1># Find and replace:</span>
</span><span id=__span-79-5><a id=__codelineno-79-5 name=__codelineno-79-5 href=#__codelineno-79-5></a><span class=c1># Line 1053: author = {Your Name}</span>
</span><span id=__span-79-6><a id=__codelineno-79-6 name=__codelineno-79-6 href=#__codelineno-79-6></a><span class=c1># â†’ author = {Your Actual Name}</span>
</span><span id=__span-79-7><a id=__codelineno-79-7 name=__codelineno-79-7 href=#__codelineno-79-7></a>
</span><span id=__span-79-8><a id=__codelineno-79-8 name=__codelineno-79-8 href=#__codelineno-79-8></a><span class=c1># Line 1091: Email: your.email@example.com</span>
</span><span id=__span-79-9><a id=__codelineno-79-9 name=__codelineno-79-9 href=#__codelineno-79-9></a><span class=c1># â†’ Email: your.actual@email.com</span>
</span></code></pre></div> <h3 id=create-missing-documentation>Create Missing Documentation<a class=headerlink href=#create-missing-documentation title="Permanent link">&para;</a></h3> <p><strong>1. API Documentation</strong> <div class="language-bash highlight"><pre><span></span><code><span id=__span-80-1><a id=__codelineno-80-1 name=__codelineno-80-1 href=#__codelineno-80-1></a><span class=c1># Create api/README.md</span>
</span><span id=__span-80-2><a id=__codelineno-80-2 name=__codelineno-80-2 href=#__codelineno-80-2></a>cat<span class=w> </span>&gt;<span class=w> </span>api/README.md<span class=w> </span><span class=s>&lt;&lt; &#39;EOF&#39;</span>
</span><span id=__span-80-3><a id=__codelineno-80-3 name=__codelineno-80-3 href=#__codelineno-80-3></a><span class=s># LSTM_PFD REST API</span>
</span><span id=__span-80-4><a id=__codelineno-80-4 name=__codelineno-80-4 href=#__codelineno-80-4></a>
</span><span id=__span-80-5><a id=__codelineno-80-5 name=__codelineno-80-5 href=#__codelineno-80-5></a><span class=s>## Endpoints</span>
</span><span id=__span-80-6><a id=__codelineno-80-6 name=__codelineno-80-6 href=#__codelineno-80-6></a>
</span><span id=__span-80-7><a id=__codelineno-80-7 name=__codelineno-80-7 href=#__codelineno-80-7></a><span class=s>### Health Check</span>
</span><span id=__span-80-8><a id=__codelineno-80-8 name=__codelineno-80-8 href=#__codelineno-80-8></a><span class=s>`GET /health`</span>
</span><span id=__span-80-9><a id=__codelineno-80-9 name=__codelineno-80-9 href=#__codelineno-80-9></a>
</span><span id=__span-80-10><a id=__codelineno-80-10 name=__codelineno-80-10 href=#__codelineno-80-10></a><span class=s>### Model Info</span>
</span><span id=__span-80-11><a id=__codelineno-80-11 name=__codelineno-80-11 href=#__codelineno-80-11></a><span class=s>`GET /model/info`</span>
</span><span id=__span-80-12><a id=__codelineno-80-12 name=__codelineno-80-12 href=#__codelineno-80-12></a>
</span><span id=__span-80-13><a id=__codelineno-80-13 name=__codelineno-80-13 href=#__codelineno-80-13></a><span class=s>### Predictions</span>
</span><span id=__span-80-14><a id=__codelineno-80-14 name=__codelineno-80-14 href=#__codelineno-80-14></a><span class=s>`POST /predict`</span>
</span><span id=__span-80-15><a id=__codelineno-80-15 name=__codelineno-80-15 href=#__codelineno-80-15></a>
</span><span id=__span-80-16><a id=__codelineno-80-16 name=__codelineno-80-16 href=#__codelineno-80-16></a><span class=s>See USAGE_GUIDES/Phase_9_DEPLOYMENT_GUIDE.md for details.</span>
</span><span id=__span-80-17><a id=__codelineno-80-17 name=__codelineno-80-17 href=#__codelineno-80-17></a><span class=s>EOF</span>
</span></code></pre></div></p> <p><strong>2. Database Schema Documentation</strong> <div class="language-bash highlight"><pre><span></span><code><span id=__span-81-1><a id=__codelineno-81-1 name=__codelineno-81-1 href=#__codelineno-81-1></a><span class=c1># Create packages/dashboard/database/README.md</span>
</span><span id=__span-81-2><a id=__codelineno-81-2 name=__codelineno-81-2 href=#__codelineno-81-2></a>cat<span class=w> </span>&gt;<span class=w> </span>packages/dashboard/database/README.md<span class=w> </span><span class=s>&lt;&lt; &#39;EOF&#39;</span>
</span><span id=__span-81-3><a id=__codelineno-81-3 name=__codelineno-81-3 href=#__codelineno-81-3></a><span class=s># Database Schema</span>
</span><span id=__span-81-4><a id=__codelineno-81-4 name=__codelineno-81-4 href=#__codelineno-81-4></a>
</span><span id=__span-81-5><a id=__codelineno-81-5 name=__codelineno-81-5 href=#__codelineno-81-5></a><span class=s>## Tables</span>
</span><span id=__span-81-6><a id=__codelineno-81-6 name=__codelineno-81-6 href=#__codelineno-81-6></a>
</span><span id=__span-81-7><a id=__codelineno-81-7 name=__codelineno-81-7 href=#__codelineno-81-7></a><span class=s>### datasets</span>
</span><span id=__span-81-8><a id=__codelineno-81-8 name=__codelineno-81-8 href=#__codelineno-81-8></a><span class=s>- id, name, format, num_samples, created_at</span>
</span><span id=__span-81-9><a id=__codelineno-81-9 name=__codelineno-81-9 href=#__codelineno-81-9></a>
</span><span id=__span-81-10><a id=__codelineno-81-10 name=__codelineno-81-10 href=#__codelineno-81-10></a><span class=s>### experiments</span>
</span><span id=__span-81-11><a id=__codelineno-81-11 name=__codelineno-81-11 href=#__codelineno-81-11></a><span class=s>- id, name, model_type, status, accuracy, created_at</span>
</span><span id=__span-81-12><a id=__codelineno-81-12 name=__codelineno-81-12 href=#__codelineno-81-12></a>
</span><span id=__span-81-13><a id=__codelineno-81-13 name=__codelineno-81-13 href=#__codelineno-81-13></a><span class=s>### training_runs</span>
</span><span id=__span-81-14><a id=__codelineno-81-14 name=__codelineno-81-14 href=#__codelineno-81-14></a><span class=s>- id, experiment_id, epoch, loss, accuracy</span>
</span><span id=__span-81-15><a id=__codelineno-81-15 name=__codelineno-81-15 href=#__codelineno-81-15></a>
</span><span id=__span-81-16><a id=__codelineno-81-16 name=__codelineno-81-16 href=#__codelineno-81-16></a><span class=s>See models/ directory for full SQLAlchemy models.</span>
</span><span id=__span-81-17><a id=__codelineno-81-17 name=__codelineno-81-17 href=#__codelineno-81-17></a><span class=s>EOF</span>
</span></code></pre></div></p> <h3 id=what-you-just-did>What You Just Did<a class=headerlink href=#what-you-just-did title="Permanent link">&para;</a></h3> <ul> <li>âœ… Identified documentation gaps</li> <li>âœ… Fixed placeholder content</li> <li>âœ… Created missing documentation</li> <li>âœ… Improved project completeness</li> </ul> <hr> <h2 id=19-bug-fixes-issues-found>19. Bug Fixes &amp; Issues Found<a class=headerlink href=#19-bug-fixes-issues-found title="Permanent link">&para;</a></h2> <h3 id=issues-from-exploration-report>Issues from Exploration Report<a class=headerlink href=#issues-from-exploration-report title="Permanent link">&para;</a></h3> <p><strong>1. Flask Secret Key Configuration</strong> - <strong>Status:</strong> âœ… FIXED (November 22, 2025) - <strong>What was wrong:</strong> Secret key not configured for sessions - <strong>Fixed in:</strong> <code>packages/dashboard/app.py</code> - <strong>No action needed</strong></p> <p><strong>2. Hardcoded User IDs</strong> - <strong>Status:</strong> âœ… FIXED - <strong>What was wrong:</strong> Callbacks had <code>user_id = 1</code> hardcoded - <strong>Fixed:</strong> Created <code>auth_utils.py</code> with <code>get_current_user_id()</code> - <strong>No action needed</strong></p> <p><strong>3. Constants Not Centralized (MINOR)</strong> - <strong>Status:</strong> âš ï¸ MINOR - <strong>Location:</strong> <code>config/data_config.py</code> - <strong>Issue:</strong> Uses hardcoded <code>fs=20480</code> instead of importing from <code>utils/constants.py</code> - <strong>Impact:</strong> Low (values are correct) - <strong>Fix (optional):</strong></p> <div class="language-python highlight"><pre><span></span><code><span id=__span-82-1><a id=__codelineno-82-1 name=__codelineno-82-1 href=#__codelineno-82-1></a><span class=c1># In config/data_config.py</span>
</span><span id=__span-82-2><a id=__codelineno-82-2 name=__codelineno-82-2 href=#__codelineno-82-2></a><span class=kn>from</span><span class=w> </span><span class=nn>utils.constants</span><span class=w> </span><span class=kn>import</span> <span class=n>SAMPLING_RATE</span><span class=p>,</span> <span class=n>SIGNAL_DURATION</span>
</span><span id=__span-82-3><a id=__codelineno-82-3 name=__codelineno-82-3 href=#__codelineno-82-3></a>
</span><span id=__span-82-4><a id=__codelineno-82-4 name=__codelineno-82-4 href=#__codelineno-82-4></a><span class=nd>@dataclass</span>
</span><span id=__span-82-5><a id=__codelineno-82-5 name=__codelineno-82-5 href=#__codelineno-82-5></a><span class=k>class</span><span class=w> </span><span class=nc>SignalConfig</span><span class=p>:</span>
</span><span id=__span-82-6><a id=__codelineno-82-6 name=__codelineno-82-6 href=#__codelineno-82-6></a>    <span class=n>fs</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>SAMPLING_RATE</span>  <span class=c1># Instead of hardcoded 20480</span>
</span><span id=__span-82-7><a id=__codelineno-82-7 name=__codelineno-82-7 href=#__codelineno-82-7></a>    <span class=n>T</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>SIGNAL_DURATION</span>  <span class=c1># Instead of hardcoded 5.0</span>
</span></code></pre></div> <p><strong>4. MATLAB Generator in Root (COSMETIC)</strong> - <strong>Status:</strong> âš ï¸ COSMETIC - <strong>Location:</strong> <code>/generator.txt</code> (727 lines) - <strong>Issue:</strong> MATLAB reference implementation clutters root - <strong>Fix (optional):</strong></p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-83-1><a id=__codelineno-83-1 name=__codelineno-83-1 href=#__codelineno-83-1></a><span class=c1># Move to docs</span>
</span><span id=__span-83-2><a id=__codelineno-83-2 name=__codelineno-83-2 href=#__codelineno-83-2></a>mkdir<span class=w> </span>-p<span class=w> </span>docs/reference
</span><span id=__span-83-3><a id=__codelineno-83-3 name=__codelineno-83-3 href=#__codelineno-83-3></a>mv<span class=w> </span>generator.txt<span class=w> </span>docs/reference/generator_matlab_v2.0.m
</span></code></pre></div> <h3 id=no-critical-bugs-found>No Critical Bugs Found!<a class=headerlink href=#no-critical-bugs-found title="Permanent link">&para;</a></h3> <p>The codebase is <strong>production-ready</strong> with no critical bugs. All issues are minor/cosmetic.</p> <hr> <h2 id=20-understanding-what-you-built>20. Understanding What You Built<a class=headerlink href=#20-understanding-what-you-built title="Permanent link">&para;</a></h2> <h3 id=architecture-summary>Architecture Summary<a class=headerlink href=#architecture-summary title="Permanent link">&para;</a></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-84-1><a id=__codelineno-84-1 name=__codelineno-84-1 href=#__codelineno-84-1></a>LSTM_PFD System
</span><span id=__span-84-2><a id=__codelineno-84-2 name=__codelineno-84-2 href=#__codelineno-84-2></a>â”œâ”€â”€ Data Pipeline (Phase 0)
</span><span id=__span-84-3><a id=__codelineno-84-3 name=__codelineno-84-3 href=#__codelineno-84-3></a>â”‚   â”œâ”€â”€ Signal Generator (physics-based synthesis)
</span><span id=__span-84-4><a id=__codelineno-84-4 name=__codelineno-84-4 href=#__codelineno-84-4></a>â”‚   â”œâ”€â”€ HDF5 Cache (25Ã— faster than .mat)
</span><span id=__span-84-5><a id=__codelineno-84-5 name=__codelineno-84-5 href=#__codelineno-84-5></a>â”‚   â””â”€â”€ PyTorch Datasets
</span><span id=__span-84-6><a id=__codelineno-84-6 name=__codelineno-84-6 href=#__codelineno-84-6></a>â”‚
</span><span id=__span-84-7><a id=__codelineno-84-7 name=__codelineno-84-7 href=#__codelineno-84-7></a>â”œâ”€â”€ Models (Phases 1-8)
</span><span id=__span-84-8><a id=__codelineno-84-8 name=__codelineno-84-8 href=#__codelineno-84-8></a>â”‚   â”œâ”€â”€ Classical ML (Random Forest: 95.3%)
</span><span id=__span-84-9><a id=__codelineno-84-9 name=__codelineno-84-9 href=#__codelineno-84-9></a>â”‚   â”œâ”€â”€ 1D CNNs (Multi-scale: 94.4%)
</span><span id=__span-84-10><a id=__codelineno-84-10 name=__codelineno-84-10 href=#__codelineno-84-10></a>â”‚   â”œâ”€â”€ Advanced CNNs (ResNet-34: 96.7%)
</span><span id=__span-84-11><a id=__codelineno-84-11 name=__codelineno-84-11 href=#__codelineno-84-11></a>â”‚   â”œâ”€â”€ Transformers (Self-attention: 96.5%)
</span><span id=__span-84-12><a id=__codelineno-84-12 name=__codelineno-84-12 href=#__codelineno-84-12></a>â”‚   â”œâ”€â”€ Time-Frequency (CWT+CNN: 97.4%)
</span><span id=__span-84-13><a id=__codelineno-84-13 name=__codelineno-84-13 href=#__codelineno-84-13></a>â”‚   â”œâ”€â”€ PINN (Physics-informed: 97.6%)
</span><span id=__span-84-14><a id=__codelineno-84-14 name=__codelineno-84-14 href=#__codelineno-84-14></a>â”‚   â””â”€â”€ Ensemble (Stacking: 98.4%)
</span><span id=__span-84-15><a id=__codelineno-84-15 name=__codelineno-84-15 href=#__codelineno-84-15></a>â”‚
</span><span id=__span-84-16><a id=__codelineno-84-16 name=__codelineno-84-16 href=#__codelineno-84-16></a>â”œâ”€â”€ Explainability (Phase 7)
</span><span id=__span-84-17><a id=__codelineno-84-17 name=__codelineno-84-17 href=#__codelineno-84-17></a>â”‚   â”œâ”€â”€ SHAP (Game theory)
</span><span id=__span-84-18><a id=__codelineno-84-18 name=__codelineno-84-18 href=#__codelineno-84-18></a>â”‚   â”œâ”€â”€ LIME (Local approximation)
</span><span id=__span-84-19><a id=__codelineno-84-19 name=__codelineno-84-19 href=#__codelineno-84-19></a>â”‚   â”œâ”€â”€ Integrated Gradients (Gradient-based)
</span><span id=__span-84-20><a id=__codelineno-84-20 name=__codelineno-84-20 href=#__codelineno-84-20></a>â”‚   â””â”€â”€ Grad-CAM (CNN visualization)
</span><span id=__span-84-21><a id=__codelineno-84-21 name=__codelineno-84-21 href=#__codelineno-84-21></a>â”‚
</span><span id=__span-84-22><a id=__codelineno-84-22 name=__codelineno-84-22 href=#__codelineno-84-22></a>â”œâ”€â”€ Deployment (Phase 9)
</span><span id=__span-84-23><a id=__codelineno-84-23 name=__codelineno-84-23 href=#__codelineno-84-23></a>â”‚   â”œâ”€â”€ Quantization (INT8: 4Ã— smaller, 3Ã— faster)
</span><span id=__span-84-24><a id=__codelineno-84-24 name=__codelineno-84-24 href=#__codelineno-84-24></a>â”‚   â”œâ”€â”€ ONNX Export (Cross-platform)
</span><span id=__span-84-25><a id=__codelineno-84-25 name=__codelineno-84-25 href=#__codelineno-84-25></a>â”‚   â”œâ”€â”€ REST API (FastAPI: &lt;50ms latency)
</span><span id=__span-84-26><a id=__codelineno-84-26 name=__codelineno-84-26 href=#__codelineno-84-26></a>â”‚   â””â”€â”€ Docker (Containerized)
</span><span id=__span-84-27><a id=__codelineno-84-27 name=__codelineno-84-27 href=#__codelineno-84-27></a>â”‚
</span><span id=__span-84-28><a id=__codelineno-84-28 name=__codelineno-84-28 href=#__codelineno-84-28></a>â”œâ”€â”€ Testing (Phase 10)
</span><span id=__span-84-29><a id=__codelineno-84-29 name=__codelineno-84-29 href=#__codelineno-84-29></a>â”‚   â”œâ”€â”€ Unit Tests (53 tests)
</span><span id=__span-84-30><a id=__codelineno-84-30 name=__codelineno-84-30 href=#__codelineno-84-30></a>â”‚   â”œâ”€â”€ Integration Tests (11 tests)
</span><span id=__span-84-31><a id=__codelineno-84-31 name=__codelineno-84-31 href=#__codelineno-84-31></a>â”‚   â”œâ”€â”€ Dashboard Tests (40 tests)
</span><span id=__span-84-32><a id=__codelineno-84-32 name=__codelineno-84-32 href=#__codelineno-84-32></a>â”‚   â””â”€â”€ Benchmarks (90%+ coverage)
</span><span id=__span-84-33><a id=__codelineno-84-33 name=__codelineno-84-33 href=#__codelineno-84-33></a>â”‚
</span><span id=__span-84-34><a id=__codelineno-84-34 name=__codelineno-84-34 href=#__codelineno-84-34></a>â””â”€â”€ Dashboard (Phase 11)
</span><span id=__span-84-35><a id=__codelineno-84-35 name=__codelineno-84-35 href=#__codelineno-84-35></a>    â”œâ”€â”€ Web UI (Plotly Dash)
</span><span id=__span-84-36><a id=__codelineno-84-36 name=__codelineno-84-36 href=#__codelineno-84-36></a>    â”œâ”€â”€ Database (PostgreSQL)
</span><span id=__span-84-37><a id=__codelineno-84-37 name=__codelineno-84-37 href=#__codelineno-84-37></a>    â”œâ”€â”€ Caching (Redis)
</span><span id=__span-84-38><a id=__codelineno-84-38 name=__codelineno-84-38 href=#__codelineno-84-38></a>    â”œâ”€â”€ Background Jobs (Celery)
</span><span id=__span-84-39><a id=__codelineno-84-39 name=__codelineno-84-39 href=#__codelineno-84-39></a>    â””â”€â”€ Security (JWT, rate limiting)
</span></code></pre></div> <h3 id=performance-summary>Performance Summary<a class=headerlink href=#performance-summary title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Metric</th> <th>Value</th> </tr> </thead> <tbody> <tr> <td><strong>Accuracy</strong></td> <td>98.4% (ensemble)</td> </tr> <tr> <td><strong>Inference Time</strong></td> <td>14.8ms (quantized)</td> </tr> <tr> <td><strong>Model Size</strong></td> <td>11.8 MB (quantized)</td> </tr> <tr> <td><strong>Training Time</strong></td> <td>3h (ResNet-34)</td> </tr> <tr> <td><strong>Test Coverage</strong></td> <td>91%</td> </tr> <tr> <td><strong>Lines of Code</strong></td> <td>50,000+</td> </tr> </tbody> </table> <h3 id=key-technologies>Key Technologies<a class=headerlink href=#key-technologies title="Permanent link">&para;</a></h3> <ul> <li><strong>Deep Learning:</strong> PyTorch 2.0+</li> <li><strong>Classical ML:</strong> scikit-learn</li> <li><strong>Signal Processing:</strong> scipy, pywavelets</li> <li><strong>Explainability:</strong> SHAP, LIME, Captum</li> <li><strong>Optimization:</strong> Optuna (Bayesian optimization)</li> <li><strong>API:</strong> FastAPI + uvicorn</li> <li><strong>Dashboard:</strong> Plotly Dash</li> <li><strong>Database:</strong> PostgreSQL 15+</li> <li><strong>Caching:</strong> Redis 7+</li> <li><strong>Task Queue:</strong> Celery</li> <li><strong>Deployment:</strong> Docker, ONNX</li> </ul> <hr> <h2 id=21-next-steps-advanced-topics>21. Next Steps &amp; Advanced Topics<a class=headerlink href=#21-next-steps-advanced-topics title="Permanent link">&para;</a></h2> <h3 id=immediate-next-steps>Immediate Next Steps<a class=headerlink href=#immediate-next-steps title="Permanent link">&para;</a></h3> <p><strong>1. Deploy to Production</strong> <div class="language-bash highlight"><pre><span></span><code><span id=__span-85-1><a id=__codelineno-85-1 name=__codelineno-85-1 href=#__codelineno-85-1></a><span class=c1># Set up on cloud server (AWS, Azure, GCP)</span>
</span><span id=__span-85-2><a id=__codelineno-85-2 name=__codelineno-85-2 href=#__codelineno-85-2></a><span class=c1># Configure HTTPS with Let&#39;s Encrypt</span>
</span><span id=__span-85-3><a id=__codelineno-85-3 name=__codelineno-85-3 href=#__codelineno-85-3></a><span class=c1># Set up monitoring (Prometheus + Grafana)</span>
</span><span id=__span-85-4><a id=__codelineno-85-4 name=__codelineno-85-4 href=#__codelineno-85-4></a><span class=c1># Configure autoscaling</span>
</span></code></pre></div></p> <p><strong>2. Experiment with Real Data</strong> <div class="language-bash highlight"><pre><span></span><code><span id=__span-86-1><a id=__codelineno-86-1 name=__codelineno-86-1 href=#__codelineno-86-1></a><span class=c1># Import real bearing vibration data</span>
</span><span id=__span-86-2><a id=__codelineno-86-2 name=__codelineno-86-2 href=#__codelineno-86-2></a>python<span class=w> </span>scripts/import_mat_dataset.py<span class=w> </span><span class=se>\</span>
</span><span id=__span-86-3><a id=__codelineno-86-3 name=__codelineno-86-3 href=#__codelineno-86-3></a><span class=w>    </span>--mat_dir<span class=w> </span>/path/to/real/data/<span class=w> </span><span class=se>\</span>
</span><span id=__span-86-4><a id=__codelineno-86-4 name=__codelineno-86-4 href=#__codelineno-86-4></a><span class=w>    </span>--output<span class=w> </span>data/processed/real_data.h5
</span><span id=__span-86-5><a id=__codelineno-86-5 name=__codelineno-86-5 href=#__codelineno-86-5></a>
</span><span id=__span-86-6><a id=__codelineno-86-6 name=__codelineno-86-6 href=#__codelineno-86-6></a><span class=c1># Retrain all models</span>
</span><span id=__span-86-7><a id=__codelineno-86-7 name=__codelineno-86-7 href=#__codelineno-86-7></a><span class=c1># Compare synthetic vs real data performance</span>
</span></code></pre></div></p> <p><strong>3. Fine-tune for Your Application</strong> <div class="language-bash highlight"><pre><span></span><code><span id=__span-87-1><a id=__codelineno-87-1 name=__codelineno-87-1 href=#__codelineno-87-1></a><span class=c1># Adjust for different:</span>
</span><span id=__span-87-2><a id=__codelineno-87-2 name=__codelineno-87-2 href=#__codelineno-87-2></a><span class=c1># - Bearing types (ball, roller, tapered)</span>
</span><span id=__span-87-3><a id=__codelineno-87-3 name=__codelineno-87-3 href=#__codelineno-87-3></a><span class=c1># - Rotating speeds (100-10,000 RPM)</span>
</span><span id=__span-87-4><a id=__codelineno-87-4 name=__codelineno-87-4 href=#__codelineno-87-4></a><span class=c1># - Load conditions (light, medium, heavy)</span>
</span><span id=__span-87-5><a id=__codelineno-87-5 name=__codelineno-87-5 href=#__codelineno-87-5></a><span class=c1># - Operating environments (clean, dusty, wet)</span>
</span></code></pre></div></p> <h3 id=advanced-topics>Advanced Topics<a class=headerlink href=#advanced-topics title="Permanent link">&para;</a></h3> <p><strong>1. Transfer Learning</strong> - Pre-train on large synthetic dataset - Fine-tune on small real dataset - Domain adaptation techniques</p> <p><strong>2. Online Learning</strong> - Update models with new data - Detect distribution shift - Adaptive thresholds</p> <p><strong>3. Multi-Sensor Fusion</strong> - Combine vibration + temperature + current - Late fusion (ensemble of sensor-specific models) - Early fusion (concatenate sensor data)</p> <p><strong>4. Uncertainty Quantification</strong> - Bayesian neural networks - Monte Carlo dropout - Conformal prediction</p> <p><strong>5. Edge Deployment</strong> - Embedded systems (Raspberry Pi, NVIDIA Jetson) - Microcontrollers (STM32, ESP32) - Real-time constraints (&lt;10ms)</p> <h3 id=research-directions>Research Directions<a class=headerlink href=#research-directions title="Permanent link">&para;</a></h3> <p><strong>1. New Architectures</strong> - Vision Transformers (ViT) for spectrograms - Graph Neural Networks (bearing components as graph) - Neural ODEs for continuous-time modeling</p> <p><strong>2. Few-Shot Learning</strong> - Learn new fault types from 5-10 examples - Meta-learning (MAML, Prototypical Networks) - Self-supervised pre-training</p> <p><strong>3. Generative Models</strong> - Simulate rare faults with GANs - Anomaly detection with VAEs - Data augmentation with diffusion models</p> <p><strong>4. Multi-Task Learning</strong> - Joint prediction of fault type + severity + RUL - Shared representations across tasks - Auxiliary tasks improve generalization</p> <h3 id=contributing-to-the-project>Contributing to the Project<a class=headerlink href=#contributing-to-the-project title="Permanent link">&para;</a></h3> <p><strong>1. Report Bugs</strong> - GitHub Issues: https://github.com/abbas-ahmad-cowlar/LSTM_PFD/issues</p> <p><strong>2. Submit Feature Requests</strong> - Describe use case - Explain expected behavior - Provide examples</p> <p><strong>3. Contribute Code</strong> - Fork repository - Create feature branch - Submit pull request - Follow CONTRIBUTING.md guidelines</p> <p><strong>4. Improve Documentation</strong> - Fix typos - Add examples - Clarify explanations - Translate to other languages</p> <hr> <h2 id=congratulations>Congratulations! ðŸŽ‰<a class=headerlink href=#congratulations title="Permanent link">&para;</a></h2> <p>You've completed the <strong>ZERO TO HERO</strong> journey through LSTM_PFD!</p> <h3 id=what-you-accomplished>What You Accomplished<a class=headerlink href=#what-you-accomplished title="Permanent link">&para;</a></h3> <ul> <li>âœ… Installed and configured entire system</li> <li>âœ… Generated synthetic bearing fault dataset</li> <li>âœ… Trained 20+ AI models across 11 phases</li> <li>âœ… Achieved 98.4% accuracy (state-of-the-art)</li> <li>âœ… Deployed production-ready REST API</li> <li>âœ… Built enterprise dashboard</li> <li>âœ… Implemented explainable AI</li> <li>âœ… Ran comprehensive tests (90%+ coverage)</li> <li>âœ… Understood every component</li> <li>âœ… Updated documentation</li> <li>âœ… Fixed minor issues</li> </ul> <h3 id=you-are-now-a-pro>You Are Now a Pro! ðŸš€<a class=headerlink href=#you-are-now-a-pro title="Permanent link">&para;</a></h3> <p>You understand: - Bearing fault diagnosis fundamentals - Classical machine learning for vibration analysis - Deep learning architectures (CNNs, Transformers) - Advanced techniques (Physics-informed, Ensembles) - Production deployment (Quantization, ONNX, Docker) - Explainable AI (SHAP, LIME, Grad-CAM) - Software engineering best practices</p> <h3 id=share-your-success>Share Your Success!<a class=headerlink href=#share-your-success title="Permanent link">&para;</a></h3> <ul> <li>Tweet about it: #BearingFaultDiagnosis #MachineLearning</li> <li>Write a blog post</li> <li>Present at meetup/conference</li> <li>Contribute back to project</li> </ul> <hr> <p><strong>Built with â¤ï¸ for Predictive Maintenance</strong></p> <p><strong>Last Updated:</strong> November 23, 2025 <strong>Version:</strong> 1.0.0 <strong>Status:</strong> Production Ready ðŸŽ‰</p> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2024-2026 Syed Abbas Ahmad </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/abbas-ahmad-cowlar/LSTM_PFD target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.path", "navigation.top", "navigation.footer", "search.suggest", "search.highlight", "content.tabs.link", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.79ae519e.min.js></script> <script src=../../javascripts/mathjax.js></script> <script src=https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js></script> </body> </html>