{
  "openapi": "3.0.3",
  "info": {
    "title": "LSTM_PFD Fault Diagnosis API",
    "description": "REST API for bearing fault prediction using deep learning models.",
    "version": "1.0.0",
    "contact": {
      "name": "LSTM_PFD Team",
      "url": "https://github.com/abbas-ahmad-cowlar/LSTM_PFD"
    },
    "license": {
      "name": "MIT",
      "url": "https://opensource.org/licenses/MIT"
    }
  },
  "servers": [
    {
      "url": "http://localhost:8000",
      "description": "Local development server"
    }
  ],
  "paths": {
    "/": {
      "get": {
        "summary": "Root Information",
        "description": "Get API information and available endpoints.",
        "operationId": "root_info",
        "responses": {
          "200": {
            "description": "API information",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RootInfo"
                }
              }
            }
          }
        }
      }
    },
    "/health": {
      "get": {
        "summary": "Health Check",
        "description": "Check API server health status.",
        "operationId": "health_check",
        "responses": {
          "200": {
            "description": "Health status",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthStatus"
                }
              }
            }
          }
        }
      }
    },
    "/model/info": {
      "get": {
        "summary": "Model Information",
        "description": "Get information about the loaded model.",
        "operationId": "model_info",
        "responses": {
          "200": {
            "description": "Model information",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ModelInfo"
                }
              }
            }
          },
          "503": {
            "description": "Model not loaded"
          }
        }
      }
    },
    "/predict": {
      "post": {
        "summary": "Single Prediction",
        "description": "Predict fault class for a single vibration signal.",
        "operationId": "predict_single",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PredictionRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Prediction result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PredictionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid input"
          }
        }
      }
    },
    "/predict/batch": {
      "post": {
        "summary": "Batch Prediction",
        "description": "Predict fault classes for multiple signals in one request.",
        "operationId": "predict_batch",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BatchPredictionRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Batch prediction results",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BatchPredictionResponse"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "RootInfo": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "example": "LSTM_PFD Fault Diagnosis API"
          },
          "version": {
            "type": "string",
            "example": "1.0.0"
          },
          "docs": {
            "type": "string",
            "example": "/docs"
          },
          "health": {
            "type": "string",
            "example": "/health"
          }
        }
      },
      "HealthStatus": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string",
            "example": "healthy"
          },
          "model_loaded": {
            "type": "boolean",
            "example": true
          },
          "device": {
            "type": "string",
            "example": "cuda"
          },
          "version": {
            "type": "string",
            "example": "1.0.0"
          },
          "uptime_seconds": {
            "type": "integer",
            "example": 3600
          }
        }
      },
      "ModelInfo": {
        "type": "object",
        "properties": {
          "model_name": {
            "type": "string",
            "example": "EnsembleModel"
          },
          "model_version": {
            "type": "string",
            "example": "1.0.0"
          },
          "num_classes": {
            "type": "integer",
            "example": 11
          },
          "input_shape": {
            "type": "array",
            "items": {
              "type": "integer"
            },
            "example": [
              1,
              102400
            ]
          },
          "inference_device": {
            "type": "string",
            "example": "cuda"
          }
        }
      },
      "PredictionRequest": {
        "type": "object",
        "required": [
          "signal"
        ],
        "properties": {
          "signal": {
            "type": "array",
            "items": {
              "type": "number"
            },
            "description": "Vibration signal (102,400 samples at 20,480 Hz)"
          },
          "return_probabilities": {
            "type": "boolean",
            "default": false
          },
          "return_features": {
            "type": "boolean",
            "default": false
          }
        }
      },
      "PredictionResponse": {
        "type": "object",
        "properties": {
          "predicted_class": {
            "type": "integer",
            "example": 2
          },
          "class_name": {
            "type": "string",
            "example": "Inner Race Fault"
          },
          "confidence": {
            "type": "number",
            "example": 0.967
          },
          "inference_time_ms": {
            "type": "number",
            "example": 42.3
          },
          "probabilities": {
            "type": "object",
            "additionalProperties": {
              "type": "number"
            }
          }
        }
      },
      "BatchPredictionRequest": {
        "type": "object",
        "required": [
          "signals"
        ],
        "properties": {
          "signals": {
            "type": "array",
            "items": {
              "type": "array",
              "items": {
                "type": "number"
              }
            },
            "description": "Array of signals (max 32)"
          },
          "return_probabilities": {
            "type": "boolean",
            "default": false
          }
        }
      },
      "BatchPredictionResponse": {
        "type": "object",
        "properties": {
          "predictions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PredictionResponse"
            }
          },
          "batch_size": {
            "type": "integer"
          },
          "total_inference_time_ms": {
            "type": "number"
          },
          "avg_time_per_sample_ms": {
            "type": "number"
          }
        }
      }
    },
    "securitySchemes": {
      "ApiKeyAuth": {
        "type": "apiKey",
        "in": "header",
        "name": "X-API-Key"
      }
    }
  },
  "security": [
    {
      "ApiKeyAuth": []
    }
  ]
}